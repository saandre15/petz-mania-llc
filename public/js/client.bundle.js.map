{"version":3,"sources":["webpack://petz_mania_website/./node_modules/@lixuc/jsmpeg/index.js","webpack://petz_mania_website/./node_modules/@lixuc/jsmpeg/src/ajax-progressive.js","webpack://petz_mania_website/./node_modules/@lixuc/jsmpeg/src/ajax.js","webpack://petz_mania_website/./node_modules/@lixuc/jsmpeg/src/buffer.js","webpack://petz_mania_website/./node_modules/@lixuc/jsmpeg/src/canvas2d.js","webpack://petz_mania_website/./node_modules/@lixuc/jsmpeg/src/decoder.js","webpack://petz_mania_website/./node_modules/@lixuc/jsmpeg/src/jsmpeg.js","webpack://petz_mania_website/./node_modules/@lixuc/jsmpeg/src/mp2.js","webpack://petz_mania_website/./node_modules/@lixuc/jsmpeg/src/mpeg1.js","webpack://petz_mania_website/./node_modules/@lixuc/jsmpeg/src/player.js","webpack://petz_mania_website/./node_modules/@lixuc/jsmpeg/src/ts.js","webpack://petz_mania_website/./node_modules/@lixuc/jsmpeg/src/video-element.js","webpack://petz_mania_website/./node_modules/@lixuc/jsmpeg/src/webaudio.js","webpack://petz_mania_website/./node_modules/@lixuc/jsmpeg/src/webgl.js","webpack://petz_mania_website/./node_modules/@lixuc/jsmpeg/src/websocket.js","webpack://petz_mania_website/./src/common/view/career.pug","webpack://petz_mania_website/./src/common/view/dog-boarding.pug","webpack://petz_mania_website/./src/common/view/dog-daycare.pug","webpack://petz_mania_website/./src/common/view/dog-grooming.pug","webpack://petz_mania_website/./src/common/view/dog-training.pug","webpack://petz_mania_website/./src/common/view/dog-wash.pug","webpack://petz_mania_website/./src/common/view/emails/new-account.pug","webpack://petz_mania_website/./src/common/view/emails/to-company.pug","webpack://petz_mania_website/./src/common/view/http-error.pug","webpack://petz_mania_website/./src/common/view/index.pug","webpack://petz_mania_website/./src/common/view/job-success.pug","webpack://petz_mania_website/./src/common/view/job.pug","webpack://petz_mania_website/./src/common/view/other.pug","webpack://petz_mania_website/./src/common/view/policies.pug","webpack://petz_mania_website/./src/common/view/price.pug","webpack://petz_mania_website/./src/common/view/sign-up-success.pug","webpack://petz_mania_website/./src/common/view/sign-up.pug","webpack://petz_mania_website/./src/common/view/support.pug","webpack://petz_mania_website/./src/common/view/templates/alert.pug","webpack://petz_mania_website/./src/common/view/templates/basic-requirements.pug","webpack://petz_mania_website/./src/common/view/templates/boarding-hours.pug","webpack://petz_mania_website/./src/common/view/templates/contact-us.pug","webpack://petz_mania_website/./src/common/view/templates/features.pug","webpack://petz_mania_website/./src/common/view/templates/footer.pug","webpack://petz_mania_website/./src/common/view/templates/gallery.pug","webpack://petz_mania_website/./src/common/view/templates/get-started.pug","webpack://petz_mania_website/./src/common/view/templates/header.pug","webpack://petz_mania_website/./src/common/view/templates/holidays.pug","webpack://petz_mania_website/./src/common/view/templates/hours-of-operation.pug","webpack://petz_mania_website/./src/common/view/templates/nav.pug","webpack://petz_mania_website/./src/common/view/templates/price-nav.pug","webpack://petz_mania_website/./src/common/view/templates/price-table.pug","webpack://petz_mania_website/./src/common/view/templates/review.pug","webpack://petz_mania_website/./src/common/view/templates/sign-up-module.pug","webpack://petz_mania_website/./src/common/view/tour.pug","webpack://petz_mania_website/./src/common/view/verify.pug","webpack://petz_mania_website/./src/common/view/webcam-login.pug","webpack://petz_mania_website/./src/common/view/webcam.pug","webpack://petz_mania_website/./src/client/scss/main.scss?feee","webpack://petz_mania_website/./node_modules/photoswipe/dist/photoswipe-ui-default.js","webpack://petz_mania_website/./node_modules/photoswipe/dist/photoswipe.js","webpack://petz_mania_website/./src/client/js/controller/GalleryController.js","webpack://petz_mania_website/./src/client/js/controller/cameraController.js","webpack://petz_mania_website/./src/client/js/controller/carouselController.js","webpack://petz_mania_website/./src/client/js/controller/copyController.js","webpack://petz_mania_website/./src/client/js/controller/navController.js","webpack://petz_mania_website/./src/client/js/view/base.js","webpack://petz_mania_website/./src/client/js/view/cameraView.js","webpack://petz_mania_website/./src/client/js/view/navView.js","webpack://petz_mania_website//home/saandre/.local/src/petz-mania/src/common/view|sync|/\\.pug$/","webpack://petz_mania_website/webpack/bootstrap","webpack://petz_mania_website/webpack/runtime/compat get default export","webpack://petz_mania_website/webpack/runtime/define property getters","webpack://petz_mania_website/webpack/runtime/global","webpack://petz_mania_website/webpack/runtime/hasOwnProperty shorthand","webpack://petz_mania_website/webpack/runtime/make namespace object","webpack://petz_mania_website/webpack/runtime/publicPath","webpack://petz_mania_website/./src/client/js/index.js"],"names":[],"mappings":";;;;;;;;;AAAA,eAAe,mBAAO,CAAC,gEAAc;;AAErC,sBAAsB,mBAAO,CAAC,8EAAqB;AACnD,gBAAgB,mBAAO,CAAC,gEAAc;AACtC,mBAAmB,mBAAO,CAAC,gEAAc;AACzC,qBAAqB,mBAAO,CAAC,4DAAY;AACzC,gCAAgC,mBAAO,CAAC,oFAAwB;AAChE,0BAA0B,mBAAO,CAAC,sEAAiB;AACnD,oBAAoB,mBAAO,CAAC,wDAAU;AACtC,sBAAsB,mBAAO,CAAC,kEAAe;AAC7C,4BAA4B,mBAAO,CAAC,8DAAa;AACjD,0BAA0B,mBAAO,CAAC,0DAAW;AAC7C,wBAAwB,mBAAO,CAAC,8DAAa;AAC7C,2BAA2B,mBAAO,CAAC,oEAAgB;AACnD,8BAA8B,mBAAO,CAAC,oEAAgB;;AAEtD;;;;;;;;;;;AChBA,eAAe,mBAAO,CAAC,4DAAU;;AAEjC;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;ACvHA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;ACtDA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB,oBAAoB;AACrC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,iBAAiB,oBAAoB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,kCAAkC,qBAAqB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;AC7LA,eAAe,mBAAO,CAAC,4DAAU;;AAEjC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA,kBAAkB,YAAY;AAC9B,mBAAmB,YAAY;AAC/B;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;ACnHA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,6CAA6C,yBAAyB;AACtE;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,4CAA4C;AACpE;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,gBAAgB,4BAA4B;AAC5C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,mCAAmC,4BAA4B;AAC/D;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;;;;;;;;;;ACzFA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,2CAA2C;AAC3C;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;;AAEZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;;AAEZ;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA,oDAAoD;AACpD;AACA;AACA;AACA,gBAAgB;;AAEhB;AACA;AACA,EAAE;;AAEF;AACA;AACA,iBAAiB,qBAAqB;AACtC;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA,kBAAkB,kBAAkB;AACpC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;ACtGA;AACA;AACA,eAAe,mBAAO,CAAC,4DAAU;;AAEjC;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,gBAAgB,OAAO;AACvB,iBAAiB,QAAQ;AACzB;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;;AAEA;AACA;AACA,WAAW;AACX;;AAEA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,iBAAiB,YAAY;AAC7B;AACA;AACA;;AAEA,qBAAqB,cAAc;AACnC;AACA;AACA;AACA;;AAEA;AACA;AACA,iBAAiB,eAAe;AAChC,cAAc,gBAAgB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,iBAAiB,eAAe;AAChC,kBAAkB,gBAAgB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAmB,UAAU;AAC7B,uBAAuB,aAAa;;AAEpC;AACA,mBAAmB,YAAY;AAC/B;AACA;AACA;AACA,uBAAuB,cAAc;AACrC;AACA;AACA;AACA;AACA;AACA,yBAAyB,SAAS;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,kBAAkB,OAAO;AACzB;AACA;;AAEA,oBAAoB,SAAS;AAC7B;;AAEA;AACA;;AAEA;AACA;AACA;AACA,qBAAqB,QAAQ;AAC7B;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,qBAAqB,QAAQ;AAC7B;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,oBAAoB,QAAQ;AAC5B;AACA;AACA,KAAK;AACL;AACA,IAAI;;AAEJ,GAAG;AACH;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,6BAA6B;AAC7B,6BAA6B;AAC7B,6BAA6B;AAC7B,6BAA6B;AAC7B,6BAA6B;AAC7B,6BAA6B;AAC7B,6BAA6B;AAC7B,6BAA6B;AAC7B,6BAA6B;AAC7B,6BAA6B;AAC7B,6BAA6B;AAC7B,6BAA6B;AAC7B,6BAA6B;AAC7B,6BAA6B;AAC7B,6BAA6B;AAC7B,6BAA6B;;AAE7B,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB;AACA,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,YAAY;AACZ,YAAY;AACZ,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB;AACA,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,YAAY,YAAY,YAAY;AACpC,YAAY,YAAY,YAAY;AACpC,YAAY,YAAY;AACxB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB;AACA,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,YAAY;AACZ,YAAY;AACZ,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB;AACA,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,iBAAiB;AACjB,YAAY,YAAY,YAAY;AACpC,YAAY,YAAY,YAAY;AACpC,YAAY,YAAY,YAAY;AACpC,YAAY,YAAY,YAAY;AACpC,YAAY,YAAY,YAAY;AACpC,YAAY,YAAY,YAAY;AACpC,YAAY;;AAEZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB,kBAAkB;AAClB,kBAAkB;AAClB,kBAAkB;AAClB,kBAAkB;AAClB,kBAAkB;AAClB,kBAAkB;AAClB,kBAAkB;AAClB,kBAAkB;AAClB,kBAAkB;AAClB,kBAAkB;AAClB,kBAAkB;AAClB,kBAAkB;AAClB,kBAAkB;AAClB,kBAAkB;AAClB,kBAAkB;AAClB;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,EAAE,kCAAkC;AACpC,EAAE,kCAAkC;AACpC,EAAE,kCAAkC;AACpC,EAAE,kCAAkC;AACpC,EAAE,kCAAkC;AACpC,EAAE,kCAAkC;AACpC,EAAE,kCAAkC;AACpC,EAAE,kCAAkC;AACpC,EAAE,kCAAkC;AACpC,EAAE,kCAAkC;AACpC,EAAE,kCAAkC;AACpC,EAAE,kCAAkC;AACpC,EAAE,kCAAkC;AACpC,EAAE,kCAAkC;AACpC,EAAE,kCAAkC;AACpC,EAAE,kCAAkC;AACpC,EAAE,kCAAkC;AACpC;;AAEA;;;;;;;;;;;ACrqBA;AACA;AACA,eAAe,mBAAO,CAAC,4DAAU;;AAEjC;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,yBAAyB;AACzB,iBAAiB,QAAQ;AACzB;AACA;AACA;AACA;;AAEA,yBAAyB;AACzB,iBAAiB,QAAQ;AACzB;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,oBAAoB;AACpB;AACA,oBAAoB;;AAEpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;;;AAGF;AACA;AACA;AACA;;AAEA;AACA,kCAAkC;AAClC;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAE;AACF;;;AAGA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,iCAAiC,WAAW;AAC5C;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iCAAiC;AACjC,eAAe,OAAO;AACtB,kCAAkC;AAClC;;AAEA,kCAAkC;AAClC;;AAEA,kCAAkC;AAClC;;AAEA,kCAAkC;AAClC;;AAEA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,uDAAuD;AACvD,0DAA0D;AAC1D,6DAA6D;AAC7D,+DAA+D;;AAE/D;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,iBAAiB;AACjB,uBAAuB;AACvB,wBAAwB;AACxB,wBAAwB;;AAExB;AACA;AACA,sBAAsB;AACtB;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA,qCAAqC;AACrC;AACA;;AAEA;AACA,qCAAqC;AACrC;AACA;;AAEA;AACA,qCAAqC;AACrC;AACA;;AAEA;AACA,qCAAqC;AACrC;AACA;;AAEA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA,0DAA0D;;AAE1D;AACA,6DAA6D;;AAE7D;AACA,gEAAgE;;AAEhE;AACA,kEAAkE;;AAElE;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA,mBAAmB;;AAEnB;AACA,yBAAyB;;AAEzB;AACA,0BAA0B;;AAE1B;AACA,0BAA0B;;AAE1B;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,gBAAgB,QAAQ;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,gBAAgB,QAAQ;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,gBAAgB,QAAQ;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,gBAAgB,QAAQ;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,gBAAgB,QAAQ;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;ACroDA,eAAe,mBAAO,CAAC,4DAAU;;AAEjC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;AC1PA,eAAe,mBAAO,CAAC,4DAAU;;AAEjC;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,kDAAkD;AAClD;AACA;AACA,sBAAsB;AACtB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,0CAA0C;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,kCAAkC;AAClC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,gBAAgB,SAAS;AACzB;;AAEA;AACA;AACA,kBAAkB,OAAO;AACzB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;AC/NA,eAAe,mBAAO,CAAC,4DAAU;;AAEjC;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,8BAA8B,kBAAkB;AAChD;AACA;AACA;AACA;AACA;;AAEA;AACA,8BAA8B,kBAAkB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;AC9JA,eAAe,mBAAO,CAAC,4DAAU;;AAEjC;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,8CAA8C,0BAA0B;AACxE;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;;;;;;;;;;AC7IA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,2BAA2B;AAC3B,8BAA8B;AAC9B,+BAA+B;AAC/B,+BAA+B;AAC/B,yBAAyB;;AAEzB;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL,gBAAgB;AAChB,8CAA8C;AAC9C,gDAAgD;AAChD,gDAAgD;;AAEhD,iDAAiD;AACjD,IAAI;AACJ;;AAEA;AACA,2BAA2B;AAC3B,0BAA0B;AAC1B,yBAAyB;;AAEzB,gBAAgB;AAChB,8CAA8C;AAC9C,iCAAiC;AACjC,IAAI;AACJ;;AAEA;AACA,yBAAyB;AACzB,yBAAyB;;AAEzB,gBAAgB;AAChB,sBAAsB;AACtB,qEAAqE;AACrE,IAAI;AACJ;AACA;;AAEA;;;;;;;;;;;ACrPA;AACA;AACA;AACA;;AAEA,mBAAmB;AACnB;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;;;;;ACnEA,iEAAe,qBAAuB,gBAAgB,E;;;;;;;;;;;;;;;ACAtD,iEAAe,qBAAuB,sBAAsB,E;;;;;;;;;;;;;;;ACA5D,iEAAe,qBAAuB,qBAAqB,E;;;;;;;;;;;;;;;ACA3D,iEAAe,qBAAuB,sBAAsB,E;;;;;;;;;;;;;;;ACA5D,iEAAe,qBAAuB,sBAAsB,E;;;;;;;;;;;;;;;ACA5D,iEAAe,qBAAuB,kBAAkB,E;;;;;;;;;;;;;;;ACAxD,iEAAe,qBAAuB,qBAAqB,E;;;;;;;;;;;;;;;ACA3D,iEAAe,qBAAuB,oBAAoB,E;;;;;;;;;;;;;;;ACA1D,iEAAe,qBAAuB,oBAAoB,E;;;;;;;;;;;;;;;ACA1D,iEAAe,qBAAuB,eAAe,E;;;;;;;;;;;;;;;ACArD,iEAAe,qBAAuB,qBAAqB,E;;;;;;;;;;;;;;;ACA3D,iEAAe,qBAAuB,aAAa,E;;;;;;;;;;;;;;;ACAnD,iEAAe,qBAAuB,eAAe,E;;;;;;;;;;;;;;;ACArD,iEAAe,qBAAuB,kBAAkB,E;;;;;;;;;;;;;;;ACAxD,iEAAe,qBAAuB,eAAe,E;;;;;;;;;;;;;;;ACArD,iEAAe,qBAAuB,yBAAyB,E;;;;;;;;;;;;;;;ACA/D,iEAAe,qBAAuB,iBAAiB,E;;;;;;;;;;;;;;;ACAvD,iEAAe,qBAAuB,iBAAiB,E;;;;;;;;;;;;;;;ACAvD,iEAAe,qBAAuB,eAAe,E;;;;;;;;;;;;;;;ACArD,iEAAe,qBAAuB,4BAA4B,E;;;;;;;;;;;;;;;ACAlE,iEAAe,qBAAuB,wBAAwB,E;;;;;;;;;;;;;;;ACA9D,iEAAe,qBAAuB,oBAAoB,E;;;;;;;;;;;;;;;ACA1D,iEAAe,qBAAuB,kBAAkB,E;;;;;;;;;;;;;;;ACAxD,iEAAe,qBAAuB,gBAAgB,E;;;;;;;;;;;;;;;ACAtD,iEAAe,qBAAuB,iBAAiB,E;;;;;;;;;;;;;;;ACAvD,iEAAe,qBAAuB,qBAAqB,E;;;;;;;;;;;;;;;ACA3D,iEAAe,qBAAuB,gBAAgB,E;;;;;;;;;;;;;;;ACAtD,iEAAe,qBAAuB,kBAAkB,E;;;;;;;;;;;;;;;ACAxD,iEAAe,qBAAuB,4BAA4B,E;;;;;;;;;;;;;;;ACAlE,iEAAe,qBAAuB,aAAa,E;;;;;;;;;;;;;;;ACAnD,iEAAe,qBAAuB,mBAAmB,E;;;;;;;;;;;;;;;ACAzD,iEAAe,qBAAuB,qBAAqB,E;;;;;;;;;;;;;;;ACA3D,iEAAe,qBAAuB,gBAAgB,E;;;;;;;;;;;;;;;ACAtD,iEAAe,qBAAuB,wBAAwB,E;;;;;;;;;;;;;;;ACA9D,iEAAe,qBAAuB,cAAc,E;;;;;;;;;;;;;;;ACApD,iEAAe,qBAAuB,gBAAgB,E;;;;;;;;;;;;;;;ACAtD,iEAAe,qBAAuB,sBAAsB,E;;;;;;;;;;;;;;;ACA5D,iEAAe,qBAAuB,gBAAgB,E;;;;;;;;;;;;ACAtD;;;;;;;;;;;ACAA;AACA;AACA,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA,2B;AACA,KAAK,IAA0C;AAC/C,EAAE,oCAAO,OAAO;AAAA;AAAA;AAAA;AAAA,kGAAC;AACjB,EAAE,MAAM,EAIN;AACF,CAAC;;AAED;;;;AAIA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,cAAc,sBAAsB;AACpC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA,KAAK,8FAA8F,KAAK,EAAE;AAC1G,KAAK,0EAA0E,MAAM,OAAO,KAAK,EAAE;AACnG,KAAK;AACL,qBAAqB,KAAK,SAAS,WAAW,eAAe,MAAM,EAAE;AACrE,KAAK,8CAA8C,eAAe;AAClE;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,IAAI;AACJ;AACA;AACA,IAAI;;AAEJ;AACA;;AAEA,GAAG;AACH;AACA;;;;AAIA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA,iBAAiB,wBAAwB;AACzC;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,iBAAiB,kCAAkC;AACnD;;AAEA;AACA;AACA;;AAEA,8CAA8C,KAAK;AACnD,qBAAqB,WAAW;AAChC,qBAAqB,eAAe;AACpC,qBAAqB,MAAM;;AAE3B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,GAAG;AACH;AACA,kBAAkB,oCAAoC;AACtD;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,uC;AACA;AACA;;AAEA,OAAO;AACP,qCAAqC;AACrC;;AAEA,MAAM;;AAEN,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;;AAEA,iC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAM;AACN,4BAA4B;AAC5B;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA,IAAI;AACJ;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN,KAAK;AACL;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA,IAAI;;AAEJ;;;;AAIA;AACA,G;AACA;AACA;AACA,yB;AACA,2B;AACA,I;AACA,GAAG;AACH,G;AACA;AACA;AACA,yB;AACA;AACA,IAAI;AACJ;AACA;AACA,I;AACA,GAAG;AACH,G;AACA;AACA;AACA,yB;AACA;AACA,IAAI;AACJ;AACA;AACA,I;AACA,GAAG;AACH,G;AACA;AACA;AACA;AACA,GAAG;AACH,G;AACA;AACA;AACA,yB;AACA;AACA,I;AACA,GAAG;AACH,G;AACA;AACA;AACA;AACA,GAAG;AACH,G;AACA;AACA;AACA;AACA,GAAG;AACH,G;AACA;AACA;AACA;AACA,GAAG;AACH,G;AACA;AACA;AACA,sB;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,I;AACA,GAAG;AACH,G;AACA;AACA;AACA,yB;AACA;AACA,I;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,iBAAiB,OAAO;AACxB;AACA;;AAEA,kBAAkB,wBAAwB;AAC1C;;AAEA;;AAEA,wCAAwC;;AAExC;AACA;AACA;AACA;;AAEA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;;AAKA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;AAGA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;;AAGH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;;AAGH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;;AAEH;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA,GAAG;;AAEH;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;;;AAIA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,2B;AACA;AACA,uD;AACA,mC;;AAEA;AACA;AACA,KAAK;AACL,yC;AACA;AACA;AACA,0B;AACA;;AAEA,kC;;AAEA;AACA,kCAAkC,gCAAgC;AAClE;;AAEA;AACA;;;;AAIA;AACA;;;AAGA,CAAC;;;;;;;;;;;AC51BD;AACA;AACA,oCAAoC;AACpC,2B;AACA,KAAK,IAA0C;AAC/C,EAAE,oCAAO,OAAO;AAAA;AAAA;AAAA;AAAA,kGAAC;AACjB,EAAE,MAAM,EAIN;AACF,CAAC;;AAED;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,iBAAiB;AACjC;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA,4F;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,I;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,yBAAyB,OAAO,WAAW;AAC3C;AACA;;AAEA,KAAK;AACL,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA,8B;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA,6CAA6C;AAC7C,I;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,gBAAgB,OAAO;AACvB;;AAEA,iBAAiB,OAAO;AACxB;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,2CAA2C,2BAA2B,EAAE;AACxE;AACA;AACA;AACA,gCAAgC,kBAAkB;AAClD;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,gBAAgB,iBAAiB;AACjC;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA,iC;AACA,UAAU,S;AACV;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;;;AAGA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,EAAE;;AAEF;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;;AAEA;AACA;AACA;;AAEA,iBAAiB,sBAAsB;AACvC;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA,iE;AACA;;AAEA;AACA,EAAE;AACF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA,EAAE;AACF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,I;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA,0B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,EAAE;;AAEF;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;;AAEA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,kE;;AAEA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;;AAEA;AACA;AACA;AACA;AACA,4D;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA,EAAE;;AAEF;AACA;AACA,2C;AACA;AACA,GAAG;AACH;AACA;AACA,IAAI,4B;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,K;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA,kD;AACA;;;;;;;;AAQA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;;AAEA;AACA;AACA,I;;AAEA;AACA,EAAE;AACF;AACA;AACA;;AAEA;AACA;;AAEA,0CAA0C;AAC1C;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;AAIA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;;AAEA;AACA;AACA;;AAEA;;AAEA,6BAA6B;AAC7B,2BAA2B;AAC3B;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,yCAAyC;;AAEzC;AACA;AACA,IAAI,kDAAkD;AACtD,IAAI,kDAAkD;AACtD,IAAI;AACJ;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,IAAI;AACJ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,YAAY,qBAAqB;AACjC;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,YAAY,iBAAiB;AAC7B;AACA;;AAEA;AACA,sDAAsD;AACtD,G;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA,GAAG;;AAEH;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAI;AACJ;;AAEA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,EAAE;;AAEF;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA,EAAE;;AAEF;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;;AAEA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA,EAAE;;;AAGF;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;;AAGA;AACA;;AAEA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,GAAG;AACH;AACA;;AAEA,wC;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,EAAE;;;AAGF;AACA;AACA,gBAAgB,iBAAiB;AACjC;AACA;AACA;AACA;AACA,EAAE;;AAEF;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,gBAAgB,aAAa;AAC7B;AACA;AACA,6CAA6C;;AAE7C;AACA;AACA;AACA,IAAI;AACJ;AACA,uCAAuC;;AAEvC;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,oC;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA,EAAE;;;;AAIF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;;AAIA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA,yBAAyB;;;AAGzB;AACA;;AAEA;AACA;AACA;;AAEA,iBAAiB,iBAAiB;AAClC;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,G;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;;;AAGA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,6BAA6B;;AAE7B;AACA;;AAEA;AACA,OAAO;AACP,QAAQ;AACR,WAAW;AACX,gBAAgB;AAChB,iBAAiB;AACjB;AACA,yBAAyB;AACzB;AACA;AACA,gBAAgB;;AAEhB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,EAAE;;AAEF,iBAAiB;AACjB;AACA;;AAEA;AACA;;AAEA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,W;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA,+DAA+D;AAC/D;AACA,EAAE;;;AAGF;AACA,cAAc;AACd,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAI;AACJ;AACA;AACA;AACA,iCAAiC;AACjC;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA,IAAI;AACJ;AACA;AACA,EAAE;;AAEF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;;AAEA;AACA;;;AAGA;;AAEA;;AAEA,IAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;;AAEA,KAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,MAAM;AACN;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;;AAGA;;AAEA,EAAE;;AAEF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;;AAIA;;AAEA;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;;;;AAIA;AACA;;AAEA;;AAEA;;AAEA;AACA;;;;AAIA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,IAAI;;AAEJ;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,wBAAwB;;AAExB;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;;AAGA,EAAE;;AAEF;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,kB;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAI;AACJ;AACA;AACA,G;AACA,EAAE;AACF;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,GAAG;;AAEH;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,EAAE;;AAEF;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,G;;;AAGA;AACA;AACA;AACA;AACA,qBAAqB;AACrB,KAAK;AACL,qBAAqB;AACrB,K;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;;AAEA;;;AAGA;;AAEA;;AAEA;AACA;AACA,IAAI;AACJ;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAsB;AACtB,oBAAoB;AACpB,qBAAqB;AACrB,qBAAqB;AACrB,4BAA4B;AAC5B,8BAA8B;AAC9B,iCAAiC;AACjC,sBAAsB;AACtB,0BAA0B;AAC1B,sBAAsB;AACtB;;;AAGA;AACA;AACA;AACA,KAAK;AACL,+DAA+D;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;;AAEA;AACA;;AAEA,MAAM;AACN;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,IAAI;;AAEJ;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAE;;;AAGF;AACA;AACA;AACA;AACA;;;;AAIA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;AAIA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA,4B;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,EAAE;;AAEF;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,IAAI;AACJ;AACA;AACA,IAAI;AACJ,iD;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,+C;;AAEA;AACA;AACA,wDAAwD;;AAExD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,CAAC;;;AAGD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,oCAAoC,SAAS;AAC7C;AACA,kB;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL,IAAI;AACJ;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,MAAM;AACN;AACA;;AAEA;;AAEA;;;AAGA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAM;AACN;AACA;;AAEA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;;AAEA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA,IAAI,iBAAiB;AACrB;AACA;AACA;AACA;;;AAGA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,QAAQ,QAAQ;AAChB,QAAQ;AACR;AACA,EAAE;AACF;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;;AAEA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,oC;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,EAAE;;;;;AAKF;;;AAGA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,EAAE;;;;AAIF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAI;AACJ,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,I;;AAEA,qBAAqB;;AAErB;AACA,EAAE;AACF;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,EAAE;AACF;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAE;AACF;;AAEA;AACA;;AAEA,iBAAiB,gCAAgC;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,yCAAyC;;;;AAIzC;AACA;AACA,0BAA0B;AAC1B;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA,cAAc,8CAA8C;AAC5D;AACA;AACA,cAAc,8CAA8C;AAC5D;AACA;AACA,IAAI;;AAEJ;AACA;AACA,IAAI;;AAEJ;AACA;;;;AAIA;AACA;AACA,kBAAkB,mBAAmB;AACrC;AACA;AACA;AACA,4B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,GAAG;;;AAGH;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,+G;AACA;AACA,GAAG;;AAEH;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,wE;;;;AAIA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,QAAQ;AACR;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,qBAAqB;;AAErB;AACA;;AAEA;;AAEA,mE;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;;;;AAKA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,MAAM;AACN;AACA;AACA;;AAEA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,IAAI;AACJ;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,CAAC;;AAED;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,qBAAqB;AACrB,qE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,CAAC;;AAED;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,IAAI;AACJ;AACA;;AAEA,GAAG;;AAEH;;AAEA;;AAEA;;AAEA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA,IAAI;;AAEJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;;AAEA;AACA;AACA;;AAEA,GAAG;;AAEH;;AAEA;AACA;;AAEA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA,iCAAiC;;AAEjC;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA,CAAC;;;AAGD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;;AAEA,uBAAuB;AACvB;AACA;;AAEA;AACA,aAAa,iBAAiB;AAC9B;AACA;AACA;AACA,iC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB,aAAa,mBAAmB;AAChC;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA,GAAG;AACH;AACA;AACA,IAAI;AACJ;AACA;AACA;;;;AAIA;AACA;AACA;AACA,GAAG;AACH;;;;;;AAMA;;;;AAIA;AACA;;AAEA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,IAAI;;;AAGJ;AACA;AACA;;AAEA;AACA;AACA,MAAM;;AAEN;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,IAAI;;;;;AAKJ;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA,iBAAiB;AACjB;AACA;AACA,IAAI;;AAEJ,GAAG;AACH;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,GAAG;AACH;;AAEA;AACA;;AAEA;;;AAGA;AACA;AACA;;AAEA;AACA,kBAAkB;AAClB,IAAI;AACJ;AACA;AACA;;AAEA;AACA,CAAC;;;AAGD;AACA,uCAAuC;AACvC;AACA,CAAC,E;;;;;;;;;;;;;;;;;;;;ACrpHmC;AAC6B;;AAEjE;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,WAAW,OAAO;AAClB;AACe;AACf;AACA;AACA;AACA;AACA;AACA,iBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,kBAAkB;AAC7B,WAAW,OAAO;AAClB;AACO;AACP;AACA;AACA,wBAAwB,mDAAU,MAAM,8EAAY;AACpD;AACA;AACA,KAAK;AACL;AACA;AACA;;;;;;;;;;;;;;;;;;AC7F4C;;AAErC;AACP,8CAA8C,yBAAyB,EAAE,QAAQ;AACjF;AACA;;AAEO;AACP,EAAE,kEAAuB;AACzB,C;;;;;;;;;;;;;;;ACTO;AACP;AACA;AACA;AACA;AACA;AACA,kB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,QAAQ;AAC5D,eAAe;AACf;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA,kDAAkD,QAAQ;AAC1D;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,QAAQ;;AAE5D,eAAe;AACf;AACA;AACA;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA;AACA,kDAAkD,QAAQ;;AAE1D;AACA;AACA,WAAW;AACX;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA,C;;;;;;;;;;;;;;;ACxEO;AACP;AACA;AACA;AACA;AACA;AACA,C;;;;;;;;;;;;;;;;ACN2C;;AAE3C,iEAAe;AACf;AACA,EAAE,gDAAa;AACf;AACA,EAAE,+CAAY;AACd,C;;;;;;;;;;;;;;;ACPO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,C;;;;;;;;;;;;;;;;ACT0C;;AAE1C,iEAAe;AACf;AACA;AACA;AACA,MAAM,8EAAsC;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,C;;;;;;;;;;;;;;;;;ACnBkC;;;AAG3B;AACP;AACA,aAAa,qDAAkB;AAC/B;AACA;AACA;AACA,GAAG;AACH;;AAEO;AACP,aAAa,qDAAkB;AAC/B;;;;;;;;;;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+D;;;;;;UC3DA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCtBA;WACA;WACA;WACA;WACA;WACA,gCAAgC,YAAY;WAC5C;WACA,E;;;;;WCPA;WACA;WACA;WACA;WACA,wCAAwC,yCAAyC;WACjF;WACA;WACA,E;;;;;WCPA;WACA;WACA;WACA;WACA,EAAE;WACF;WACA;WACA,CAAC,I;;;;;WCPD,wF;;;;;WCAA;WACA;WACA;WACA,sDAAsD,kBAAkB;WACxE;WACA,+CAA+C,cAAc;WAC7D,E;;;;;WCNA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA,0C;;;;;;;;;;;;;;;;;;;;;ACf2B;;AAE3B,YAAY,+DAAoD;AAChE;;AAEA,CAAyC;AACc;AACe;AACR;AACI;AAC1B;AACuB;;AAE/D;;AAEA;AACA;AACA,wBAAwB,yBAAyB;AACjD,CAAC;;AAED;AACA,EAAE,sEAAiB;AACnB;;AAEA,IAAI,+DAAuB;AAC3B,iBAAiB,wEAA+B;AAChD,mBAAmB,+DAAuB;AAC1C;;AAEA,IAAI,8DAAsB;AAC1B,aAAa,8DAAsB;AACnC;AACA;AACA,MAAM,kEAAa;AACnB,KAAK;AACL;AACA;AACA,IAAI,8DAAsB;AAC1B,EAAE,+EAAuC;AACzC;AACA,IAAI,oEAA2B;AAC/B;AACA,GAAG;AACH;;AAEA,IAAI,kEAA0B;AAC9B,aAAa,kEAA0B;AACvC;AACA;AACA,kBAAkB,mEAA0B;AAC5C,MAAM,sEAA6B;AACnC;AACA;AACA,yBAAyB,iDAAa,OAAO,oBAAoB;AACjE,KAAK;AACL;AACA","file":"js/client.bundle.js","sourcesContent":["const JSMpeg = require(\"./src/jsmpeg\");\n\nJSMpeg.VideoElement = require(\"./src/video-element\");\nJSMpeg.Player = require(\"./src/player\");\nJSMpeg.BitBuffer = require(\"./src/buffer\");\nJSMpeg.Source.Ajax = require(\"./src/ajax\");\nJSMpeg.Source.AjaxProgressive = require(\"./src/ajax-progressive\");\nJSMpeg.Source.WebSocket = require(\"./src/websocket\");\nJSMpeg.Demuxer.TS = require(\"./src/ts\");\nJSMpeg.Decoder.Base = require(\"./src/decoder\");\nJSMpeg.Decoder.MPEG1Video = require(\"./src/mpeg1\");\nJSMpeg.Decoder.MP2Audio = require(\"./src/mp2\");\nJSMpeg.Renderer.WebGL = require(\"./src/webgl\");\nJSMpeg.Renderer.Canvas2D = require(\"./src/canvas2d\");\nJSMpeg.AudioOutput.WebAudio = require(\"./src/webaudio\");\n\nmodule.exports = JSMpeg;\n","const JSMpeg = require(\"./jsmpeg\");\n\nvar AjaxProgressiveSource = function(url, options) {\n\tthis.url = url;\n\tthis.destination = null;\n\tthis.request = null;\n\n\tthis.completed = false;\n\tthis.established = false;\n\tthis.progress = 0;\n\n\tthis.fileSize = 0;\n\tthis.loadedSize = 0;\n\tthis.chunkSize = options.chunkSize || 1024*1024;\n\n\tthis.isLoading = false;\n\tthis.loadStartTime = 0;\n\tthis.throttled = options.throttled !== false;\n\tthis.aborted = false;\n};\n\nAjaxProgressiveSource.prototype.connect = function(destination) {\n\tthis.destination = destination;\n};\n\nAjaxProgressiveSource.prototype.start = function() {\n\tthis.request = new XMLHttpRequest();\n\n\tthis.request.onreadystatechange = function() {\n\t\tif (this.request.readyState === this.request.DONE) {\n\t\t\tthis.fileSize = parseInt(\n\t\t\t\tthis.request.getResponseHeader(\"Content-Length\")\n\t\t\t);\n\t\t\tthis.loadNextChunk();\n\t\t}\n\t}.bind(this);\n\n\tthis.request.onprogress = this.onProgress.bind(this);\n\tthis.request.open('HEAD', this.url);\n\tthis.request.send();\n};\n\nAjaxProgressiveSource.prototype.resume = function(secondsHeadroom) {\n\tif (this.isLoading || !this.throttled) {\n\t\treturn;\n\t}\n\n\t// Guess the worst case loading time with lots of safety margin. This is\n\t// somewhat arbitrary...\n\tvar worstCaseLoadingTime = this.loadTime * 8 + 2;\n\tif (worstCaseLoadingTime > secondsHeadroom) {\n\t\tthis.loadNextChunk();\n\t}\n};\n\nAjaxProgressiveSource.prototype.destroy = function() {\n\tthis.request.abort();\n\tthis.aborted = true;\n};\n\nAjaxProgressiveSource.prototype.loadNextChunk = function() {\n\tvar start = this.loadedSize,\n\t\tend = Math.min(this.loadedSize + this.chunkSize-1, this.fileSize-1);\n\n\tif (start >= this.fileSize || this.aborted) {\n\t\tthis.completed = true;\n\t\treturn;\n\t}\n\n\tthis.isLoading = true;\n\tthis.loadStartTime = JSMpeg.Now();\n\tthis.request = new XMLHttpRequest();\n\n\tthis.request.onreadystatechange = function() {\n\t\tif (\n\t\t\tthis.request.readyState === this.request.DONE &&\n\t\t\tthis.request.status >= 200 && this.request.status < 300\n\t\t) {\n\t\t\tthis.onChunkLoad(this.request.response);\n\t\t}\n\t\telse if (this.request.readyState === this.request.DONE) {\n\t\t\t// Retry?\n\t\t\tif (this.loadFails++ < 3) {\n\t\t\t\tthis.loadNextChunk();\n\t\t\t}\n\t\t}\n\t}.bind(this);\n\n\tif (start === 0) {\n\t\tthis.request.onprogress = this.onProgress.bind(this);\n\t}\n\n\tthis.request.open('GET', this.url+'?'+start+\"-\"+end);\n\tthis.request.setRequestHeader(\"Range\", \"bytes=\"+start+\"-\"+end);\n\tthis.request.responseType = \"arraybuffer\";\n\tthis.request.send();\n};\n\nAjaxProgressiveSource.prototype.onProgress = function(ev) {\n\tthis.progress = (ev.loaded / ev.total);\n};\n\nAjaxProgressiveSource.prototype.onChunkLoad = function(data) {\n\tthis.established = true;\n\tthis.progress = 1;\n\tthis.loadedSize += data.byteLength;\n\tthis.loadFails = 0;\n\tthis.isLoading = false;\n\n\tif (this.destination) {\n\t\tthis.destination.write(data);\n\t}\n\n\tthis.loadTime = JSMpeg.Now() - this.loadStartTime;\n\tif (!this.throttled) {\n\t\tthis.loadNextChunk();\n\t}\n};\n\nmodule.exports = AjaxProgressiveSource;\n","var AjaxSource = function(url, options) {\n\tthis.url = url;\n\tthis.destination = null;\n\tthis.request = null;\n\n\tthis.completed = false;\n\tthis.established = false;\n\tthis.progress = 0;\n};\n\nAjaxSource.prototype.connect = function(destination) {\n\tthis.destination = destination;\n};\n\nAjaxSource.prototype.start = function() {\n\tthis.request = new XMLHttpRequest();\n\n\tthis.request.onreadystatechange = function() {\n\t\tif (\n\t\t\tthis.request.readyState === this.request.DONE &&\n\t\t\tthis.request.status === 200\n\t\t) {\n\t\t\tthis.onLoad(this.request.response);\n\t\t}\n\t}.bind(this);\n\n\tthis.request.onprogress = this.onProgress.bind(this);\n\tthis.request.open('GET', this.url);\n\tthis.request.responseType = \"arraybuffer\";\n\tthis.request.send();\n};\n\nAjaxSource.prototype.resume = function(secondsHeadroom) {\n\t// Nothing to do here\n};\n\nAjaxSource.prototype.destroy = function() {\n\tthis.request.abort();\n};\n\nAjaxSource.prototype.onProgress = function(ev) {\n\tthis.progress = (ev.loaded / ev.total);\n};\n\nAjaxSource.prototype.onLoad = function(data) {\n\tthis.established = true;\n\tthis.completed = true;\n\tthis.progress = 1;\n\n\tif (this.destination) {\n\t\tthis.destination.write(data);\n\t}\n};\n\nmodule.exports = AjaxSource;\n","var BitBuffer = function(bufferOrLength, mode) {\n\tif (typeof(bufferOrLength) === 'object') {\n\t\tthis.bytes = (bufferOrLength instanceof Uint8Array)\n\t\t\t? bufferOrLength\n\t\t\t: new Uint8Array(bufferOrLength);\n\n\t\tthis.byteLength = this.bytes.length;\n\t}\n\telse {\n\t\tthis.bytes = new Uint8Array(bufferOrLength || 1024*1024);\n\t\tthis.byteLength = 0;\n\t}\n\n\tthis.mode = mode || BitBuffer.MODE.EXPAND;\n\tthis.index = 0;\n};\n\nBitBuffer.prototype.resize = function(size) {\n\tvar newBytes = new Uint8Array(size);\n\tif (this.byteLength !== 0) {\n\t\tthis.byteLength = Math.min(this.byteLength, size);\n\t\tnewBytes.set(this.bytes, 0, this.byteLength);\n\t}\n\tthis.bytes = newBytes;\n\tthis.index = Math.min(this.index, this.byteLength << 3);\n};\n\nBitBuffer.prototype.evict = function(sizeNeeded) {\n\tvar bytePos = this.index >> 3,\n\t\tavailable = this.bytes.length - this.byteLength;\n\n\t// If the current index is the write position, we can simply reset both\n\t// to 0. Also reset (and throw away yet unread data) if we won't be able\n\t// to fit the new data in even after a normal eviction.\n\tif (\n\t\tthis.index === this.byteLength << 3 ||\n\t\tsizeNeeded > available + bytePos // emergency evac\n\t) {\n\t\tthis.byteLength = 0;\n\t\tthis.index = 0;\n\t\treturn;\n\t}\n\telse if (bytePos === 0) {\n\t\t// Nothing read yet - we can't evict anything\n\t\treturn;\n\t}\n\n\t// Some browsers don't support copyWithin() yet - we may have to do\n\t// it manually using set and a subarray\n\tif (this.bytes.copyWithin) {\n\t\tthis.bytes.copyWithin(0, bytePos, this.byteLength);\n\t}\n\telse {\n\t\tthis.bytes.set(this.bytes.subarray(bytePos, this.byteLength));\n\t}\n\n\tthis.byteLength = this.byteLength - bytePos;\n\tthis.index -= bytePos << 3;\n\treturn;\n};\n\nBitBuffer.prototype.write = function(buffers) {\n\tvar isArrayOfBuffers = (typeof(buffers[0]) === 'object'),\n\t\ttotalLength = 0,\n\t\tavailable = this.bytes.length - this.byteLength;\n\n\t// Calculate total byte length\n\tif (isArrayOfBuffers) {\n\t\tvar totalLength = 0;\n\t\tfor (var i = 0; i < buffers.length; i++) {\n\t\t\ttotalLength += buffers[i].byteLength;\n\t\t}\n\t}\n\telse {\n\t\ttotalLength = buffers.byteLength;\n\t}\n\n\t// Do we need to resize or evict?\n\tif (totalLength > available) {\n\t\tif (this.mode === BitBuffer.MODE.EXPAND) {\n\t\t\tvar newSize = Math.max(\n\t\t\t\tthis.bytes.length * 2,\n\t\t\t\ttotalLength - available\n\t\t\t);\n\t\t\tthis.resize(newSize)\n\t\t}\n\t\telse {\n\t\t\tthis.evict(totalLength);\n\t\t}\n\t}\n\n\tif (isArrayOfBuffers) {\n\t\tfor (var i = 0; i < buffers.length; i++) {\n\t\t\tthis.appendSingleBuffer(buffers[i]);\n\t\t}\n\t}\n\telse {\n\t\tthis.appendSingleBuffer(buffers);\n\t}\n};\n\nBitBuffer.prototype.appendSingleBuffer = function(buffer) {\n\tbuffer = buffer instanceof Uint8Array\n\t\t? buffer\n\t\t: new Uint8Array(buffer);\n\n\tthis.bytes.set(buffer, this.byteLength);\n\tthis.byteLength += buffer.length;\n};\n\nBitBuffer.prototype.findNextStartCode = function() {\n\tfor (var i = (this.index+7 >> 3); i < this.byteLength; i++) {\n\t\tif(\n\t\t\tthis.bytes[i] == 0x00 &&\n\t\t\tthis.bytes[i+1] == 0x00 &&\n\t\t\tthis.bytes[i+2] == 0x01\n\t\t) {\n\t\t\tthis.index = (i+4) << 3;\n\t\t\treturn this.bytes[i+3];\n\t\t}\n\t}\n\tthis.index = (this.byteLength << 3);\n\treturn -1;\n};\n\nBitBuffer.prototype.findStartCode = function(code) {\n\tvar current = 0;\n\twhile (true) {\n\t\tcurrent = this.findNextStartCode();\n\t\tif (current === code || current === -1) {\n\t\t\treturn current;\n\t\t}\n\t}\n\treturn -1;\n};\n\nBitBuffer.prototype.nextBytesAreStartCode = function() {\n\tvar i = (this.index+7 >> 3);\n\treturn (\n\t\ti >= this.byteLength || (\n\t\t\tthis.bytes[i] == 0x00 &&\n\t\t\tthis.bytes[i+1] == 0x00 &&\n\t\t\tthis.bytes[i+2] == 0x01\n\t\t)\n\t);\n};\n\nBitBuffer.prototype.peek = function(count) {\n\tvar offset = this.index;\n\tvar value = 0;\n\twhile (count) {\n\t\tvar currentByte = this.bytes[offset >> 3],\n\t\t\tremaining = 8 - (offset & 7), // remaining bits in byte\n\t\t\tread = remaining < count ? remaining : count, // bits in this run\n\t\t\tshift = remaining - read,\n\t\t\tmask = (0xff >> (8-read));\n\n\t\tvalue = (value << read) | ((currentByte & (mask << shift)) >> shift);\n\n\t\toffset += read;\n\t\tcount -= read;\n\t}\n\n\treturn value;\n}\n\nBitBuffer.prototype.read = function(count) {\n\tvar value = this.peek(count);\n\tthis.index += count;\n\treturn value;\n};\n\nBitBuffer.prototype.skip = function(count) {\n\treturn (this.index += count);\n};\n\nBitBuffer.prototype.rewind = function(count) {\n\tthis.index = Math.max(this.index - count, 0);\n};\n\nBitBuffer.prototype.has = function(count) {\n\treturn ((this.byteLength << 3) - this.index) >= count;\n};\n\nBitBuffer.MODE = {\n\tEVICT: 1,\n\tEXPAND: 2\n};\n\nmodule.exports = BitBuffer;\n","const JSMpeg = require(\"./jsmpeg\");\n\nvar CanvasRenderer = function(options) {\n\tthis.canvas = options.canvas || document.createElement('canvas');\n\tthis.silence = options.disableGl && options.silence;\n\tthis.width = this.canvas.width;\n\tthis.height = this.canvas.height;\n\tthis.enabled = true;\n\n\tthis.context = this.canvas.getContext('2d');\n};\n\nCanvasRenderer.prototype.destroy = function() {\n\t// Nothing to do here\n};\n\nCanvasRenderer.prototype.resize = function(width, height) {\n\tthis.width = width|0;\n\tthis.height = height|0;\n\n\tthis.canvas.width = this.width;\n\tthis.canvas.height = this.height;\n\n\tthis.imageData = this.context.getImageData(0, 0, this.width, this.height);\n\tJSMpeg.Fill(this.imageData.data, 255);\n};\n\nCanvasRenderer.prototype.renderProgress = function(progress) {\n\tvar\n\t\tw = this.canvas.width,\n\t\th = this.canvas.height,\n\t\tctx = this.context;\n\n\tctx.fillStyle = '#222';\n\tctx.fillRect(0, 0, w, h);\n\tctx.fillStyle = '#fff';\n\tctx.fillRect(0, h - h * progress, w, h * progress);\n};\n\nCanvasRenderer.prototype.render = function(y, cb, cr) {\n\tthis.YCbCrToRGBA(y, cb, cr, this.imageData.data);\n\tif (!this.silence) this.context.putImageData(this.imageData, 0, 0);\n};\n\nCanvasRenderer.prototype.YCbCrToRGBA = function(y, cb, cr, rgba) {\n\tif (!this.enabled) {\n\t\treturn;\n\t}\n\n\t// Chroma values are the same for each block of 4 pixels, so we proccess\n\t// 2 lines at a time, 2 neighboring pixels each.\n\t// I wish we could use 32bit writes to the RGBA buffer instead of writing\n\t// each byte separately, but we need the automatic clamping of the RGBA\n\t// buffer.\n\n\tvar w = ((this.width + 15) >> 4) << 4,\n\t\tw2 = w >> 1;\n\n\tvar yIndex1 = 0,\n\t\tyIndex2 = w,\n\t\tyNext2Lines = w + (w - this.width);\n\n\tvar cIndex = 0,\n\t\tcNextLine = w2 - (this.width >> 1);\n\n\tvar rgbaIndex1 = 0,\n\t\trgbaIndex2 = this.width * 4,\n\t\trgbaNext2Lines = this.width * 4;\n\n\tvar cols = this.width >> 1,\n\t\trows = this.height >> 1;\n\n\tvar ccb, ccr, r, g, b;\n\n\tfor (var row = 0; row < rows; row++) {\n\t\tfor (var col = 0; col < cols; col++) {\n\t\t\tccb = cb[cIndex];\n\t\t\tccr = cr[cIndex];\n\t\t\tcIndex++;\n\n\t\t\tr = (ccb + ((ccb * 103) >> 8)) - 179;\n\t\t\tg = ((ccr * 88) >> 8) - 44 + ((ccb * 183) >> 8) - 91;\n\t\t\tb = (ccr + ((ccr * 198) >> 8)) - 227;\n\n\t\t\t// Line 1\n\t\t\tvar y1 = y[yIndex1++];\n\t\t\tvar y2 = y[yIndex1++];\n\t\t\trgba[rgbaIndex1]   = y1 + r;\n\t\t\trgba[rgbaIndex1+1] = y1 - g;\n\t\t\trgba[rgbaIndex1+2] = y1 + b;\n\t\t\trgba[rgbaIndex1+4] = y2 + r;\n\t\t\trgba[rgbaIndex1+5] = y2 - g;\n\t\t\trgba[rgbaIndex1+6] = y2 + b;\n\t\t\trgbaIndex1 += 8;\n\n\t\t\t// Line 2\n\t\t\tvar y3 = y[yIndex2++];\n\t\t\tvar y4 = y[yIndex2++];\n\t\t\trgba[rgbaIndex2]   = y3 + r;\n\t\t\trgba[rgbaIndex2+1] = y3 - g;\n\t\t\trgba[rgbaIndex2+2] = y3 + b;\n\t\t\trgba[rgbaIndex2+4] = y4 + r;\n\t\t\trgba[rgbaIndex2+5] = y4 - g;\n\t\t\trgba[rgbaIndex2+6] = y4 + b;\n\t\t\trgbaIndex2 += 8;\n\t\t}\n\n\t\tyIndex1 += yNext2Lines;\n\t\tyIndex2 += yNext2Lines;\n\t\trgbaIndex1 += rgbaNext2Lines;\n\t\trgbaIndex2 += rgbaNext2Lines;\n\t\tcIndex += cNextLine;\n\t}\n};\n\nmodule.exports = CanvasRenderer;\n","var BaseDecoder = function(options) {\n\tthis.destination = null;\n\tthis.canPlay = false;\n\n\tthis.collectTimestamps = !options.streaming;\n\tthis.timestamps = [];\n\tthis.timestampIndex = 0;\n\n\tthis.startTime = 0;\n\tthis.decodedTime = 0;\n\n\tObject.defineProperty(this, 'currentTime', {get: this.getCurrentTime});\n};\n\nBaseDecoder.prototype.connect = function(destination) {\n\tthis.destination = destination;\n};\n\nBaseDecoder.prototype.write = function(pts, buffers) {\n\tif (this.collectTimestamps) {\n\t\tif (this.timestamps.length === 0) {\n\t\t\tthis.startTime = pts;\n\t\t\tthis.decodedTime = pts;\n\t\t}\n\t\tthis.timestamps.push({index: this.bits.byteLength << 3, time: pts});\n\t}\n\n\tthis.bits.write(buffers);\n\tthis.canPlay = true;\n};\n\nBaseDecoder.prototype.seek = function(time) {\n\tif (!this.collectTimestamps) {\n\t\treturn;\n\t}\n\n\tthis.timestampIndex = 0;\n\tfor (var i = 0; i < this.timestamps.length; i++) {\n\t\tif (this.timestamps[i].time > time) {\n\t\t\tbreak;\n\t\t}\n\t\tthis.timestampIndex = i;\n\t}\n\n\tvar ts = this.timestamps[this.timestampIndex];\n\tif (ts) {\n\t\tthis.bits.index = ts.index;\n\t\tthis.decodedTime = ts.time;\n\t}\n\telse {\n\t\tthis.bits.index = 0;\n\t\tthis.decodedTime = this.startTime;\n\t}\n};\n\nBaseDecoder.prototype.decode = function() {\n\tthis.advanceDecodedTime(0);\n};\n\nBaseDecoder.prototype.advanceDecodedTime = function(seconds) {\n\tif (this.collectTimestamps) {\n\t\tvar newTimestampIndex = -1;\n\t\tfor (var i = this.timestampIndex; i < this.timestamps.length; i++) {\n\t\t\tif (this.timestamps[i].index > this.bits.index) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tnewTimestampIndex = i;\n\t\t}\n\n\t\t// Did we find a new PTS, different from the last? If so, we don't have\n\t\t// to advance the decoded time manually and can instead sync it exactly\n\t\t// to the PTS.\n\t\tif (\n\t\t\tnewTimestampIndex !== -1 &&\n\t\t\tnewTimestampIndex !== this.timestampIndex\n\t\t) {\n\t\t\tthis.timestampIndex = newTimestampIndex;\n\t\t\tthis.decodedTime = this.timestamps[this.timestampIndex].time;\n\t\t\treturn;\n\t\t}\n\t}\n\n\tthis.decodedTime += seconds;\n};\n\nBaseDecoder.prototype.getCurrentTime = function() {\n\treturn this.decodedTime;\n};\n\nmodule.exports = BaseDecoder;\n","/*! jsmpeg v1.0 | (c) Dominic Szablewski | MIT license */\n\n\n// This sets up the JSMpeg \"Namespace\". The object is empty apart from the Now()\n// utility function and the automatic CreateVideoElements() after DOMReady.\nvar JSMpeg = {\n\n\t// The Player sets up the connections between source, demuxer, decoders,\n\t// renderer and audio output. It ties everything together, is responsible\n\t// of scheduling decoding and provides some convenience methods for\n\t// external users.\n\tPlayer: null,\n\n\t// A Video Element wraps the Player, shows HTML controls to start/pause\n\t// the video and handles Audio unlocking on iOS. VideoElements can be\n\t// created directly in HTML using the <div class=\"jsmpeg\"/> tag.\n\tVideoElement: null,\n\n\t// The BitBuffer wraps a Uint8Array and allows reading an arbitrary number\n\t// of bits at a time. On writing, the BitBuffer either expands its\n\t// internal buffer (for static files) or deletes old data (for streaming).\n\tBitBuffer: null,\n\n\t// A Source provides raw data from HTTP, a WebSocket connection or any\n\t// other mean. Sources must support the following API:\n\t//   .connect(destinationNode)\n\t//   .write(buffer)\n\t//   .start() - start reading\n\t//   .resume(headroom) - continue reading; headroom to play pos in seconds\n\t//   .established - boolean, true after connection is established\n\t//   .completed - boolean, true if the source is completely loaded\n\t//   .progress - float 0-1\n\tSource: {},\n\n\t// A Demuxer may sit between a Source and a Decoder. It separates the\n\t// incoming raw data into Video, Audio and other Streams. API:\n\t//   .connect(streamId, destinationNode)\n\t//   .write(buffer)\n\t//   .currentTime – float, in seconds\n\t//   .startTime - float, in seconds\n\tDemuxer: {},\n\n\t// A Decoder accepts an incoming Stream of raw Audio or Video data, buffers\n\t// it and upon `.decode()` decodes a single frame of data. Video decoders\n\t// call `destinationNode.render(Y, Cr, CB)` with the decoded pixel data;\n\t// Audio decoders call `destinationNode.play(left, right)` with the decoded\n\t// PCM data. API:\n\t//   .connect(destinationNode)\n\t//   .write(pts, buffer)\n\t//   .decode()\n\t//   .seek(time)\n\t//   .currentTime - float, in seconds\n\t//   .startTime - float, in seconds\n\tDecoder: {},\n\n\t// A Renderer accepts raw YCrCb data in 3 separate buffers via the render()\n\t// method. Renderers typically convert the data into the RGBA color space\n\t// and draw it on a Canvas, but other output - such as writing PNGs - would\n\t// be conceivable. API:\n\t//   .render(y, cr, cb) - pixel data as Uint8Arrays\n\t//   .enabled - wether the renderer does anything upon receiving data\n\tRenderer: {},\n\n\t// Audio Outputs accept raw Stero PCM data in 2 separate buffers via the\n\t// play() method. Outputs typically play the audio on the user's device.\n\t// API:\n\t//   .play(sampleRate, left, right) - rate in herz; PCM data as Uint8Arrays\n\t//   .stop()\n\t//   .enqueuedTime - float, in seconds\n\t//   .enabled - wether the output does anything upon receiving data\n\tAudioOutput: {},\n\n\tNow: function() {\n\t\treturn window.performance ? window.performance.now() / 1000 : Date.now() / 1000;\n\t},\n\n\tCreateVideoElements: function() {\n\t\tvar elements = document.querySelectorAll('.jsmpeg');\n\t\tfor (var i = 0; i < elements.length; i++) {\n\t\t\tnew JSMpeg.VideoElement(elements[i]);\n\t\t}\n\t},\n\n\tFill: function(array, value) {\n\t\tif (array.fill) {\n\t\t\tarray.fill(value);\n\t\t}\n\t\telse {\n\t\t\tfor (var i = 0; i < array.length; i++) {\n\t\t\t\tarray[i] = value;\n\t\t\t}\n\t\t}\n\t}\n};\nmodule.exports = JSMpeg;\n\n// Automatically create players for all found <div class=\"jsmpeg\"/> elements.\n// if (document.readyState === 'complete') {\n// \tJSMpeg.CreateVideoElements();\n// }\n// else {\n// \tdocument.addEventListener('DOMContentLoaded', JSMpeg.CreateVideoElements);\n// }\n","// Based on kjmp2 by Martin J. Fiedler\n// http://keyj.emphy.de/kjmp2/\nconst JSMpeg = require(\"./jsmpeg\");\n\nvar MP2 = function(options) {\n\tJSMpeg.Decoder.Base.call(this, options);\n\n\tvar bufferSize = options.audioBufferSize || 128*1024;\n\tvar bufferMode = options.streaming\n\t\t? JSMpeg.BitBuffer.MODE.EVICT\n\t\t: JSMpeg.BitBuffer.MODE.EXPAND;\n\n\tthis.bits = new JSMpeg.BitBuffer(bufferSize, bufferMode);\n\n\tthis.left = new Float32Array(1152);\n\tthis.right = new Float32Array(1152);\n\tthis.sampleRate = 44100;\n\n\tthis.D = new Float32Array(1024);\n\tthis.D.set(MP2.SYNTHESIS_WINDOW, 0);\n\tthis.D.set(MP2.SYNTHESIS_WINDOW, 512);\n\tthis.V = new Float32Array(1024);\n\tthis.U = new Int32Array(32);\n\tthis.VPos = 0;\n\n\tthis.allocation = [new Array(32), new Array(32)];\n\tthis.scaleFactorInfo = [new Uint8Array(32), new Uint8Array(32)];\n\tthis.scaleFactor = [new Array(32), new Array(32)];\n\tthis.sample = [new Array(32), new Array(32)];\n\n\tfor (var j = 0; j < 2; j++) {\n\t\tfor (var i = 0; i < 32; i++) {\n\t\t\tthis.scaleFactor[j][i] = [0, 0, 0];\n\t\t\tthis.sample[j][i] = [0, 0, 0];\n\t\t}\n\t}\n};\n\nMP2.prototype = Object.create(JSMpeg.Decoder.Base.prototype);\nMP2.prototype.constructor = MP2;\n\nMP2.prototype.decode = function() {\n\tvar pos = this.bits.index >> 3;\n\tif (pos >= this.bits.byteLength) {\n\t\treturn false;\n\t}\n\n\tvar decoded = this.decodeFrame(this.left, this.right);\n\tthis.bits.index = (pos + decoded) << 3;\n\n\tif (!decoded) {\n\t\treturn false;\n\t}\n\n\tif (this.destination) {\n\t\tthis.destination.play(this.sampleRate, this.left, this.right);\n\t}\n\n\tthis.advanceDecodedTime(this.left.length / this.sampleRate);\n\treturn true;\n};\n\nMP2.prototype.getCurrentTime = function() {\n\tvar enqueuedTime = this.destination ? this.destination.enqueuedTime : 0;\n\treturn this.decodedTime - enqueuedTime;\n};\n\nMP2.prototype.decodeFrame = function(left, right) {\n\t// Check for valid header: syncword OK, MPEG-Audio Layer 2\n\tvar sync = this.bits.read(11),\n\t\tversion = this.bits.read(2),\n\t\tlayer = this.bits.read(2),\n\t\thasCRC = !this.bits.read(1);\n\n\tif (\n\t\tsync !== MP2.FRAME_SYNC ||\n\t\tversion !== MP2.VERSION.MPEG_1 ||\n\t\tlayer !== MP2.LAYER.II\n\t) {\n\t\treturn 0; // Invalid header or unsupported version\n\t}\n\n\tvar bitrateIndex = this.bits.read(4) - 1;\n\tif (bitrateIndex > 13) {\n\t\treturn 0;  // Invalid bit rate or 'free format'\n\t}\n\n\tvar sampleRateIndex = this.bits.read(2);\n\tvar sampleRate = MP2.SAMPLE_RATE[sampleRateIndex];\n\tif (sampleRateIndex === 3) {\n\t\treturn 0; // Invalid sample rate\n\t}\n\tif (version === MP2.VERSION.MPEG_2) {\n\t\tsampleRateIndex += 4;\n\t\tbitrateIndex += 14;\n\t}\n\tvar padding = this.bits.read(1),\n\t\tprivat = this.bits.read(1),\n\t\tmode = this.bits.read(2);\n\n\t// Parse the mode_extension, set up the stereo bound\n\tvar bound = 0;\n\tif (mode === MP2.MODE.JOINT_STEREO) {\n\t\tbound = (this.bits.read(2) + 1) << 2;\n\t}\n\telse {\n\t\tthis.bits.skip(2);\n\t\tbound = (mode === MP2.MODE.MONO) ? 0 : 32;\n\t}\n\n\t// Discard the last 4 bits of the header and the CRC value, if present\n\tthis.bits.skip(4);\n\tif (hasCRC) {\n\t\tthis.bits.skip(16);\n\t}\n\n\t// Compute the frame size\n\tvar bitrate = MP2.BIT_RATE[bitrateIndex],\n\t\tsampleRate = MP2.SAMPLE_RATE[sampleRateIndex],\n\t\tframeSize = ((144000 * bitrate / sampleRate) + padding)|0;\n\n\n\t// Prepare the quantizer table lookups\n\tvar tab3 = 0;\n\tvar sblimit = 0;\n\tif (version === MP2.VERSION.MPEG_2) {\n\t\t// MPEG-2 (LSR)\n\t\ttab3 = 2;\n\t\tsblimit = 30;\n\t}\n\telse {\n\t\t// MPEG-1\n\t\tvar tab1 = (mode === MP2.MODE.MONO) ? 0 : 1;\n\t\tvar tab2 = MP2.QUANT_LUT_STEP_1[tab1][bitrateIndex];\n\t\ttab3 = MP2.QUANT_LUT_STEP_2[tab2][sampleRateIndex];\n\t\tsblimit = tab3 & 63;\n\t\ttab3 >>= 6;\n\t}\n\n\tif (bound > sblimit) {\n\t\tbound = sblimit;\n\t}\n\n\t// Read the allocation information\n\tfor (var sb = 0; sb < bound; sb++) {\n\t\tthis.allocation[0][sb] = this.readAllocation(sb, tab3);\n\t\tthis.allocation[1][sb] = this.readAllocation(sb, tab3);\n\t}\n\n\tfor (var sb = bound; sb < sblimit; sb++) {\n\t\tthis.allocation[0][sb] =\n\t\t\tthis.allocation[1][sb] =\n\t\t\tthis.readAllocation(sb, tab3);\n\t}\n\n\t// Read scale factor selector information\n\tvar channels = (mode === MP2.MODE.MONO) ? 1 : 2;\n\tfor (var sb = 0;  sb < sblimit; sb++) {\n\t\tfor (ch = 0;  ch < channels; ch++) {\n\t\t\tif (this.allocation[ch][sb]) {\n\t\t\t\tthis.scaleFactorInfo[ch][sb] = this.bits.read(2);\n\t\t\t}\n\t\t}\n\t\tif (mode === MP2.MODE.MONO) {\n\t\t\tthis.scaleFactorInfo[1][sb] = this.scaleFactorInfo[0][sb];\n\t\t}\n\t}\n\n\t// Read scale factors\n\tfor (var sb = 0;  sb < sblimit; sb++) {\n\t\tfor (var ch = 0;  ch < channels; ch++) {\n\t\t\tif (this.allocation[ch][sb]) {\n\t\t\t\tvar sf = this.scaleFactor[ch][sb];\n\t\t\t\tswitch (this.scaleFactorInfo[ch][sb]) {\n\t\t\t\t\tcase 0:\n\t\t\t\t\t\tsf[0] = this.bits.read(6);\n\t\t\t\t\t\tsf[1] = this.bits.read(6);\n\t\t\t\t\t\tsf[2] = this.bits.read(6);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\tsf[0] =\n\t\t\t\t\t\tsf[1] = this.bits.read(6);\n\t\t\t\t\t\tsf[2] = this.bits.read(6);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\tsf[0] =\n\t\t\t\t\t\tsf[1] =\n\t\t\t\t\t\tsf[2] = this.bits.read(6);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 3:\n\t\t\t\t\t\tsf[0] = this.bits.read(6);\n\t\t\t\t\t\tsf[1] =\n\t\t\t\t\t\tsf[2] = this.bits.read(6);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (mode === MP2.MODE.MONO) {\n\t\t\tthis.scaleFactor[1][sb][0] = this.scaleFactor[0][sb][0];\n\t\t\tthis.scaleFactor[1][sb][1] = this.scaleFactor[0][sb][1];\n\t\t\tthis.scaleFactor[1][sb][2] = this.scaleFactor[0][sb][2];\n\t\t}\n\t}\n\n\t// Coefficient input and reconstruction\n\tvar outPos = 0;\n\tfor (var part = 0; part < 3; part++) {\n\t\tfor (var granule = 0; granule < 4; granule++) {\n\n\t\t\t// Read the samples\n\t\t\tfor (var sb = 0; sb < bound; sb++) {\n\t\t\t\tthis.readSamples(0, sb, part);\n\t\t\t\tthis.readSamples(1, sb, part);\n\t\t\t}\n\t\t\tfor (var sb = bound; sb < sblimit; sb++) {\n\t\t\t\tthis.readSamples(0, sb, part);\n\t\t\t\tthis.sample[1][sb][0] = this.sample[0][sb][0];\n\t\t\t\tthis.sample[1][sb][1] = this.sample[0][sb][1];\n\t\t\t\tthis.sample[1][sb][2] = this.sample[0][sb][2];\n\t\t\t}\n\t\t\tfor (var sb = sblimit; sb < 32; sb++) {\n\t\t\t\tthis.sample[0][sb][0] = 0;\n\t\t\t\tthis.sample[0][sb][1] = 0;\n\t\t\t\tthis.sample[0][sb][2] = 0;\n\t\t\t\tthis.sample[1][sb][0] = 0;\n\t\t\t\tthis.sample[1][sb][1] = 0;\n\t\t\t\tthis.sample[1][sb][2] = 0;\n\t\t\t}\n\n\t\t\t// Synthesis loop\n\t\t\tfor (var p = 0; p < 3; p++) {\n\t\t\t\t// Shifting step\n\t\t\t\tthis.VPos = (this.VPos - 64) & 1023;\n\n\t\t\t\tfor (var ch = 0;  ch < 2; ch++) {\n\t\t\t\t\tMP2.MatrixTransform(this.sample[ch], p, this.V, this.VPos);\n\n\t\t\t\t\t// Build U, windowing, calculate output\n\t\t\t\t\tJSMpeg.Fill(this.U, 0);\n\n\t\t\t\t\tvar dIndex = 512 - (this.VPos >> 1);\n\t\t\t\t\tvar vIndex = (this.VPos % 128) >> 1;\n\t\t\t\t\twhile (vIndex < 1024) {\n\t\t\t\t\t\tfor (var i = 0; i < 32; ++i) {\n\t\t\t\t\t\t\tthis.U[i] += this.D[dIndex++] * this.V[vIndex++];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvIndex += 128-32;\n\t\t\t\t\t\tdIndex += 64-32;\n\t\t\t\t\t}\n\n\t\t\t\t\tvIndex = (128-32 + 1024) - vIndex;\n\t\t\t\t\tdIndex -= (512 - 32);\n\t\t\t\t\twhile (vIndex < 1024) {\n\t\t\t\t\t\tfor (var i = 0; i < 32; ++i) {\n\t\t\t\t\t\t\tthis.U[i] += this.D[dIndex++] * this.V[vIndex++];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvIndex += 128-32;\n\t\t\t\t\t\tdIndex += 64-32;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Output samples\n\t\t\t\t\tvar outChannel = ch === 0 ? left : right;\n\t\t\t\t\tfor (var j = 0; j < 32; j++) {\n\t\t\t\t\t\toutChannel[outPos + j] = this.U[j] / 2147418112;\n\t\t\t\t\t}\n\t\t\t\t} // End of synthesis channel loop\n\t\t\t\toutPos += 32;\n\t\t\t} // End of synthesis sub-block loop\n\n\t\t} // Decoding of the granule finished\n\t}\n\n\tthis.sampleRate = sampleRate;\n\treturn frameSize;\n};\n\nMP2.prototype.readAllocation = function(sb, tab3) {\n\tvar tab4 = MP2.QUANT_LUT_STEP_3[tab3][sb];\n\tvar qtab = MP2.QUANT_LUT_STEP4[tab4 & 15][this.bits.read(tab4 >> 4)];\n\treturn qtab ? (MP2.QUANT_TAB[qtab - 1]) : 0;\n};\n\nMP2.prototype.readSamples = function(ch, sb, part) {\n\tvar q = this.allocation[ch][sb],\n\t\tsf = this.scaleFactor[ch][sb][part],\n\t\tsample = this.sample[ch][sb],\n\t\tval = 0;\n\n\tif (!q) {\n\t\t// No bits allocated for this subband\n\t\tsample[0] = sample[1] = sample[2] = 0;\n\t\treturn;\n\t}\n\n\t// Resolve scalefactor\n\tif (sf === 63) {\n\t\tsf = 0;\n\t}\n\telse {\n\t\tvar shift = (sf / 3)|0;\n\t\tsf = (MP2.SCALEFACTOR_BASE[sf % 3] + ((1 << shift) >> 1)) >> shift;\n\t}\n\n\t// Decode samples\n\tvar adj = q.levels;\n\tif (q.group) {\n\t\t// Decode grouped samples\n\t\tval = this.bits.read(q.bits);\n\t\tsample[0] = val % adj;\n\t\tval = (val / adj)|0;\n\t\tsample[1] = val % adj;\n\t\tsample[2] = (val / adj)|0;\n\t}\n\telse {\n\t\t// Decode direct samples\n\t\tsample[0] = this.bits.read(q.bits);\n\t\tsample[1] = this.bits.read(q.bits);\n\t\tsample[2] = this.bits.read(q.bits);\n\t}\n\n\t// Postmultiply samples\n\tvar scale = (65536 / (adj + 1))|0;\n\tadj = ((adj + 1) >> 1) - 1;\n\n\tval = (adj - sample[0]) * scale;\n\tsample[0] = (val * (sf >> 12) + ((val * (sf & 4095) + 2048) >> 12)) >> 12;\n\n\tval = (adj - sample[1]) * scale;\n\tsample[1] = (val * (sf >> 12) + ((val * (sf & 4095) + 2048) >> 12)) >> 12;\n\n\tval = (adj - sample[2]) * scale;\n\tsample[2] = (val * (sf >> 12) + ((val * (sf & 4095) + 2048) >> 12)) >> 12;\n};\n\nMP2.MatrixTransform = function(s, ss, d, dp) {\n\tvar t01, t02, t03, t04, t05, t06, t07, t08, t09, t10, t11, t12,\n\t\tt13, t14, t15, t16, t17, t18, t19, t20, t21, t22, t23, t24,\n\t\tt25, t26, t27, t28, t29, t30, t31, t32, t33;\n\n\tt01 = s[ 0][ss] + s[31][ss]; t02 = (s[ 0][ss] - s[31][ss]) * 0.500602998235;\n\tt03 = s[ 1][ss] + s[30][ss]; t04 = (s[ 1][ss] - s[30][ss]) * 0.505470959898;\n\tt05 = s[ 2][ss] + s[29][ss]; t06 = (s[ 2][ss] - s[29][ss]) * 0.515447309923;\n\tt07 = s[ 3][ss] + s[28][ss]; t08 = (s[ 3][ss] - s[28][ss]) * 0.53104259109;\n\tt09 = s[ 4][ss] + s[27][ss]; t10 = (s[ 4][ss] - s[27][ss]) * 0.553103896034;\n\tt11 = s[ 5][ss] + s[26][ss]; t12 = (s[ 5][ss] - s[26][ss]) * 0.582934968206;\n\tt13 = s[ 6][ss] + s[25][ss]; t14 = (s[ 6][ss] - s[25][ss]) * 0.622504123036;\n\tt15 = s[ 7][ss] + s[24][ss]; t16 = (s[ 7][ss] - s[24][ss]) * 0.674808341455;\n\tt17 = s[ 8][ss] + s[23][ss]; t18 = (s[ 8][ss] - s[23][ss]) * 0.744536271002;\n\tt19 = s[ 9][ss] + s[22][ss]; t20 = (s[ 9][ss] - s[22][ss]) * 0.839349645416;\n\tt21 = s[10][ss] + s[21][ss]; t22 = (s[10][ss] - s[21][ss]) * 0.972568237862;\n\tt23 = s[11][ss] + s[20][ss]; t24 = (s[11][ss] - s[20][ss]) * 1.16943993343;\n\tt25 = s[12][ss] + s[19][ss]; t26 = (s[12][ss] - s[19][ss]) * 1.48416461631;\n\tt27 = s[13][ss] + s[18][ss]; t28 = (s[13][ss] - s[18][ss]) * 2.05778100995;\n\tt29 = s[14][ss] + s[17][ss]; t30 = (s[14][ss] - s[17][ss]) * 3.40760841847;\n\tt31 = s[15][ss] + s[16][ss]; t32 = (s[15][ss] - s[16][ss]) * 10.1900081235;\n\n\tt33 = t01 + t31; t31 = (t01 - t31) * 0.502419286188;\n\tt01 = t03 + t29; t29 = (t03 - t29) * 0.52249861494;\n\tt03 = t05 + t27; t27 = (t05 - t27) * 0.566944034816;\n\tt05 = t07 + t25; t25 = (t07 - t25) * 0.64682178336;\n\tt07 = t09 + t23; t23 = (t09 - t23) * 0.788154623451;\n\tt09 = t11 + t21; t21 = (t11 - t21) * 1.06067768599;\n\tt11 = t13 + t19; t19 = (t13 - t19) * 1.72244709824;\n\tt13 = t15 + t17; t17 = (t15 - t17) * 5.10114861869;\n\tt15 = t33 + t13; t13 = (t33 - t13) * 0.509795579104;\n\tt33 = t01 + t11; t01 = (t01 - t11) * 0.601344886935;\n\tt11 = t03 + t09; t09 = (t03 - t09) * 0.899976223136;\n\tt03 = t05 + t07; t07 = (t05 - t07) * 2.56291544774;\n\tt05 = t15 + t03; t15 = (t15 - t03) * 0.541196100146;\n\tt03 = t33 + t11; t11 = (t33 - t11) * 1.30656296488;\n\tt33 = t05 + t03; t05 = (t05 - t03) * 0.707106781187;\n\tt03 = t15 + t11; t15 = (t15 - t11) * 0.707106781187;\n\tt03 += t15;\n\tt11 = t13 + t07; t13 = (t13 - t07) * 0.541196100146;\n\tt07 = t01 + t09; t09 = (t01 - t09) * 1.30656296488;\n\tt01 = t11 + t07; t07 = (t11 - t07) * 0.707106781187;\n\tt11 = t13 + t09; t13 = (t13 - t09) * 0.707106781187;\n\tt11 += t13; t01 += t11;\n\tt11 += t07; t07 += t13;\n\tt09 = t31 + t17; t31 = (t31 - t17) * 0.509795579104;\n\tt17 = t29 + t19; t29 = (t29 - t19) * 0.601344886935;\n\tt19 = t27 + t21; t21 = (t27 - t21) * 0.899976223136;\n\tt27 = t25 + t23; t23 = (t25 - t23) * 2.56291544774;\n\tt25 = t09 + t27; t09 = (t09 - t27) * 0.541196100146;\n\tt27 = t17 + t19; t19 = (t17 - t19) * 1.30656296488;\n\tt17 = t25 + t27; t27 = (t25 - t27) * 0.707106781187;\n\tt25 = t09 + t19; t19 = (t09 - t19) * 0.707106781187;\n\tt25 += t19;\n\tt09 = t31 + t23; t31 = (t31 - t23) * 0.541196100146;\n\tt23 = t29 + t21; t21 = (t29 - t21) * 1.30656296488;\n\tt29 = t09 + t23; t23 = (t09 - t23) * 0.707106781187;\n\tt09 = t31 + t21; t31 = (t31 - t21) * 0.707106781187;\n\tt09 += t31;\tt29 += t09;\tt09 += t23;\tt23 += t31;\n\tt17 += t29;\tt29 += t25;\tt25 += t09;\tt09 += t27;\n\tt27 += t23;\tt23 += t19; t19 += t31;\n\tt21 = t02 + t32; t02 = (t02 - t32) * 0.502419286188;\n\tt32 = t04 + t30; t04 = (t04 - t30) * 0.52249861494;\n\tt30 = t06 + t28; t28 = (t06 - t28) * 0.566944034816;\n\tt06 = t08 + t26; t08 = (t08 - t26) * 0.64682178336;\n\tt26 = t10 + t24; t10 = (t10 - t24) * 0.788154623451;\n\tt24 = t12 + t22; t22 = (t12 - t22) * 1.06067768599;\n\tt12 = t14 + t20; t20 = (t14 - t20) * 1.72244709824;\n\tt14 = t16 + t18; t16 = (t16 - t18) * 5.10114861869;\n\tt18 = t21 + t14; t14 = (t21 - t14) * 0.509795579104;\n\tt21 = t32 + t12; t32 = (t32 - t12) * 0.601344886935;\n\tt12 = t30 + t24; t24 = (t30 - t24) * 0.899976223136;\n\tt30 = t06 + t26; t26 = (t06 - t26) * 2.56291544774;\n\tt06 = t18 + t30; t18 = (t18 - t30) * 0.541196100146;\n\tt30 = t21 + t12; t12 = (t21 - t12) * 1.30656296488;\n\tt21 = t06 + t30; t30 = (t06 - t30) * 0.707106781187;\n\tt06 = t18 + t12; t12 = (t18 - t12) * 0.707106781187;\n\tt06 += t12;\n\tt18 = t14 + t26; t26 = (t14 - t26) * 0.541196100146;\n\tt14 = t32 + t24; t24 = (t32 - t24) * 1.30656296488;\n\tt32 = t18 + t14; t14 = (t18 - t14) * 0.707106781187;\n\tt18 = t26 + t24; t24 = (t26 - t24) * 0.707106781187;\n\tt18 += t24; t32 += t18;\n\tt18 += t14; t26 = t14 + t24;\n\tt14 = t02 + t16; t02 = (t02 - t16) * 0.509795579104;\n\tt16 = t04 + t20; t04 = (t04 - t20) * 0.601344886935;\n\tt20 = t28 + t22; t22 = (t28 - t22) * 0.899976223136;\n\tt28 = t08 + t10; t10 = (t08 - t10) * 2.56291544774;\n\tt08 = t14 + t28; t14 = (t14 - t28) * 0.541196100146;\n\tt28 = t16 + t20; t20 = (t16 - t20) * 1.30656296488;\n\tt16 = t08 + t28; t28 = (t08 - t28) * 0.707106781187;\n\tt08 = t14 + t20; t20 = (t14 - t20) * 0.707106781187;\n\tt08 += t20;\n\tt14 = t02 + t10; t02 = (t02 - t10) * 0.541196100146;\n\tt10 = t04 + t22; t22 = (t04 - t22) * 1.30656296488;\n\tt04 = t14 + t10; t10 = (t14 - t10) * 0.707106781187;\n\tt14 = t02 + t22; t02 = (t02 - t22) * 0.707106781187;\n\tt14 += t02;\tt04 += t14;\tt14 += t10;\tt10 += t02;\n\tt16 += t04;\tt04 += t08;\tt08 += t14;\tt14 += t28;\n\tt28 += t10;\tt10 += t20;\tt20 += t02;\tt21 += t16;\n\tt16 += t32;\tt32 += t04;\tt04 += t06;\tt06 += t08;\n\tt08 += t18;\tt18 += t14;\tt14 += t30;\tt30 += t28;\n\tt28 += t26;\tt26 += t10;\tt10 += t12;\tt12 += t20;\n\tt20 += t24;\tt24 += t02;\n\n\td[dp + 48] = -t33;\n\td[dp + 49] = d[dp + 47] = -t21;\n\td[dp + 50] = d[dp + 46] = -t17;\n\td[dp + 51] = d[dp + 45] = -t16;\n\td[dp + 52] = d[dp + 44] = -t01;\n\td[dp + 53] = d[dp + 43] = -t32;\n\td[dp + 54] = d[dp + 42] = -t29;\n\td[dp + 55] = d[dp + 41] = -t04;\n\td[dp + 56] = d[dp + 40] = -t03;\n\td[dp + 57] = d[dp + 39] = -t06;\n\td[dp + 58] = d[dp + 38] = -t25;\n\td[dp + 59] = d[dp + 37] = -t08;\n\td[dp + 60] = d[dp + 36] = -t11;\n\td[dp + 61] = d[dp + 35] = -t18;\n\td[dp + 62] = d[dp + 34] = -t09;\n\td[dp + 63] = d[dp + 33] = -t14;\n\td[dp + 32] = -t05;\n\td[dp +  0] = t05; d[dp + 31] = -t30;\n\td[dp +  1] = t30; d[dp + 30] = -t27;\n\td[dp +  2] = t27; d[dp + 29] = -t28;\n\td[dp +  3] = t28; d[dp + 28] = -t07;\n\td[dp +  4] = t07; d[dp + 27] = -t26;\n\td[dp +  5] = t26; d[dp + 26] = -t23;\n\td[dp +  6] = t23; d[dp + 25] = -t10;\n\td[dp +  7] = t10; d[dp + 24] = -t15;\n\td[dp +  8] = t15; d[dp + 23] = -t12;\n\td[dp +  9] = t12; d[dp + 22] = -t19;\n\td[dp + 10] = t19; d[dp + 21] = -t20;\n\td[dp + 11] = t20; d[dp + 20] = -t13;\n\td[dp + 12] = t13; d[dp + 19] = -t24;\n\td[dp + 13] = t24; d[dp + 18] = -t31;\n\td[dp + 14] = t31; d[dp + 17] = -t02;\n\td[dp + 15] = t02; d[dp + 16] =  0.0;\n};\n\nMP2.FRAME_SYNC = 0x7ff;\n\nMP2.VERSION = {\n\tMPEG_2_5: 0x0,\n\tMPEG_2: 0x2,\n\tMPEG_1: 0x3\n};\n\nMP2.LAYER = {\n\tIII: 0x1,\n\tII: 0x2,\n\tI: 0x3\n};\n\nMP2.MODE = {\n\tSTEREO: 0x0,\n\tJOINT_STEREO: 0x1,\n\tDUAL_CHANNEL: 0x2,\n\tMONO: 0x3\n};\n\nMP2.SAMPLE_RATE = new Uint16Array([\n\t44100, 48000, 32000, 0, // MPEG-1\n\t22050, 24000, 16000, 0  // MPEG-2\n]);\n\nMP2.BIT_RATE = new Uint16Array([\n\t32, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320, 384, // MPEG-1\n\t 8, 16, 24, 32, 40, 48,  56,  64,  80,  96, 112, 128, 144, 160  // MPEG-2\n]);\n\nMP2.SCALEFACTOR_BASE = new Uint32Array([\n\t0x02000000, 0x01965FEA, 0x01428A30\n]);\n\nMP2.SYNTHESIS_WINDOW = new Float32Array([\n\t     0.0,     -0.5,     -0.5,     -0.5,     -0.5,     -0.5,\n\t    -0.5,     -1.0,     -1.0,     -1.0,     -1.0,     -1.5,\n\t    -1.5,     -2.0,     -2.0,     -2.5,     -2.5,     -3.0,\n\t    -3.5,     -3.5,     -4.0,     -4.5,     -5.0,     -5.5,\n\t    -6.5,     -7.0,     -8.0,     -8.5,     -9.5,    -10.5,\n\t   -12.0,    -13.0,    -14.5,    -15.5,    -17.5,    -19.0,\n\t   -20.5,    -22.5,    -24.5,    -26.5,    -29.0,    -31.5,\n\t   -34.0,    -36.5,    -39.5,    -42.5,    -45.5,    -48.5,\n\t   -52.0,    -55.5,    -58.5,    -62.5,    -66.0,    -69.5,\n\t   -73.5,    -77.0,    -80.5,    -84.5,    -88.0,    -91.5,\n\t   -95.0,    -98.0,   -101.0,   -104.0,    106.5,    109.0,\n\t   111.0,    112.5,    113.5,    114.0,    114.0,    113.5,\n\t   112.0,    110.5,    107.5,    104.0,    100.0,     94.5,\n\t    88.5,     81.5,     73.0,     63.5,     53.0,     41.5,\n\t    28.5,     14.5,     -1.0,    -18.0,    -36.0,    -55.5,\n\t   -76.5,    -98.5,   -122.0,   -147.0,   -173.5,   -200.5,\n\t  -229.5,   -259.5,   -290.5,   -322.5,   -355.5,   -389.5,\n\t  -424.0,   -459.5,   -495.5,   -532.0,   -568.5,   -605.0,\n\t  -641.5,   -678.0,   -714.0,   -749.0,   -783.5,   -817.0,\n\t  -849.0,   -879.5,   -908.5,   -935.0,   -959.5,   -981.0,\n\t -1000.5,  -1016.0,  -1028.5,  -1037.5,  -1042.5,  -1043.5,\n\t -1040.0,  -1031.5,   1018.5,   1000.0,    976.0,    946.5,\n\t   911.0,    869.5,    822.0,    767.5,    707.0,    640.0,\n\t   565.5,    485.0,    397.0,    302.5,    201.0,     92.5,\n\t   -22.5,   -144.0,   -272.5,   -407.0,   -547.5,   -694.0,\n\t  -846.0,  -1003.0,  -1165.0,  -1331.5,  -1502.0,  -1675.5,\n\t -1852.5,  -2031.5,  -2212.5,  -2394.0,  -2576.5,  -2758.5,\n\t -2939.5,  -3118.5,  -3294.5,  -3467.5,  -3635.5,  -3798.5,\n\t -3955.0,  -4104.5,  -4245.5,  -4377.5,  -4499.0,  -4609.5,\n\t -4708.0,  -4792.5,  -4863.5,  -4919.0,  -4958.0,  -4979.5,\n\t -4983.0,  -4967.5,  -4931.5,  -4875.0,  -4796.0,  -4694.5,\n\t -4569.5,  -4420.0,  -4246.0,  -4046.0,  -3820.0,  -3567.0,\n\t  3287.0,   2979.5,   2644.0,   2280.5,   1888.0,   1467.5,\n\t  1018.5,    541.0,     35.0,   -499.0,  -1061.0,  -1650.0,\n\t -2266.5,  -2909.0,  -3577.0,  -4270.0,  -4987.5,  -5727.5,\n\t -6490.0,  -7274.0,  -8077.5,  -8899.5,  -9739.0, -10594.5,\n\t-11464.5, -12347.0, -13241.0, -14144.5, -15056.0, -15973.5,\n\t-16895.5, -17820.0, -18744.5, -19668.0, -20588.0, -21503.0,\n\t-22410.5, -23308.5, -24195.0, -25068.5, -25926.5, -26767.0,\n\t-27589.0, -28389.0, -29166.5, -29919.0, -30644.5, -31342.0,\n\t-32009.5, -32645.0, -33247.0, -33814.5, -34346.0, -34839.5,\n\t-35295.0, -35710.0, -36084.5, -36417.5, -36707.5, -36954.0,\n\t-37156.5, -37315.0, -37428.0, -37496.0,  37519.0,  37496.0,\n\t 37428.0,  37315.0,  37156.5,  36954.0,  36707.5,  36417.5,\n\t 36084.5,  35710.0,  35295.0,  34839.5,  34346.0,  33814.5,\n\t 33247.0,  32645.0,  32009.5,  31342.0,  30644.5,  29919.0,\n\t 29166.5,  28389.0,  27589.0,  26767.0,  25926.5,  25068.5,\n\t 24195.0,  23308.5,  22410.5,  21503.0,  20588.0,  19668.0,\n\t 18744.5,  17820.0,  16895.5,  15973.5,  15056.0,  14144.5,\n\t 13241.0,  12347.0,  11464.5,  10594.5,   9739.0,   8899.5,\n\t  8077.5,   7274.0,   6490.0,   5727.5,   4987.5,   4270.0,\n\t  3577.0,   2909.0,   2266.5,   1650.0,   1061.0,    499.0,\n\t   -35.0,   -541.0,  -1018.5,  -1467.5,  -1888.0,  -2280.5,\n\t -2644.0,  -2979.5,   3287.0,   3567.0,   3820.0,   4046.0,\n\t  4246.0,   4420.0,   4569.5,   4694.5,   4796.0,   4875.0,\n\t  4931.5,   4967.5,   4983.0,   4979.5,   4958.0,   4919.0,\n\t  4863.5,   4792.5,   4708.0,   4609.5,   4499.0,   4377.5,\n\t  4245.5,   4104.5,   3955.0,   3798.5,   3635.5,   3467.5,\n\t  3294.5,   3118.5,   2939.5,   2758.5,   2576.5,   2394.0,\n\t  2212.5,   2031.5,   1852.5,   1675.5,   1502.0,   1331.5,\n\t  1165.0,   1003.0,    846.0,    694.0,    547.5,    407.0,\n\t   272.5,    144.0,     22.5,    -92.5,   -201.0,   -302.5,\n\t  -397.0,   -485.0,   -565.5,   -640.0,   -707.0,   -767.5,\n\t  -822.0,   -869.5,   -911.0,   -946.5,   -976.0,  -1000.0,\n\t  1018.5,   1031.5,   1040.0,   1043.5,   1042.5,   1037.5,\n\t  1028.5,   1016.0,   1000.5,    981.0,    959.5,    935.0,\n\t   908.5,    879.5,    849.0,    817.0,    783.5,    749.0,\n\t   714.0,    678.0,    641.5,    605.0,    568.5,    532.0,\n\t   495.5,    459.5,    424.0,    389.5,    355.5,    322.5,\n\t   290.5,    259.5,    229.5,    200.5,    173.5,    147.0,\n\t   122.0,     98.5,     76.5,     55.5,     36.0,     18.0,\n\t\t1.0,    -14.5,    -28.5,    -41.5,    -53.0,    -63.5,\n\t   -73.0,    -81.5,    -88.5,    -94.5,   -100.0,   -104.0,\n\t  -107.5,   -110.5,   -112.0,   -113.5,   -114.0,   -114.0,\n\t  -113.5,   -112.5,   -111.0,   -109.0,    106.5,    104.0,\n\t   101.0,     98.0,     95.0,     91.5,     88.0,     84.5,\n\t    80.5,     77.0,     73.5,     69.5,     66.0,     62.5,\n\t    58.5,     55.5,     52.0,     48.5,     45.5,     42.5,\n\t    39.5,     36.5,     34.0,     31.5,     29.0,     26.5,\n\t    24.5,     22.5,     20.5,     19.0,     17.5,     15.5,\n\t    14.5,     13.0,     12.0,     10.5,      9.5,      8.5,\n\t     8.0,      7.0,      6.5,      5.5,      5.0,      4.5,\n\t     4.0,      3.5,      3.5,      3.0,      2.5,      2.5,\n\t     2.0,      2.0,      1.5,      1.5,      1.0,      1.0,\n\t     1.0,      1.0,      0.5,      0.5,      0.5,      0.5,\n\t     0.5,      0.5\n]);\n\n// Quantizer lookup, step 1: bitrate classes\nMP2.QUANT_LUT_STEP_1 = [\n \t// 32, 48, 56, 64, 80, 96,112,128,160,192,224,256,320,384 <- bitrate\n\t[   0,  0,  1,  1,  1,  2,  2,  2,  2,  2,  2,  2,  2,  2], // mono\n\t// 16, 24, 28, 32, 40, 48, 56, 64, 80, 96,112,128,160,192 <- bitrate / chan\n\t[   0,  0,  0,  0,  0,  0,  1,  1,  1,  2,  2,  2,  2,  2] // stereo\n];\n\n// Quantizer lookup, step 2: bitrate class, sample rate -> B2 table idx, sblimit\nMP2.QUANT_TAB = {\n\tA: (27 | 64), // Table 3-B.2a: high-rate, sblimit = 27\n\tB: (30 | 64), // Table 3-B.2b: high-rate, sblimit = 30\n\tC:   8,       // Table 3-B.2c:  low-rate, sblimit =  8\n\tD:  12        // Table 3-B.2d:  low-rate, sblimit = 12\n};\n\nMP2.QUANT_LUT_STEP_2 = [\n\t//   44.1 kHz,        48 kHz,          32 kHz\n\t[MP2.QUANT_TAB.C, MP2.QUANT_TAB.C, MP2.QUANT_TAB.D], // 32 - 48 kbit/sec/ch\n\t[MP2.QUANT_TAB.A, MP2.QUANT_TAB.A, MP2.QUANT_TAB.A], // 56 - 80 kbit/sec/ch\n\t[MP2.QUANT_TAB.B, MP2.QUANT_TAB.A, MP2.QUANT_TAB.B]  // 96+\t kbit/sec/ch\n];\n\n// Quantizer lookup, step 3: B2 table, subband -> nbal, row index\n// (upper 4 bits: nbal, lower 4 bits: row index)\nMP2.QUANT_LUT_STEP_3 = [\n\t// Low-rate table (3-B.2c and 3-B.2d)\n\t[\n\t\t0x44,0x44,\n\t  \t0x34,0x34,0x34,0x34,0x34,0x34,0x34,0x34,0x34,0x34\n\t],\n\t// High-rate table (3-B.2a and 3-B.2b)\n\t[\n\t\t0x43,0x43,0x43,\n\t\t0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,\n\t\t0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,\n\t\t0x20,0x20,0x20,0x20,0x20,0x20,0x20\n\t],\n\t// MPEG-2 LSR table (B.2 in ISO 13818-3)\n\t[\n\t\t0x45,0x45,0x45,0x45,\n\t\t0x34,0x34,0x34,0x34,0x34,0x34,0x34,\n\t\t0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,\n\t\t\t\t\t   0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24\n\t]\n];\n\n// Quantizer lookup, step 4: table row, allocation[] value -> quant table index\nMP2.QUANT_LUT_STEP4 = [\n\t[0, 1, 2, 17],\n\t[0, 1, 2, 3, 4, 5, 6, 17],\n\t[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 17],\n\t[0, 1, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17],\n\t[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17],\n\t[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]\n];\n\nMP2.QUANT_TAB = [\n\t{levels:     3, group: 1, bits:  5},  //  1\n\t{levels:     5, group: 1, bits:  7},  //  2\n\t{levels:     7, group: 0, bits:  3},  //  3\n\t{levels:     9, group: 1, bits: 10},  //  4\n\t{levels:    15, group: 0, bits:  4},  //  5\n\t{levels:    31, group: 0, bits:  5},  //  6\n\t{levels:    63, group: 0, bits:  6},  //  7\n\t{levels:   127, group: 0, bits:  7},  //  8\n\t{levels:   255, group: 0, bits:  8},  //  9\n\t{levels:   511, group: 0, bits:  9},  // 10\n\t{levels:  1023, group: 0, bits: 10},  // 11\n\t{levels:  2047, group: 0, bits: 11},  // 12\n\t{levels:  4095, group: 0, bits: 12},  // 13\n\t{levels:  8191, group: 0, bits: 13},  // 14\n\t{levels: 16383, group: 0, bits: 14},  // 15\n\t{levels: 32767, group: 0, bits: 15},  // 16\n\t{levels: 65535, group: 0, bits: 16}   // 17\n];\n\nmodule.exports = MP2;\n","// Inspired by Java MPEG-1 Video Decoder and Player by Zoltan Korandi\n// https://sourceforge.net/projects/javampeg1video/\nconst JSMpeg = require(\"./jsmpeg\");\n\nvar MPEG1 = function(options) {\n\tJSMpeg.Decoder.Base.call(this, options);\n\n\tvar bufferSize = options.videoBufferSize || 512*1024;\n\tvar bufferMode = options.streaming\n\t\t? JSMpeg.BitBuffer.MODE.EVICT\n\t\t: JSMpeg.BitBuffer.MODE.EXPAND;\n\n\tthis.bits = new JSMpeg.BitBuffer(bufferSize, bufferMode);\n\n\tthis.customIntraQuantMatrix = new Uint8Array(64);\n\tthis.customNonIntraQuantMatrix = new Uint8Array(64);\n\tthis.blockData = new Int32Array(64);\n\n\tthis.currentFrame = 0;\n\tthis.decodeFirstFrame = options.decodeFirstFrame !== false;\n};\n\nMPEG1.prototype = Object.create(JSMpeg.Decoder.Base.prototype);\nMPEG1.prototype.constructor = MPEG1;\n\nMPEG1.prototype.write = function(pts, buffers) {\n\tJSMpeg.Decoder.Base.prototype.write.call(this, pts, buffers);\n\n\tif (!this.hasSequenceHeader) {\n\t\tif (this.bits.findStartCode(MPEG1.START.SEQUENCE) === -1) {\n\t\t\treturn false;\n\t\t}\n\t\tthis.decodeSequenceHeader();\n\n\t\tif (this.decodeFirstFrame) {\n\t\t\tthis.decode();\n\t\t}\n\t}\n};\n\nMPEG1.prototype.decode = function() {\n\tif (!this.hasSequenceHeader) {\n\t\treturn false;\n\t}\n\n\tif (this.bits.findStartCode(MPEG1.START.PICTURE) === -1) {\n\t\tvar bufferedBytes = this.bits.byteLength - (this.bits.index >> 3);\n\t\treturn false;\n\t}\n\n\tthis.decodePicture();\n\tthis.advanceDecodedTime(1/this.frameRate);\n\treturn true;\n};\n\nMPEG1.prototype.readHuffman = function(codeTable) {\n\tvar state = 0;\n\tdo {\n\t\tstate = codeTable[state + this.bits.read(1)];\n\t} while (state >= 0 && codeTable[state] !== 0);\n\treturn codeTable[state+2];\n};\n\n\n// Sequence Layer\n\nMPEG1.prototype.frameRate = 30;\nMPEG1.prototype.decodeSequenceHeader = function() {\n\tvar newWidth = this.bits.read(12),\n\t\tnewHeight = this.bits.read(12);\n\n\t// skip pixel aspect ratio\n\tthis.bits.skip(4);\n\n\tthis.frameRate = MPEG1.PICTURE_RATE[this.bits.read(4)];\n\n\t// skip bitRate, marker, bufferSize and constrained bit\n\tthis.bits.skip(18 + 1 + 10 + 1);\n\n\tif (newWidth !== this.width || newHeight !== this.height) {\n\t\tthis.width = newWidth;\n\t\tthis.height = newHeight;\n\n\t\tthis.initBuffers();\n\n\t\tif (this.destination) {\n\t\t\tthis.destination.resize(newWidth, newHeight);\n\t\t}\n\t}\n\n\tif (this.bits.read(1)) { // load custom intra quant matrix?\n\t\tfor (var i = 0; i < 64; i++) {\n\t\t\tthis.customIntraQuantMatrix[MPEG1.ZIG_ZAG[i]] = this.bits.read(8);\n\t\t}\n\t\tthis.intraQuantMatrix = this.customIntraQuantMatrix;\n\t}\n\n\tif (this.bits.read(1)) { // load custom non intra quant matrix?\n\t\tfor (var i = 0; i < 64; i++) {\n\t\t\tvar idx = MPEG1.ZIG_ZAG[i];\n\t\t\tthis.customNonIntraQuantMatrix[idx] = this.bits.read(8);\n\t\t}\n\t\tthis.nonIntraQuantMatrix = this.customNonIntraQuantMatrix;\n\t}\n\n\tthis.hasSequenceHeader = true;\n};\n\nMPEG1.prototype.initBuffers = function() {\n\tthis.intraQuantMatrix = MPEG1.DEFAULT_INTRA_QUANT_MATRIX;\n\tthis.nonIntraQuantMatrix = MPEG1.DEFAULT_NON_INTRA_QUANT_MATRIX;\n\n\tthis.mbWidth = (this.width + 15) >> 4;\n\tthis.mbHeight = (this.height + 15) >> 4;\n\tthis.mbSize = this.mbWidth * this.mbHeight;\n\n\tthis.codedWidth = this.mbWidth << 4;\n\tthis.codedHeight = this.mbHeight << 4;\n\tthis.codedSize = this.codedWidth * this.codedHeight;\n\n\tthis.halfWidth = this.mbWidth << 3;\n\tthis.halfHeight = this.mbHeight << 3;\n\n\t// Allocated buffers and resize the canvas\n\tthis.currentY = new Uint8ClampedArray(this.codedSize);\n\tthis.currentY32 = new Uint32Array(this.currentY.buffer);\n\n\tthis.currentCr = new Uint8ClampedArray(this.codedSize >> 2);\n\tthis.currentCr32 = new Uint32Array(this.currentCr.buffer);\n\n\tthis.currentCb = new Uint8ClampedArray(this.codedSize >> 2);\n\tthis.currentCb32 = new Uint32Array(this.currentCb.buffer);\n\n\n\tthis.forwardY = new Uint8ClampedArray(this.codedSize);\n\tthis.forwardY32 = new Uint32Array(this.forwardY.buffer);\n\n\tthis.forwardCr = new Uint8ClampedArray(this.codedSize >> 2);\n\tthis.forwardCr32 = new Uint32Array(this.forwardCr.buffer);\n\n\tthis.forwardCb = new Uint8ClampedArray(this.codedSize >> 2);\n\tthis.forwardCb32 = new Uint32Array(this.forwardCb.buffer);\n};\n\n\n// Picture Layer\n\nMPEG1.prototype.currentY = null;\nMPEG1.prototype.currentCr = null;\nMPEG1.prototype.currentCb = null;\n\nMPEG1.prototype.pictureType = 0;\n\n// Buffers for motion compensation\nMPEG1.prototype.forwardY = null;\nMPEG1.prototype.forwardCr = null;\nMPEG1.prototype.forwardCb = null;\n\nMPEG1.prototype.fullPelForward = false;\nMPEG1.prototype.forwardFCode = 0;\nMPEG1.prototype.forwardRSize = 0;\nMPEG1.prototype.forwardF = 0;\n\nMPEG1.prototype.decodePicture = function(skipOutput) {\n\tthis.currentFrame++;\n\n\tthis.bits.skip(10); // skip temporalReference\n\tthis.pictureType = this.bits.read(3);\n\tthis.bits.skip(16); // skip vbv_delay\n\n\t// Skip B and D frames or unknown coding type\n\tif (this.pictureType <= 0 || this.pictureType >= MPEG1.PICTURE_TYPE.B) {\n\t\treturn;\n\t}\n\n\t// full_pel_forward, forward_f_code\n\tif (this.pictureType === MPEG1.PICTURE_TYPE.PREDICTIVE) {\n\t\tthis.fullPelForward = this.bits.read(1);\n\t\tthis.forwardFCode = this.bits.read(3);\n\t\tif (this.forwardFCode === 0) {\n\t\t\t// Ignore picture with zero forward_f_code\n\t\t\treturn;\n\t\t}\n\t\tthis.forwardRSize = this.forwardFCode - 1;\n\t\tthis.forwardF = 1 << this.forwardRSize;\n\t}\n\n\tvar code = 0;\n\tdo {\n\t\tcode = this.bits.findNextStartCode();\n\t} while (code === MPEG1.START.EXTENSION || code === MPEG1.START.USER_DATA );\n\n\n\twhile (code >= MPEG1.START.SLICE_FIRST && code <= MPEG1.START.SLICE_LAST) {\n\t\tthis.decodeSlice(code & 0x000000FF);\n\t\tcode = this.bits.findNextStartCode();\n\t}\n\n\tif (code !== -1) {\n\t\t// We found the next start code; rewind 32bits and let the main loop\n\t\t// handle it.\n\t\tthis.bits.rewind(32);\n\t}\n\n\t// Invoke decode callbacks\n\tif (this.destination) {\n\t\tthis.destination.render(this.currentY, this.currentCr, this.currentCb);\n\t}\n\n\t// If this is a reference picutre then rotate the prediction pointers\n\tif (\n\t\tthis.pictureType === MPEG1.PICTURE_TYPE.INTRA ||\n\t\tthis.pictureType === MPEG1.PICTURE_TYPE.PREDICTIVE\n\t) {\n\t\tvar\n\t\t\ttmpY = this.forwardY,\n\t\t\ttmpY32 = this.forwardY32,\n\t\t\ttmpCr = this.forwardCr,\n\t\t\ttmpCr32 = this.forwardCr32,\n\t\t\ttmpCb = this.forwardCb,\n\t\t\ttmpCb32 = this.forwardCb32;\n\n\t\tthis.forwardY = this.currentY;\n\t\tthis.forwardY32 = this.currentY32;\n\t\tthis.forwardCr = this.currentCr;\n\t\tthis.forwardCr32 = this.currentCr32;\n\t\tthis.forwardCb = this.currentCb;\n\t\tthis.forwardCb32 = this.currentCb32;\n\n\t\tthis.currentY = tmpY;\n\t\tthis.currentY32 = tmpY32;\n\t\tthis.currentCr = tmpCr;\n\t\tthis.currentCr32 = tmpCr32;\n\t\tthis.currentCb = tmpCb;\n\t\tthis.currentCb32 = tmpCb32;\n\t}\n};\n\n\n// Slice Layer\n\nMPEG1.prototype.quantizerScale = 0;\nMPEG1.prototype.sliceBegin = false;\n\nMPEG1.prototype.decodeSlice = function(slice) {\n\tthis.sliceBegin = true;\n\tthis.macroblockAddress = (slice - 1) * this.mbWidth - 1;\n\n\t// Reset motion vectors and DC predictors\n\tthis.motionFwH = this.motionFwHPrev = 0;\n\tthis.motionFwV = this.motionFwVPrev = 0;\n\tthis.dcPredictorY  = 128;\n\tthis.dcPredictorCr = 128;\n\tthis.dcPredictorCb = 128;\n\n\tthis.quantizerScale = this.bits.read(5);\n\n\t// skip extra bits\n\twhile (this.bits.read(1)) {\n\t\tthis.bits.skip(8);\n\t}\n\n\tdo {\n\t\tthis.decodeMacroblock();\n\t} while (!this.bits.nextBytesAreStartCode());\n};\n\n\n// Macroblock Layer\n\nMPEG1.prototype.macroblockAddress = 0;\nMPEG1.prototype.mbRow = 0;\nMPEG1.prototype.mbCol = 0;\n\nMPEG1.prototype.macroblockType = 0;\nMPEG1.prototype.macroblockIntra = false;\nMPEG1.prototype.macroblockMotFw = false;\n\nMPEG1.prototype.motionFwH = 0;\nMPEG1.prototype.motionFwV = 0;\nMPEG1.prototype.motionFwHPrev = 0;\nMPEG1.prototype.motionFwVPrev = 0;\n\nMPEG1.prototype.decodeMacroblock = function() {\n\t// Decode macroblock_address_increment\n\tvar\n\t\tincrement = 0,\n\t\tt = this.readHuffman(MPEG1.MACROBLOCK_ADDRESS_INCREMENT);\n\n\twhile (t === 34) {\n\t\t// macroblock_stuffing\n\t\tt = this.readHuffman(MPEG1.MACROBLOCK_ADDRESS_INCREMENT);\n\t}\n\twhile (t === 35) {\n\t\t// macroblock_escape\n\t\tincrement += 33;\n\t\tt = this.readHuffman(MPEG1.MACROBLOCK_ADDRESS_INCREMENT);\n\t}\n\tincrement += t;\n\n\t// Process any skipped macroblocks\n\tif (this.sliceBegin) {\n\t\t// The first macroblock_address_increment of each slice is relative\n\t\t// to beginning of the preverious row, not the preverious macroblock\n\t\tthis.sliceBegin = false;\n\t\tthis.macroblockAddress += increment;\n\t}\n\telse {\n\t\tif (this.macroblockAddress + increment >= this.mbSize) {\n\t\t\t// Illegal (too large) macroblock_address_increment\n\t\t\treturn;\n\t\t}\n\t\tif (increment > 1) {\n\t\t\t// Skipped macroblocks reset DC predictors\n\t\t\tthis.dcPredictorY  = 128;\n\t\t\tthis.dcPredictorCr = 128;\n\t\t\tthis.dcPredictorCb = 128;\n\n\t\t\t// Skipped macroblocks in P-pictures reset motion vectors\n\t\t\tif (this.pictureType === MPEG1.PICTURE_TYPE.PREDICTIVE) {\n\t\t\t\tthis.motionFwH = this.motionFwHPrev = 0;\n\t\t\t\tthis.motionFwV = this.motionFwVPrev = 0;\n\t\t\t}\n\t\t}\n\n\t\t// Predict skipped macroblocks\n\t\twhile (increment > 1) {\n\t\t\tthis.macroblockAddress++;\n\t\t\tthis.mbRow = (this.macroblockAddress / this.mbWidth)|0;\n\t\t\tthis.mbCol = this.macroblockAddress % this.mbWidth;\n\t\t\tthis.copyMacroblock(\n\t\t\t\tthis.motionFwH, this.motionFwV,\n\t\t\t\tthis.forwardY, this.forwardCr, this.forwardCb\n\t\t\t);\n\t\t\tincrement--;\n\t\t}\n\t\tthis.macroblockAddress++;\n\t}\n\tthis.mbRow = (this.macroblockAddress / this.mbWidth)|0;\n\tthis.mbCol = this.macroblockAddress % this.mbWidth;\n\n\t// Process the current macroblock\n\tvar mbTable = MPEG1.MACROBLOCK_TYPE[this.pictureType];\n\tthis.macroblockType = this.readHuffman(mbTable);\n\tthis.macroblockIntra = (this.macroblockType & 0x01);\n\tthis.macroblockMotFw = (this.macroblockType & 0x08);\n\n\t// Quantizer scale\n\tif ((this.macroblockType & 0x10) !== 0) {\n\t\tthis.quantizerScale = this.bits.read(5);\n\t}\n\n\tif (this.macroblockIntra) {\n\t\t// Intra-coded macroblocks reset motion vectors\n\t\tthis.motionFwH = this.motionFwHPrev = 0;\n\t\tthis.motionFwV = this.motionFwVPrev = 0;\n\t}\n\telse {\n\t\t// Non-intra macroblocks reset DC predictors\n\t\tthis.dcPredictorY = 128;\n\t\tthis.dcPredictorCr = 128;\n\t\tthis.dcPredictorCb = 128;\n\n\t\tthis.decodeMotionVectors();\n\t\tthis.copyMacroblock(\n\t\t\tthis.motionFwH, this.motionFwV,\n\t\t\tthis.forwardY, this.forwardCr, this.forwardCb\n\t\t);\n\t}\n\n\t// Decode blocks\n\tvar cbp = ((this.macroblockType & 0x02) !== 0)\n\t\t? this.readHuffman(MPEG1.CODE_BLOCK_PATTERN)\n\t\t: (this.macroblockIntra ? 0x3f : 0);\n\n\tfor (var block = 0, mask = 0x20; block < 6; block++) {\n\t\tif ((cbp & mask) !== 0) {\n\t\t\tthis.decodeBlock(block);\n\t\t}\n\t\tmask >>= 1;\n\t}\n};\n\n\nMPEG1.prototype.decodeMotionVectors = function() {\n\tvar code, d, r = 0;\n\n\t// Forward\n\tif (this.macroblockMotFw) {\n\t\t// Horizontal forward\n\t\tcode = this.readHuffman(MPEG1.MOTION);\n\t\tif ((code !== 0) && (this.forwardF !== 1)) {\n\t\t\tr = this.bits.read(this.forwardRSize);\n\t\t\td = ((Math.abs(code) - 1) << this.forwardRSize) + r + 1;\n\t\t\tif (code < 0) {\n\t\t\t\td = -d;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\td = code;\n\t\t}\n\n\t\tthis.motionFwHPrev += d;\n\t\tif (this.motionFwHPrev > (this.forwardF << 4) - 1) {\n\t\t\tthis.motionFwHPrev -= this.forwardF << 5;\n\t\t}\n\t\telse if (this.motionFwHPrev < ((-this.forwardF) << 4)) {\n\t\t\tthis.motionFwHPrev += this.forwardF << 5;\n\t\t}\n\n\t\tthis.motionFwH = this.motionFwHPrev;\n\t\tif (this.fullPelForward) {\n\t\t\tthis.motionFwH <<= 1;\n\t\t}\n\n\t\t// Vertical forward\n\t\tcode = this.readHuffman(MPEG1.MOTION);\n\t\tif ((code !== 0) && (this.forwardF !== 1)) {\n\t\t\tr = this.bits.read(this.forwardRSize);\n\t\t\td = ((Math.abs(code) - 1) << this.forwardRSize) + r + 1;\n\t\t\tif (code < 0) {\n\t\t\t\td = -d;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\td = code;\n\t\t}\n\n\t\tthis.motionFwVPrev += d;\n\t\tif (this.motionFwVPrev > (this.forwardF << 4) - 1) {\n\t\t\tthis.motionFwVPrev -= this.forwardF << 5;\n\t\t}\n\t\telse if (this.motionFwVPrev < ((-this.forwardF) << 4)) {\n\t\t\tthis.motionFwVPrev += this.forwardF << 5;\n\t\t}\n\n\t\tthis.motionFwV = this.motionFwVPrev;\n\t\tif (this.fullPelForward) {\n\t\t\tthis.motionFwV <<= 1;\n\t\t}\n\t}\n\telse if (this.pictureType === MPEG1.PICTURE_TYPE.PREDICTIVE) {\n\t\t// No motion information in P-picture, reset vectors\n\t\tthis.motionFwH = this.motionFwHPrev = 0;\n\t\tthis.motionFwV = this.motionFwVPrev = 0;\n\t}\n};\n\nMPEG1.prototype.copyMacroblock = function(motionH, motionV, sY, sCr, sCb) {\n\tvar\n\t\twidth, scan,\n\t\tH, V, oddH, oddV,\n\t\tsrc, dest, last;\n\n\t// We use 32bit writes here\n\tvar dY = this.currentY32,\n\t\tdCb = this.currentCb32,\n\t\tdCr = this.currentCr32;\n\n\t// Luminance\n\twidth = this.codedWidth;\n\tscan = width - 16;\n\n\tH = motionH >> 1;\n\tV = motionV >> 1;\n\toddH = (motionH & 1) === 1;\n\toddV = (motionV & 1) === 1;\n\n\tsrc = ((this.mbRow << 4) + V) * width + (this.mbCol << 4) + H;\n\tdest = (this.mbRow * width + this.mbCol) << 2;\n\tlast = dest + (width << 2);\n\n\tvar x, y1, y2, y;\n\tif (oddH) {\n\t\tif (oddV) {\n\t\t\twhile (dest < last) {\n\t\t\t\ty1 = sY[src] + sY[src+width]; src++;\n\t\t\t\tfor (x = 0; x < 4; x++) {\n\t\t\t\t\ty2 = sY[src] + sY[src+width]; src++;\n\t\t\t\t\ty = (((y1 + y2 + 2) >> 2) & 0xff);\n\n\t\t\t\t\ty1 = sY[src] + sY[src+width]; src++;\n\t\t\t\t\ty |= (((y1 + y2 + 2) << 6) & 0xff00);\n\n\t\t\t\t\ty2 = sY[src] + sY[src+width]; src++;\n\t\t\t\t\ty |= (((y1 + y2 + 2) << 14) & 0xff0000);\n\n\t\t\t\t\ty1 = sY[src] + sY[src+width]; src++;\n\t\t\t\t\ty |= (((y1 + y2 + 2) << 22) & 0xff000000);\n\n\t\t\t\t\tdY[dest++] = y;\n\t\t\t\t}\n\t\t\t\tdest += scan >> 2; src += scan-1;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\twhile (dest < last) {\n\t\t\t\ty1 = sY[src++];\n\t\t\t\tfor (x = 0; x < 4; x++) {\n\t\t\t\t\ty2 = sY[src++];\n\t\t\t\t\ty = (((y1 + y2 + 1) >> 1) & 0xff);\n\n\t\t\t\t\ty1 = sY[src++];\n\t\t\t\t\ty |= (((y1 + y2 + 1) << 7) & 0xff00);\n\n\t\t\t\t\ty2 = sY[src++];\n\t\t\t\t\ty |= (((y1 + y2 + 1) << 15) & 0xff0000);\n\n\t\t\t\t\ty1 = sY[src++];\n\t\t\t\t\ty |= (((y1 + y2 + 1) << 23) & 0xff000000);\n\n\t\t\t\t\tdY[dest++] = y;\n\t\t\t\t}\n\t\t\t\tdest += scan >> 2; src += scan-1;\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\tif (oddV) {\n\t\t\twhile (dest < last) {\n\t\t\t\tfor (x = 0; x < 4; x++) {\n\t\t\t\t\ty = (((sY[src] + sY[src+width] + 1) >> 1) & 0xff); src++;\n\t\t\t\t\ty |= (((sY[src] + sY[src+width] + 1) << 7) & 0xff00); src++;\n\t\t\t\t\ty |= (((sY[src] + sY[src+width] + 1) << 15) & 0xff0000); src++;\n\t\t\t\t\ty |= (((sY[src] + sY[src+width] + 1) << 23) & 0xff000000); src++;\n\n\t\t\t\t\tdY[dest++] = y;\n\t\t\t\t}\n\t\t\t\tdest += scan >> 2; src += scan;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\twhile (dest < last) {\n\t\t\t\tfor (x = 0; x < 4; x++) {\n\t\t\t\t\ty = sY[src]; src++;\n\t\t\t\t\ty |= sY[src] << 8; src++;\n\t\t\t\t\ty |= sY[src] << 16; src++;\n\t\t\t\t\ty |= sY[src] << 24; src++;\n\n\t\t\t\t\tdY[dest++] = y;\n\t\t\t\t}\n\t\t\t\tdest += scan >> 2; src += scan;\n\t\t\t}\n\t\t}\n\t}\n\n\t// Chrominance\n\n\twidth = this.halfWidth;\n\tscan = width - 8;\n\n\tH = (motionH/2) >> 1;\n\tV = (motionV/2) >> 1;\n\toddH = ((motionH/2) & 1) === 1;\n\toddV = ((motionV/2) & 1) === 1;\n\n\tsrc = ((this.mbRow << 3) + V) * width + (this.mbCol << 3) + H;\n\tdest = (this.mbRow * width + this.mbCol) << 1;\n\tlast = dest + (width << 1);\n\n\tvar cr1, cr2, cr,\n\t\tcb1, cb2, cb;\n\tif (oddH) {\n\t\tif (oddV) {\n\t\t\twhile (dest < last) {\n\t\t\t\tcr1 = sCr[src] + sCr[src+width];\n\t\t\t\tcb1 = sCb[src] + sCb[src+width];\n\t\t\t\tsrc++;\n\t\t\t\tfor (x = 0; x < 2; x++) {\n\t\t\t\t\tcr2 = sCr[src] + sCr[src+width];\n\t\t\t\t\tcb2 = sCb[src] + sCb[src+width]; src++;\n\t\t\t\t\tcr = (((cr1 + cr2 + 2) >> 2) & 0xff);\n\t\t\t\t\tcb = (((cb1 + cb2 + 2) >> 2) & 0xff);\n\n\t\t\t\t\tcr1 = sCr[src] + sCr[src+width];\n\t\t\t\t\tcb1 = sCb[src] + sCb[src+width]; src++;\n\t\t\t\t\tcr |= (((cr1 + cr2 + 2) << 6) & 0xff00);\n\t\t\t\t\tcb |= (((cb1 + cb2 + 2) << 6) & 0xff00);\n\n\t\t\t\t\tcr2 = sCr[src] + sCr[src+width];\n\t\t\t\t\tcb2 = sCb[src] + sCb[src+width]; src++;\n\t\t\t\t\tcr |= (((cr1 + cr2 + 2) << 14) & 0xff0000);\n\t\t\t\t\tcb |= (((cb1 + cb2 + 2) << 14) & 0xff0000);\n\n\t\t\t\t\tcr1 = sCr[src] + sCr[src+width];\n\t\t\t\t\tcb1 = sCb[src] + sCb[src+width]; src++;\n\t\t\t\t\tcr |= (((cr1 + cr2 + 2) << 22) & 0xff000000);\n\t\t\t\t\tcb |= (((cb1 + cb2 + 2) << 22) & 0xff000000);\n\n\t\t\t\t\tdCr[dest] = cr;\n\t\t\t\t\tdCb[dest] = cb;\n\t\t\t\t\tdest++;\n\t\t\t\t}\n\t\t\t\tdest += scan >> 2; src += scan-1;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\twhile (dest < last) {\n\t\t\t\tcr1 = sCr[src];\n\t\t\t\tcb1 = sCb[src];\n\t\t\t\tsrc++;\n\t\t\t\tfor (x = 0; x < 2; x++) {\n\t\t\t\t\tcr2 = sCr[src];\n\t\t\t\t\tcb2 = sCb[src++];\n\t\t\t\t\tcr = (((cr1 + cr2 + 1) >> 1) & 0xff);\n\t\t\t\t\tcb = (((cb1 + cb2 + 1) >> 1) & 0xff);\n\n\t\t\t\t\tcr1 = sCr[src];\n\t\t\t\t\tcb1 = sCb[src++];\n\t\t\t\t\tcr |= (((cr1 + cr2 + 1) << 7) & 0xff00);\n\t\t\t\t\tcb |= (((cb1 + cb2 + 1) << 7) & 0xff00);\n\n\t\t\t\t\tcr2 = sCr[src];\n\t\t\t\t\tcb2 = sCb[src++];\n\t\t\t\t\tcr |= (((cr1 + cr2 + 1) << 15) & 0xff0000);\n\t\t\t\t\tcb |= (((cb1 + cb2 + 1) << 15) & 0xff0000);\n\n\t\t\t\t\tcr1 = sCr[src];\n\t\t\t\t\tcb1 = sCb[src++];\n\t\t\t\t\tcr |= (((cr1 + cr2 + 1) << 23) & 0xff000000);\n\t\t\t\t\tcb |= (((cb1 + cb2 + 1) << 23) & 0xff000000);\n\n\t\t\t\t\tdCr[dest] = cr;\n\t\t\t\t\tdCb[dest] = cb;\n\t\t\t\t\tdest++;\n\t\t\t\t}\n\t\t\t\tdest += scan >> 2; src += scan-1;\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\tif (oddV) {\n\t\t\twhile (dest < last) {\n\t\t\t\tfor (x = 0; x < 2; x++) {\n\t\t\t\t\tcr = (((sCr[src] + sCr[src+width] + 1) >> 1) & 0xff);\n\t\t\t\t\tcb = (((sCb[src] + sCb[src+width] + 1) >> 1) & 0xff); src++;\n\n\t\t\t\t\tcr |= (((sCr[src] + sCr[src+width] + 1) << 7) & 0xff00);\n\t\t\t\t\tcb |= (((sCb[src] + sCb[src+width] + 1) << 7) & 0xff00); src++;\n\n\t\t\t\t\tcr |= (((sCr[src] + sCr[src+width] + 1) << 15) & 0xff0000);\n\t\t\t\t\tcb |= (((sCb[src] + sCb[src+width] + 1) << 15) & 0xff0000); src++;\n\n\t\t\t\t\tcr |= (((sCr[src] + sCr[src+width] + 1) << 23) & 0xff000000);\n\t\t\t\t\tcb |= (((sCb[src] + sCb[src+width] + 1) << 23) & 0xff000000); src++;\n\n\t\t\t\t\tdCr[dest] = cr;\n\t\t\t\t\tdCb[dest] = cb;\n\t\t\t\t\tdest++;\n\t\t\t\t}\n\t\t\t\tdest += scan >> 2; src += scan;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\twhile (dest < last) {\n\t\t\t\tfor (x = 0; x < 2; x++) {\n\t\t\t\t\tcr = sCr[src];\n\t\t\t\t\tcb = sCb[src]; src++;\n\n\t\t\t\t\tcr |= sCr[src] << 8;\n\t\t\t\t\tcb |= sCb[src] << 8; src++;\n\n\t\t\t\t\tcr |= sCr[src] << 16;\n\t\t\t\t\tcb |= sCb[src] << 16; src++;\n\n\t\t\t\t\tcr |= sCr[src] << 24;\n\t\t\t\t\tcb |= sCb[src] << 24; src++;\n\n\t\t\t\t\tdCr[dest] = cr;\n\t\t\t\t\tdCb[dest] = cb;\n\t\t\t\t\tdest++;\n\t\t\t\t}\n\t\t\t\tdest += scan >> 2; src += scan;\n\t\t\t}\n\t\t}\n\t}\n};\n\n\n// Block layer\n\nMPEG1.prototype.dcPredictorY = 0;\nMPEG1.prototype.dcPredictorCr = 0;\nMPEG1.prototype.dcPredictorCb = 0;\n\nMPEG1.prototype.blockData = null;\n\nMPEG1.prototype.decodeBlock = function(block) {\n\n\tvar\n\t\tn = 0,\n\t\tquantMatrix;\n\n\t// Decode DC coefficient of intra-coded blocks\n\tif (this.macroblockIntra) {\n\t\tvar\n\t\t\tpredictor,\n\t\t\tdctSize;\n\n\t\t// DC prediction\n\n\t\tif (block < 4) {\n\t\t\tpredictor = this.dcPredictorY;\n\t\t\tdctSize = this.readHuffman(MPEG1.DCT_DC_SIZE_LUMINANCE);\n\t\t}\n\t\telse {\n\t\t\tpredictor = (block === 4 ? this.dcPredictorCr : this.dcPredictorCb);\n\t\t\tdctSize = this.readHuffman(MPEG1.DCT_DC_SIZE_CHROMINANCE);\n\t\t}\n\n\t\t// Read DC coeff\n\t\tif (dctSize > 0) {\n\t\t\tvar differential = this.bits.read(dctSize);\n\t\t\tif ((differential & (1 << (dctSize - 1))) !== 0) {\n\t\t\t\tthis.blockData[0] = predictor + differential;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.blockData[0] = predictor + ((-1 << dctSize)|(differential+1));\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tthis.blockData[0] = predictor;\n\t\t}\n\n\t\t// Save predictor value\n\t\tif (block < 4) {\n\t\t\tthis.dcPredictorY = this.blockData[0];\n\t\t}\n\t\telse if (block === 4) {\n\t\t\tthis.dcPredictorCr = this.blockData[0];\n\t\t}\n\t\telse {\n\t\t\tthis.dcPredictorCb = this.blockData[0];\n\t\t}\n\n\t\t// Dequantize + premultiply\n\t\tthis.blockData[0] <<= (3 + 5);\n\n\t\tquantMatrix = this.intraQuantMatrix;\n\t\tn = 1;\n\t}\n\telse {\n\t\tquantMatrix = this.nonIntraQuantMatrix;\n\t}\n\n\t// Decode AC coefficients (+DC for non-intra)\n\tvar level = 0;\n\twhile (true) {\n\t\tvar\n\t\t\trun = 0,\n\t\t\tcoeff = this.readHuffman(MPEG1.DCT_COEFF);\n\n\t\tif ((coeff === 0x0001) && (n > 0) && (this.bits.read(1) === 0)) {\n\t\t\t// end_of_block\n\t\t\tbreak;\n\t\t}\n\t\tif (coeff === 0xffff) {\n\t\t\t// escape\n\t\t\trun = this.bits.read(6);\n\t\t\tlevel = this.bits.read(8);\n\t\t\tif (level === 0) {\n\t\t\t\tlevel = this.bits.read(8);\n\t\t\t}\n\t\t\telse if (level === 128) {\n\t\t\t\tlevel = this.bits.read(8) - 256;\n\t\t\t}\n\t\t\telse if (level > 128) {\n\t\t\t\tlevel = level - 256;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\trun = coeff >> 8;\n\t\t\tlevel = coeff & 0xff;\n\t\t\tif (this.bits.read(1)) {\n\t\t\t\tlevel = -level;\n\t\t\t}\n\t\t}\n\n\t\tn += run;\n\t\tvar dezigZagged = MPEG1.ZIG_ZAG[n];\n\t\tn++;\n\n\t\t// Dequantize, oddify, clip\n\t\tlevel <<= 1;\n\t\tif (!this.macroblockIntra) {\n\t\t\tlevel += (level < 0 ? -1 : 1);\n\t\t}\n\t\tlevel = (level * this.quantizerScale * quantMatrix[dezigZagged]) >> 4;\n\t\tif ((level & 1) === 0) {\n\t\t\tlevel -= level > 0 ? 1 : -1;\n\t\t}\n\t\tif (level > 2047) {\n\t\t\tlevel = 2047;\n\t\t}\n\t\telse if (level < -2048) {\n\t\t\tlevel = -2048;\n\t\t}\n\n\t\t// Save premultiplied coefficient\n\t\tthis.blockData[dezigZagged] = level * MPEG1.PREMULTIPLIER_MATRIX[dezigZagged];\n\t}\n\n\t// Move block to its place\n\tvar\n\t\tdestArray,\n\t\tdestIndex,\n\t\tscan;\n\n\tif (block < 4) {\n\t\tdestArray = this.currentY;\n\t\tscan = this.codedWidth - 8;\n\t\tdestIndex = (this.mbRow * this.codedWidth + this.mbCol) << 4;\n\t\tif ((block & 1) !== 0) {\n\t\t\tdestIndex += 8;\n\t\t}\n\t\tif ((block & 2) !== 0) {\n\t\t\tdestIndex += this.codedWidth << 3;\n\t\t}\n\t}\n\telse {\n\t\tdestArray = (block === 4) ? this.currentCb : this.currentCr;\n\t\tscan = (this.codedWidth >> 1) - 8;\n\t\tdestIndex = ((this.mbRow * this.codedWidth) << 2) + (this.mbCol << 3);\n\t}\n\n\tif (this.macroblockIntra) {\n\t\t// Overwrite (no prediction)\n\t\tif (n === 1) {\n\t\t\tMPEG1.CopyValueToDestination((this.blockData[0] + 128) >> 8, destArray, destIndex, scan);\n\t\t\tthis.blockData[0] = 0;\n\t\t}\n\t\telse {\n\t\t\tMPEG1.IDCT(this.blockData);\n\t\t\tMPEG1.CopyBlockToDestination(this.blockData, destArray, destIndex, scan);\n\t\t\tJSMpeg.Fill(this.blockData, 0);\n\t\t}\n\t}\n\telse {\n\t\t// Add data to the predicted macroblock\n\t\tif (n === 1) {\n\t\t\tMPEG1.AddValueToDestination((this.blockData[0] + 128) >> 8, destArray, destIndex, scan);\n\t\t\tthis.blockData[0] = 0;\n\t\t}\n\t\telse {\n\t\t\tMPEG1.IDCT(this.blockData);\n\t\t\tMPEG1.AddBlockToDestination(this.blockData, destArray, destIndex, scan);\n\t\t\tJSMpeg.Fill(this.blockData, 0);\n\t\t}\n\t}\n\n\tn = 0;\n};\n\nMPEG1.CopyBlockToDestination = function(block, dest, index, scan) {\n\tfor (var n = 0; n < 64; n += 8, index += scan+8) {\n\t\tdest[index+0] = block[n+0];\n\t\tdest[index+1] = block[n+1];\n\t\tdest[index+2] = block[n+2];\n\t\tdest[index+3] = block[n+3];\n\t\tdest[index+4] = block[n+4];\n\t\tdest[index+5] = block[n+5];\n\t\tdest[index+6] = block[n+6];\n\t\tdest[index+7] = block[n+7];\n\t}\n};\n\nMPEG1.AddBlockToDestination = function(block, dest, index, scan) {\n\tfor (var n = 0; n < 64; n += 8, index += scan+8) {\n\t\tdest[index+0] += block[n+0];\n\t\tdest[index+1] += block[n+1];\n\t\tdest[index+2] += block[n+2];\n\t\tdest[index+3] += block[n+3];\n\t\tdest[index+4] += block[n+4];\n\t\tdest[index+5] += block[n+5];\n\t\tdest[index+6] += block[n+6];\n\t\tdest[index+7] += block[n+7];\n\t}\n};\n\nMPEG1.CopyValueToDestination = function(value, dest, index, scan) {\n\tfor (var n = 0; n < 64; n += 8, index += scan+8) {\n\t\tdest[index+0] = value;\n\t\tdest[index+1] = value;\n\t\tdest[index+2] = value;\n\t\tdest[index+3] = value;\n\t\tdest[index+4] = value;\n\t\tdest[index+5] = value;\n\t\tdest[index+6] = value;\n\t\tdest[index+7] = value;\n\t}\n};\n\nMPEG1.AddValueToDestination = function(value, dest, index, scan) {\n\tfor (var n = 0; n < 64; n += 8, index += scan+8) {\n\t\tdest[index+0] += value;\n\t\tdest[index+1] += value;\n\t\tdest[index+2] += value;\n\t\tdest[index+3] += value;\n\t\tdest[index+4] += value;\n\t\tdest[index+5] += value;\n\t\tdest[index+6] += value;\n\t\tdest[index+7] += value;\n\t}\n};\n\nMPEG1.IDCT = function(block) {\n\t// See http://vsr.informatik.tu-chemnitz.de/~jan/MPEG/HTML/IDCT.html\n\t// for more info.\n\n\tvar\n\t\tb1, b3, b4, b6, b7, tmp1, tmp2, m0,\n\t\tx0, x1, x2, x3, x4, y3, y4, y5, y6, y7;\n\n\t// Transform columns\n\tfor (var i = 0; i < 8; ++i) {\n\t\tb1 = block[4*8+i];\n\t\tb3 = block[2*8+i] + block[6*8+i];\n\t\tb4 = block[5*8+i] - block[3*8+i];\n\t\ttmp1 = block[1*8+i] + block[7*8+i];\n\t\ttmp2 = block[3*8+i] + block[5*8+i];\n\t\tb6 = block[1*8+i] - block[7*8+i];\n\t\tb7 = tmp1 + tmp2;\n\t\tm0 = block[0*8+i];\n\t\tx4 = ((b6*473 - b4*196 + 128) >> 8) - b7;\n\t\tx0 = x4 - (((tmp1 - tmp2)*362 + 128) >> 8);\n\t\tx1 = m0 - b1;\n\t\tx2 = (((block[2*8+i] - block[6*8+i])*362 + 128) >> 8) - b3;\n\t\tx3 = m0 + b1;\n\t\ty3 = x1 + x2;\n\t\ty4 = x3 + b3;\n\t\ty5 = x1 - x2;\n\t\ty6 = x3 - b3;\n\t\ty7 = -x0 - ((b4*473 + b6*196 + 128) >> 8);\n\t\tblock[0*8+i] = b7 + y4;\n\t\tblock[1*8+i] = x4 + y3;\n\t\tblock[2*8+i] = y5 - x0;\n\t\tblock[3*8+i] = y6 - y7;\n\t\tblock[4*8+i] = y6 + y7;\n\t\tblock[5*8+i] = x0 + y5;\n\t\tblock[6*8+i] = y3 - x4;\n\t\tblock[7*8+i] = y4 - b7;\n\t}\n\n\t// Transform rows\n\tfor (var i = 0; i < 64; i += 8) {\n\t\tb1 = block[4+i];\n\t\tb3 = block[2+i] + block[6+i];\n\t\tb4 = block[5+i] - block[3+i];\n\t\ttmp1 = block[1+i] + block[7+i];\n\t\ttmp2 = block[3+i] + block[5+i];\n\t\tb6 = block[1+i] - block[7+i];\n\t\tb7 = tmp1 + tmp2;\n\t\tm0 = block[0+i];\n\t\tx4 = ((b6*473 - b4*196 + 128) >> 8) - b7;\n\t\tx0 = x4 - (((tmp1 - tmp2)*362 + 128) >> 8);\n\t\tx1 = m0 - b1;\n\t\tx2 = (((block[2+i] - block[6+i])*362 + 128) >> 8) - b3;\n\t\tx3 = m0 + b1;\n\t\ty3 = x1 + x2;\n\t\ty4 = x3 + b3;\n\t\ty5 = x1 - x2;\n\t\ty6 = x3 - b3;\n\t\ty7 = -x0 - ((b4*473 + b6*196 + 128) >> 8);\n\t\tblock[0+i] = (b7 + y4 + 128) >> 8;\n\t\tblock[1+i] = (x4 + y3 + 128) >> 8;\n\t\tblock[2+i] = (y5 - x0 + 128) >> 8;\n\t\tblock[3+i] = (y6 - y7 + 128) >> 8;\n\t\tblock[4+i] = (y6 + y7 + 128) >> 8;\n\t\tblock[5+i] = (x0 + y5 + 128) >> 8;\n\t\tblock[6+i] = (y3 - x4 + 128) >> 8;\n\t\tblock[7+i] = (y4 - b7 + 128) >> 8;\n\t}\n};\n\n\n// VLC Tables and Constants\n\nMPEG1.PICTURE_RATE = [\n\t0.000, 23.976, 24.000, 25.000, 29.970, 30.000, 50.000, 59.940,\n\t60.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000\n];\n\nMPEG1.ZIG_ZAG = new Uint8Array([\n\t 0,  1,  8, 16,  9,  2,  3, 10,\n\t17, 24, 32, 25, 18, 11,  4,  5,\n\t12, 19, 26, 33, 40, 48, 41, 34,\n\t27, 20, 13,  6,  7, 14, 21, 28,\n\t35, 42, 49, 56, 57, 50, 43, 36,\n\t29, 22, 15, 23, 30, 37, 44, 51,\n\t58, 59, 52, 45, 38, 31, 39, 46,\n\t53, 60, 61, 54, 47, 55, 62, 63\n]);\n\nMPEG1.DEFAULT_INTRA_QUANT_MATRIX = new Uint8Array([\n\t 8, 16, 19, 22, 26, 27, 29, 34,\n\t16, 16, 22, 24, 27, 29, 34, 37,\n\t19, 22, 26, 27, 29, 34, 34, 38,\n\t22, 22, 26, 27, 29, 34, 37, 40,\n\t22, 26, 27, 29, 32, 35, 40, 48,\n\t26, 27, 29, 32, 35, 40, 48, 58,\n\t26, 27, 29, 34, 38, 46, 56, 69,\n\t27, 29, 35, 38, 46, 56, 69, 83\n]);\n\nMPEG1.DEFAULT_NON_INTRA_QUANT_MATRIX = new Uint8Array([\n\t16, 16, 16, 16, 16, 16, 16, 16,\n\t16, 16, 16, 16, 16, 16, 16, 16,\n\t16, 16, 16, 16, 16, 16, 16, 16,\n\t16, 16, 16, 16, 16, 16, 16, 16,\n\t16, 16, 16, 16, 16, 16, 16, 16,\n\t16, 16, 16, 16, 16, 16, 16, 16,\n\t16, 16, 16, 16, 16, 16, 16, 16,\n\t16, 16, 16, 16, 16, 16, 16, 16\n]);\n\nMPEG1.PREMULTIPLIER_MATRIX = new Uint8Array([\n\t32, 44, 42, 38, 32, 25, 17,  9,\n\t44, 62, 58, 52, 44, 35, 24, 12,\n\t42, 58, 55, 49, 42, 33, 23, 12,\n\t38, 52, 49, 44, 38, 30, 20, 10,\n\t32, 44, 42, 38, 32, 25, 17,  9,\n\t25, 35, 33, 30, 25, 20, 14,  7,\n\t17, 24, 23, 20, 17, 14,  9,  5,\n\t 9, 12, 12, 10,  9,  7,  5,  2\n]);\n\n// MPEG-1 VLC\n\n//  macroblock_stuffing decodes as 34.\n//  macroblock_escape decodes as 35.\n\nMPEG1.MACROBLOCK_ADDRESS_INCREMENT = new Int16Array([\n\t 1*3,  2*3,  0, //   0\n\t 3*3,  4*3,  0, //   1  0\n\t   0,    0,  1, //   2  1.\n\t 5*3,  6*3,  0, //   3  00\n\t 7*3,  8*3,  0, //   4  01\n\t 9*3, 10*3,  0, //   5  000\n\t11*3, 12*3,  0, //   6  001\n\t   0,    0,  3, //   7  010.\n\t   0,    0,  2, //   8  011.\n\t13*3, 14*3,  0, //   9  0000\n\t15*3, 16*3,  0, //  10  0001\n\t   0,    0,  5, //  11  0010.\n\t   0,    0,  4, //  12  0011.\n\t17*3, 18*3,  0, //  13  0000 0\n\t19*3, 20*3,  0, //  14  0000 1\n\t   0,    0,  7, //  15  0001 0.\n\t   0,    0,  6, //  16  0001 1.\n\t21*3, 22*3,  0, //  17  0000 00\n\t23*3, 24*3,  0, //  18  0000 01\n\t25*3, 26*3,  0, //  19  0000 10\n\t27*3, 28*3,  0, //  20  0000 11\n\t  -1, 29*3,  0, //  21  0000 000\n\t  -1, 30*3,  0, //  22  0000 001\n\t31*3, 32*3,  0, //  23  0000 010\n\t33*3, 34*3,  0, //  24  0000 011\n\t35*3, 36*3,  0, //  25  0000 100\n\t37*3, 38*3,  0, //  26  0000 101\n\t   0,    0,  9, //  27  0000 110.\n\t   0,    0,  8, //  28  0000 111.\n\t39*3, 40*3,  0, //  29  0000 0001\n\t41*3, 42*3,  0, //  30  0000 0011\n\t43*3, 44*3,  0, //  31  0000 0100\n\t45*3, 46*3,  0, //  32  0000 0101\n\t   0,    0, 15, //  33  0000 0110.\n\t   0,    0, 14, //  34  0000 0111.\n\t   0,    0, 13, //  35  0000 1000.\n\t   0,    0, 12, //  36  0000 1001.\n\t   0,    0, 11, //  37  0000 1010.\n\t   0,    0, 10, //  38  0000 1011.\n\t47*3,   -1,  0, //  39  0000 0001 0\n\t  -1, 48*3,  0, //  40  0000 0001 1\n\t49*3, 50*3,  0, //  41  0000 0011 0\n\t51*3, 52*3,  0, //  42  0000 0011 1\n\t53*3, 54*3,  0, //  43  0000 0100 0\n\t55*3, 56*3,  0, //  44  0000 0100 1\n\t57*3, 58*3,  0, //  45  0000 0101 0\n\t59*3, 60*3,  0, //  46  0000 0101 1\n\t61*3,   -1,  0, //  47  0000 0001 00\n\t  -1, 62*3,  0, //  48  0000 0001 11\n\t63*3, 64*3,  0, //  49  0000 0011 00\n\t65*3, 66*3,  0, //  50  0000 0011 01\n\t67*3, 68*3,  0, //  51  0000 0011 10\n\t69*3, 70*3,  0, //  52  0000 0011 11\n\t71*3, 72*3,  0, //  53  0000 0100 00\n\t73*3, 74*3,  0, //  54  0000 0100 01\n\t   0,    0, 21, //  55  0000 0100 10.\n\t   0,    0, 20, //  56  0000 0100 11.\n\t   0,    0, 19, //  57  0000 0101 00.\n\t   0,    0, 18, //  58  0000 0101 01.\n\t   0,    0, 17, //  59  0000 0101 10.\n\t   0,    0, 16, //  60  0000 0101 11.\n\t   0,    0, 35, //  61  0000 0001 000. -- macroblock_escape\n\t   0,    0, 34, //  62  0000 0001 111. -- macroblock_stuffing\n\t   0,    0, 33, //  63  0000 0011 000.\n\t   0,    0, 32, //  64  0000 0011 001.\n\t   0,    0, 31, //  65  0000 0011 010.\n\t   0,    0, 30, //  66  0000 0011 011.\n\t   0,    0, 29, //  67  0000 0011 100.\n\t   0,    0, 28, //  68  0000 0011 101.\n\t   0,    0, 27, //  69  0000 0011 110.\n\t   0,    0, 26, //  70  0000 0011 111.\n\t   0,    0, 25, //  71  0000 0100 000.\n\t   0,    0, 24, //  72  0000 0100 001.\n\t   0,    0, 23, //  73  0000 0100 010.\n\t   0,    0, 22  //  74  0000 0100 011.\n]);\n\n//  macroblock_type bitmap:\n//    0x10  macroblock_quant\n//    0x08  macroblock_motion_forward\n//    0x04  macroblock_motion_backward\n//    0x02  macrobkock_pattern\n//    0x01  macroblock_intra\n//\n\nMPEG1.MACROBLOCK_TYPE_INTRA = new Int8Array([\n\t 1*3,  2*3,     0, //   0\n\t  -1,  3*3,     0, //   1  0\n\t   0,    0,  0x01, //   2  1.\n\t   0,    0,  0x11  //   3  01.\n]);\n\nMPEG1.MACROBLOCK_TYPE_PREDICTIVE = new Int8Array([\n\t 1*3,  2*3,     0, //  0\n\t 3*3,  4*3,     0, //  1  0\n\t   0,    0,  0x0a, //  2  1.\n\t 5*3,  6*3,     0, //  3  00\n\t   0,    0,  0x02, //  4  01.\n\t 7*3,  8*3,     0, //  5  000\n\t   0,    0,  0x08, //  6  001.\n\t 9*3, 10*3,     0, //  7  0000\n\t11*3, 12*3,     0, //  8  0001\n\t  -1, 13*3,     0, //  9  00000\n\t   0,    0,  0x12, // 10  00001.\n\t   0,    0,  0x1a, // 11  00010.\n\t   0,    0,  0x01, // 12  00011.\n\t   0,    0,  0x11  // 13  000001.\n]);\n\nMPEG1.MACROBLOCK_TYPE_B = new Int8Array([\n\t 1*3,  2*3,     0,  //  0\n\t 3*3,  5*3,     0,  //  1  0\n\t 4*3,  6*3,     0,  //  2  1\n\t 8*3,  7*3,     0,  //  3  00\n\t   0,    0,  0x0c,  //  4  10.\n\t 9*3, 10*3,     0,  //  5  01\n\t   0,    0,  0x0e,  //  6  11.\n\t13*3, 14*3,     0,  //  7  001\n\t12*3, 11*3,     0,  //  8  000\n\t   0,    0,  0x04,  //  9  010.\n\t   0,    0,  0x06,  // 10  011.\n\t18*3, 16*3,     0,  // 11  0001\n\t15*3, 17*3,     0,  // 12  0000\n\t   0,    0,  0x08,  // 13  0010.\n\t   0,    0,  0x0a,  // 14  0011.\n\t  -1, 19*3,     0,  // 15  00000\n\t   0,    0,  0x01,  // 16  00011.\n\t20*3, 21*3,     0,  // 17  00001\n\t   0,    0,  0x1e,  // 18  00010.\n\t   0,    0,  0x11,  // 19  000001.\n\t   0,    0,  0x16,  // 20  000010.\n\t   0,    0,  0x1a   // 21  000011.\n]);\n\nMPEG1.MACROBLOCK_TYPE = [\n\tnull,\n\tMPEG1.MACROBLOCK_TYPE_INTRA,\n\tMPEG1.MACROBLOCK_TYPE_PREDICTIVE,\n\tMPEG1.MACROBLOCK_TYPE_B\n];\n\nMPEG1.CODE_BLOCK_PATTERN = new Int16Array([\n\t  2*3,   1*3,   0,  //   0\n\t  3*3,   6*3,   0,  //   1  1\n\t  4*3,   5*3,   0,  //   2  0\n\t  8*3,  11*3,   0,  //   3  10\n\t 12*3,  13*3,   0,  //   4  00\n\t  9*3,   7*3,   0,  //   5  01\n\t 10*3,  14*3,   0,  //   6  11\n\t 20*3,  19*3,   0,  //   7  011\n\t 18*3,  16*3,   0,  //   8  100\n\t 23*3,  17*3,   0,  //   9  010\n\t 27*3,  25*3,   0,  //  10  110\n\t 21*3,  28*3,   0,  //  11  101\n\t 15*3,  22*3,   0,  //  12  000\n\t 24*3,  26*3,   0,  //  13  001\n\t    0,     0,  60,  //  14  111.\n\t 35*3,  40*3,   0,  //  15  0000\n\t 44*3,  48*3,   0,  //  16  1001\n\t 38*3,  36*3,   0,  //  17  0101\n\t 42*3,  47*3,   0,  //  18  1000\n\t 29*3,  31*3,   0,  //  19  0111\n\t 39*3,  32*3,   0,  //  20  0110\n\t    0,     0,  32,  //  21  1010.\n\t 45*3,  46*3,   0,  //  22  0001\n\t 33*3,  41*3,   0,  //  23  0100\n\t 43*3,  34*3,   0,  //  24  0010\n\t    0,     0,   4,  //  25  1101.\n\t 30*3,  37*3,   0,  //  26  0011\n\t    0,     0,   8,  //  27  1100.\n\t    0,     0,  16,  //  28  1011.\n\t    0,     0,  44,  //  29  0111 0.\n\t 50*3,  56*3,   0,  //  30  0011 0\n\t    0,     0,  28,  //  31  0111 1.\n\t    0,     0,  52,  //  32  0110 1.\n\t    0,     0,  62,  //  33  0100 0.\n\t 61*3,  59*3,   0,  //  34  0010 1\n\t 52*3,  60*3,   0,  //  35  0000 0\n\t    0,     0,   1,  //  36  0101 1.\n\t 55*3,  54*3,   0,  //  37  0011 1\n\t    0,     0,  61,  //  38  0101 0.\n\t    0,     0,  56,  //  39  0110 0.\n\t 57*3,  58*3,   0,  //  40  0000 1\n\t    0,     0,   2,  //  41  0100 1.\n\t    0,     0,  40,  //  42  1000 0.\n\t 51*3,  62*3,   0,  //  43  0010 0\n\t    0,     0,  48,  //  44  1001 0.\n\t 64*3,  63*3,   0,  //  45  0001 0\n\t 49*3,  53*3,   0,  //  46  0001 1\n\t    0,     0,  20,  //  47  1000 1.\n\t    0,     0,  12,  //  48  1001 1.\n\t 80*3,  83*3,   0,  //  49  0001 10\n\t    0,     0,  63,  //  50  0011 00.\n\t 77*3,  75*3,   0,  //  51  0010 00\n\t 65*3,  73*3,   0,  //  52  0000 00\n\t 84*3,  66*3,   0,  //  53  0001 11\n\t    0,     0,  24,  //  54  0011 11.\n\t    0,     0,  36,  //  55  0011 10.\n\t    0,     0,   3,  //  56  0011 01.\n\t 69*3,  87*3,   0,  //  57  0000 10\n\t 81*3,  79*3,   0,  //  58  0000 11\n\t 68*3,  71*3,   0,  //  59  0010 11\n\t 70*3,  78*3,   0,  //  60  0000 01\n\t 67*3,  76*3,   0,  //  61  0010 10\n\t 72*3,  74*3,   0,  //  62  0010 01\n\t 86*3,  85*3,   0,  //  63  0001 01\n\t 88*3,  82*3,   0,  //  64  0001 00\n\t   -1,  94*3,   0,  //  65  0000 000\n\t 95*3,  97*3,   0,  //  66  0001 111\n\t    0,     0,  33,  //  67  0010 100.\n\t    0,     0,   9,  //  68  0010 110.\n\t106*3, 110*3,   0,  //  69  0000 100\n\t102*3, 116*3,   0,  //  70  0000 010\n\t    0,     0,   5,  //  71  0010 111.\n\t    0,     0,  10,  //  72  0010 010.\n\t 93*3,  89*3,   0,  //  73  0000 001\n\t    0,     0,   6,  //  74  0010 011.\n\t    0,     0,  18,  //  75  0010 001.\n\t    0,     0,  17,  //  76  0010 101.\n\t    0,     0,  34,  //  77  0010 000.\n\t113*3, 119*3,   0,  //  78  0000 011\n\t103*3, 104*3,   0,  //  79  0000 111\n\t 90*3,  92*3,   0,  //  80  0001 100\n\t109*3, 107*3,   0,  //  81  0000 110\n\t117*3, 118*3,   0,  //  82  0001 001\n\t101*3,  99*3,   0,  //  83  0001 101\n\t 98*3,  96*3,   0,  //  84  0001 110\n\t100*3,  91*3,   0,  //  85  0001 011\n\t114*3, 115*3,   0,  //  86  0001 010\n\t105*3, 108*3,   0,  //  87  0000 101\n\t112*3, 111*3,   0,  //  88  0001 000\n\t121*3, 125*3,   0,  //  89  0000 0011\n\t    0,     0,  41,  //  90  0001 1000.\n\t    0,     0,  14,  //  91  0001 0111.\n\t    0,     0,  21,  //  92  0001 1001.\n\t124*3, 122*3,   0,  //  93  0000 0010\n\t120*3, 123*3,   0,  //  94  0000 0001\n\t    0,     0,  11,  //  95  0001 1110.\n\t    0,     0,  19,  //  96  0001 1101.\n\t    0,     0,   7,  //  97  0001 1111.\n\t    0,     0,  35,  //  98  0001 1100.\n\t    0,     0,  13,  //  99  0001 1011.\n\t    0,     0,  50,  // 100  0001 0110.\n\t    0,     0,  49,  // 101  0001 1010.\n\t    0,     0,  58,  // 102  0000 0100.\n\t    0,     0,  37,  // 103  0000 1110.\n\t    0,     0,  25,  // 104  0000 1111.\n\t    0,     0,  45,  // 105  0000 1010.\n\t    0,     0,  57,  // 106  0000 1000.\n\t    0,     0,  26,  // 107  0000 1101.\n\t    0,     0,  29,  // 108  0000 1011.\n\t    0,     0,  38,  // 109  0000 1100.\n\t    0,     0,  53,  // 110  0000 1001.\n\t    0,     0,  23,  // 111  0001 0001.\n\t    0,     0,  43,  // 112  0001 0000.\n\t    0,     0,  46,  // 113  0000 0110.\n\t    0,     0,  42,  // 114  0001 0100.\n\t    0,     0,  22,  // 115  0001 0101.\n\t    0,     0,  54,  // 116  0000 0101.\n\t    0,     0,  51,  // 117  0001 0010.\n\t    0,     0,  15,  // 118  0001 0011.\n\t    0,     0,  30,  // 119  0000 0111.\n\t    0,     0,  39,  // 120  0000 0001 0.\n\t    0,     0,  47,  // 121  0000 0011 0.\n\t    0,     0,  55,  // 122  0000 0010 1.\n\t    0,     0,  27,  // 123  0000 0001 1.\n\t    0,     0,  59,  // 124  0000 0010 0.\n\t    0,     0,  31   // 125  0000 0011 1.\n]);\n\nMPEG1.MOTION = new Int16Array([\n\t  1*3,   2*3,   0,  //   0\n\t  4*3,   3*3,   0,  //   1  0\n\t    0,     0,   0,  //   2  1.\n\t  6*3,   5*3,   0,  //   3  01\n\t  8*3,   7*3,   0,  //   4  00\n\t    0,     0,  -1,  //   5  011.\n\t    0,     0,   1,  //   6  010.\n\t  9*3,  10*3,   0,  //   7  001\n\t 12*3,  11*3,   0,  //   8  000\n\t    0,     0,   2,  //   9  0010.\n\t    0,     0,  -2,  //  10  0011.\n\t 14*3,  15*3,   0,  //  11  0001\n\t 16*3,  13*3,   0,  //  12  0000\n\t 20*3,  18*3,   0,  //  13  0000 1\n\t    0,     0,   3,  //  14  0001 0.\n\t    0,     0,  -3,  //  15  0001 1.\n\t 17*3,  19*3,   0,  //  16  0000 0\n\t   -1,  23*3,   0,  //  17  0000 00\n\t 27*3,  25*3,   0,  //  18  0000 11\n\t 26*3,  21*3,   0,  //  19  0000 01\n\t 24*3,  22*3,   0,  //  20  0000 10\n\t 32*3,  28*3,   0,  //  21  0000 011\n\t 29*3,  31*3,   0,  //  22  0000 101\n\t   -1,  33*3,   0,  //  23  0000 001\n\t 36*3,  35*3,   0,  //  24  0000 100\n\t    0,     0,  -4,  //  25  0000 111.\n\t 30*3,  34*3,   0,  //  26  0000 010\n\t    0,     0,   4,  //  27  0000 110.\n\t    0,     0,  -7,  //  28  0000 0111.\n\t    0,     0,   5,  //  29  0000 1010.\n\t 37*3,  41*3,   0,  //  30  0000 0100\n\t    0,     0,  -5,  //  31  0000 1011.\n\t    0,     0,   7,  //  32  0000 0110.\n\t 38*3,  40*3,   0,  //  33  0000 0011\n\t 42*3,  39*3,   0,  //  34  0000 0101\n\t    0,     0,  -6,  //  35  0000 1001.\n\t    0,     0,   6,  //  36  0000 1000.\n\t 51*3,  54*3,   0,  //  37  0000 0100 0\n\t 50*3,  49*3,   0,  //  38  0000 0011 0\n\t 45*3,  46*3,   0,  //  39  0000 0101 1\n\t 52*3,  47*3,   0,  //  40  0000 0011 1\n\t 43*3,  53*3,   0,  //  41  0000 0100 1\n\t 44*3,  48*3,   0,  //  42  0000 0101 0\n\t    0,     0,  10,  //  43  0000 0100 10.\n\t    0,     0,   9,  //  44  0000 0101 00.\n\t    0,     0,   8,  //  45  0000 0101 10.\n\t    0,     0,  -8,  //  46  0000 0101 11.\n\t 57*3,  66*3,   0,  //  47  0000 0011 11\n\t    0,     0,  -9,  //  48  0000 0101 01.\n\t 60*3,  64*3,   0,  //  49  0000 0011 01\n\t 56*3,  61*3,   0,  //  50  0000 0011 00\n\t 55*3,  62*3,   0,  //  51  0000 0100 00\n\t 58*3,  63*3,   0,  //  52  0000 0011 10\n\t    0,     0, -10,  //  53  0000 0100 11.\n\t 59*3,  65*3,   0,  //  54  0000 0100 01\n\t    0,     0,  12,  //  55  0000 0100 000.\n\t    0,     0,  16,  //  56  0000 0011 000.\n\t    0,     0,  13,  //  57  0000 0011 110.\n\t    0,     0,  14,  //  58  0000 0011 100.\n\t    0,     0,  11,  //  59  0000 0100 010.\n\t    0,     0,  15,  //  60  0000 0011 010.\n\t    0,     0, -16,  //  61  0000 0011 001.\n\t    0,     0, -12,  //  62  0000 0100 001.\n\t    0,     0, -14,  //  63  0000 0011 101.\n\t    0,     0, -15,  //  64  0000 0011 011.\n\t    0,     0, -11,  //  65  0000 0100 011.\n\t    0,     0, -13   //  66  0000 0011 111.\n]);\n\nMPEG1.DCT_DC_SIZE_LUMINANCE = new Int8Array([\n\t  2*3,   1*3, 0,  //   0\n\t  6*3,   5*3, 0,  //   1  1\n\t  3*3,   4*3, 0,  //   2  0\n\t    0,     0, 1,  //   3  00.\n\t    0,     0, 2,  //   4  01.\n\t  9*3,   8*3, 0,  //   5  11\n\t  7*3,  10*3, 0,  //   6  10\n\t    0,     0, 0,  //   7  100.\n\t 12*3,  11*3, 0,  //   8  111\n\t    0,     0, 4,  //   9  110.\n\t    0,     0, 3,  //  10  101.\n\t 13*3,  14*3, 0,  //  11  1111\n\t    0,     0, 5,  //  12  1110.\n\t    0,     0, 6,  //  13  1111 0.\n\t 16*3,  15*3, 0,  //  14  1111 1\n\t 17*3,    -1, 0,  //  15  1111 11\n\t    0,     0, 7,  //  16  1111 10.\n\t    0,     0, 8   //  17  1111 110.\n]);\n\nMPEG1.DCT_DC_SIZE_CHROMINANCE = new Int8Array([\n\t  2*3,   1*3, 0,  //   0\n\t  4*3,   3*3, 0,  //   1  1\n\t  6*3,   5*3, 0,  //   2  0\n\t  8*3,   7*3, 0,  //   3  11\n\t    0,     0, 2,  //   4  10.\n\t    0,     0, 1,  //   5  01.\n\t    0,     0, 0,  //   6  00.\n\t 10*3,   9*3, 0,  //   7  111\n\t    0,     0, 3,  //   8  110.\n\t 12*3,  11*3, 0,  //   9  1111\n\t    0,     0, 4,  //  10  1110.\n\t 14*3,  13*3, 0,  //  11  1111 1\n\t    0,     0, 5,  //  12  1111 0.\n\t 16*3,  15*3, 0,  //  13  1111 11\n\t    0,     0, 6,  //  14  1111 10.\n\t 17*3,    -1, 0,  //  15  1111 111\n\t    0,     0, 7,  //  16  1111 110.\n\t    0,     0, 8   //  17  1111 1110.\n]);\n\n//  dct_coeff bitmap:\n//    0xff00  run\n//    0x00ff  level\n\n//  Decoded values are unsigned. Sign bit follows in the stream.\n\n//  Interpretation of the value 0x0001\n//    for dc_coeff_first:  run=0, level=1\n//    for dc_coeff_next:   If the next bit is 1: run=0, level=1\n//                         If the next bit is 0: end_of_block\n\n//  escape decodes as 0xffff.\n\nMPEG1.DCT_COEFF = new Int32Array([\n\t  1*3,   2*3,      0,  //   0\n\t  4*3,   3*3,      0,  //   1  0\n\t    0,     0, 0x0001,  //   2  1.\n\t  7*3,   8*3,      0,  //   3  01\n\t  6*3,   5*3,      0,  //   4  00\n\t 13*3,   9*3,      0,  //   5  001\n\t 11*3,  10*3,      0,  //   6  000\n\t 14*3,  12*3,      0,  //   7  010\n\t    0,     0, 0x0101,  //   8  011.\n\t 20*3,  22*3,      0,  //   9  0011\n\t 18*3,  21*3,      0,  //  10  0001\n\t 16*3,  19*3,      0,  //  11  0000\n\t    0,     0, 0x0201,  //  12  0101.\n\t 17*3,  15*3,      0,  //  13  0010\n\t    0,     0, 0x0002,  //  14  0100.\n\t    0,     0, 0x0003,  //  15  0010 1.\n\t 27*3,  25*3,      0,  //  16  0000 0\n\t 29*3,  31*3,      0,  //  17  0010 0\n\t 24*3,  26*3,      0,  //  18  0001 0\n\t 32*3,  30*3,      0,  //  19  0000 1\n\t    0,     0, 0x0401,  //  20  0011 0.\n\t 23*3,  28*3,      0,  //  21  0001 1\n\t    0,     0, 0x0301,  //  22  0011 1.\n\t    0,     0, 0x0102,  //  23  0001 10.\n\t    0,     0, 0x0701,  //  24  0001 00.\n\t    0,     0, 0xffff,  //  25  0000 01. -- escape\n\t    0,     0, 0x0601,  //  26  0001 01.\n\t 37*3,  36*3,      0,  //  27  0000 00\n\t    0,     0, 0x0501,  //  28  0001 11.\n\t 35*3,  34*3,      0,  //  29  0010 00\n\t 39*3,  38*3,      0,  //  30  0000 11\n\t 33*3,  42*3,      0,  //  31  0010 01\n\t 40*3,  41*3,      0,  //  32  0000 10\n\t 52*3,  50*3,      0,  //  33  0010 010\n\t 54*3,  53*3,      0,  //  34  0010 001\n\t 48*3,  49*3,      0,  //  35  0010 000\n\t 43*3,  45*3,      0,  //  36  0000 001\n\t 46*3,  44*3,      0,  //  37  0000 000\n\t    0,     0, 0x0801,  //  38  0000 111.\n\t    0,     0, 0x0004,  //  39  0000 110.\n\t    0,     0, 0x0202,  //  40  0000 100.\n\t    0,     0, 0x0901,  //  41  0000 101.\n\t 51*3,  47*3,      0,  //  42  0010 011\n\t 55*3,  57*3,      0,  //  43  0000 0010\n\t 60*3,  56*3,      0,  //  44  0000 0001\n\t 59*3,  58*3,      0,  //  45  0000 0011\n\t 61*3,  62*3,      0,  //  46  0000 0000\n\t    0,     0, 0x0a01,  //  47  0010 0111.\n\t    0,     0, 0x0d01,  //  48  0010 0000.\n\t    0,     0, 0x0006,  //  49  0010 0001.\n\t    0,     0, 0x0103,  //  50  0010 0101.\n\t    0,     0, 0x0005,  //  51  0010 0110.\n\t    0,     0, 0x0302,  //  52  0010 0100.\n\t    0,     0, 0x0b01,  //  53  0010 0011.\n\t    0,     0, 0x0c01,  //  54  0010 0010.\n\t 76*3,  75*3,      0,  //  55  0000 0010 0\n\t 67*3,  70*3,      0,  //  56  0000 0001 1\n\t 73*3,  71*3,      0,  //  57  0000 0010 1\n\t 78*3,  74*3,      0,  //  58  0000 0011 1\n\t 72*3,  77*3,      0,  //  59  0000 0011 0\n\t 69*3,  64*3,      0,  //  60  0000 0001 0\n\t 68*3,  63*3,      0,  //  61  0000 0000 0\n\t 66*3,  65*3,      0,  //  62  0000 0000 1\n\t 81*3,  87*3,      0,  //  63  0000 0000 01\n\t 91*3,  80*3,      0,  //  64  0000 0001 01\n\t 82*3,  79*3,      0,  //  65  0000 0000 11\n\t 83*3,  86*3,      0,  //  66  0000 0000 10\n\t 93*3,  92*3,      0,  //  67  0000 0001 10\n\t 84*3,  85*3,      0,  //  68  0000 0000 00\n\t 90*3,  94*3,      0,  //  69  0000 0001 00\n\t 88*3,  89*3,      0,  //  70  0000 0001 11\n\t    0,     0, 0x0203,  //  71  0000 0010 11.\n\t    0,     0, 0x0104,  //  72  0000 0011 00.\n\t    0,     0, 0x0007,  //  73  0000 0010 10.\n\t    0,     0, 0x0402,  //  74  0000 0011 11.\n\t    0,     0, 0x0502,  //  75  0000 0010 01.\n\t    0,     0, 0x1001,  //  76  0000 0010 00.\n\t    0,     0, 0x0f01,  //  77  0000 0011 01.\n\t    0,     0, 0x0e01,  //  78  0000 0011 10.\n\t105*3, 107*3,      0,  //  79  0000 0000 111\n\t111*3, 114*3,      0,  //  80  0000 0001 011\n\t104*3,  97*3,      0,  //  81  0000 0000 010\n\t125*3, 119*3,      0,  //  82  0000 0000 110\n\t 96*3,  98*3,      0,  //  83  0000 0000 100\n\t   -1, 123*3,      0,  //  84  0000 0000 000\n\t 95*3, 101*3,      0,  //  85  0000 0000 001\n\t106*3, 121*3,      0,  //  86  0000 0000 101\n\t 99*3, 102*3,      0,  //  87  0000 0000 011\n\t113*3, 103*3,      0,  //  88  0000 0001 110\n\t112*3, 116*3,      0,  //  89  0000 0001 111\n\t110*3, 100*3,      0,  //  90  0000 0001 000\n\t124*3, 115*3,      0,  //  91  0000 0001 010\n\t117*3, 122*3,      0,  //  92  0000 0001 101\n\t109*3, 118*3,      0,  //  93  0000 0001 100\n\t120*3, 108*3,      0,  //  94  0000 0001 001\n\t127*3, 136*3,      0,  //  95  0000 0000 0010\n\t139*3, 140*3,      0,  //  96  0000 0000 1000\n\t130*3, 126*3,      0,  //  97  0000 0000 0101\n\t145*3, 146*3,      0,  //  98  0000 0000 1001\n\t128*3, 129*3,      0,  //  99  0000 0000 0110\n\t    0,     0, 0x0802,  // 100  0000 0001 0001.\n\t132*3, 134*3,      0,  // 101  0000 0000 0011\n\t155*3, 154*3,      0,  // 102  0000 0000 0111\n\t    0,     0, 0x0008,  // 103  0000 0001 1101.\n\t137*3, 133*3,      0,  // 104  0000 0000 0100\n\t143*3, 144*3,      0,  // 105  0000 0000 1110\n\t151*3, 138*3,      0,  // 106  0000 0000 1010\n\t142*3, 141*3,      0,  // 107  0000 0000 1111\n\t    0,     0, 0x000a,  // 108  0000 0001 0011.\n\t    0,     0, 0x0009,  // 109  0000 0001 1000.\n\t    0,     0, 0x000b,  // 110  0000 0001 0000.\n\t    0,     0, 0x1501,  // 111  0000 0001 0110.\n\t    0,     0, 0x0602,  // 112  0000 0001 1110.\n\t    0,     0, 0x0303,  // 113  0000 0001 1100.\n\t    0,     0, 0x1401,  // 114  0000 0001 0111.\n\t    0,     0, 0x0702,  // 115  0000 0001 0101.\n\t    0,     0, 0x1101,  // 116  0000 0001 1111.\n\t    0,     0, 0x1201,  // 117  0000 0001 1010.\n\t    0,     0, 0x1301,  // 118  0000 0001 1001.\n\t148*3, 152*3,      0,  // 119  0000 0000 1101\n\t    0,     0, 0x0403,  // 120  0000 0001 0010.\n\t153*3, 150*3,      0,  // 121  0000 0000 1011\n\t    0,     0, 0x0105,  // 122  0000 0001 1011.\n\t131*3, 135*3,      0,  // 123  0000 0000 0001\n\t    0,     0, 0x0204,  // 124  0000 0001 0100.\n\t149*3, 147*3,      0,  // 125  0000 0000 1100\n\t172*3, 173*3,      0,  // 126  0000 0000 0101 1\n\t162*3, 158*3,      0,  // 127  0000 0000 0010 0\n\t170*3, 161*3,      0,  // 128  0000 0000 0110 0\n\t168*3, 166*3,      0,  // 129  0000 0000 0110 1\n\t157*3, 179*3,      0,  // 130  0000 0000 0101 0\n\t169*3, 167*3,      0,  // 131  0000 0000 0001 0\n\t174*3, 171*3,      0,  // 132  0000 0000 0011 0\n\t178*3, 177*3,      0,  // 133  0000 0000 0100 1\n\t156*3, 159*3,      0,  // 134  0000 0000 0011 1\n\t164*3, 165*3,      0,  // 135  0000 0000 0001 1\n\t183*3, 182*3,      0,  // 136  0000 0000 0010 1\n\t175*3, 176*3,      0,  // 137  0000 0000 0100 0\n\t    0,     0, 0x0107,  // 138  0000 0000 1010 1.\n\t    0,     0, 0x0a02,  // 139  0000 0000 1000 0.\n\t    0,     0, 0x0902,  // 140  0000 0000 1000 1.\n\t    0,     0, 0x1601,  // 141  0000 0000 1111 1.\n\t    0,     0, 0x1701,  // 142  0000 0000 1111 0.\n\t    0,     0, 0x1901,  // 143  0000 0000 1110 0.\n\t    0,     0, 0x1801,  // 144  0000 0000 1110 1.\n\t    0,     0, 0x0503,  // 145  0000 0000 1001 0.\n\t    0,     0, 0x0304,  // 146  0000 0000 1001 1.\n\t    0,     0, 0x000d,  // 147  0000 0000 1100 1.\n\t    0,     0, 0x000c,  // 148  0000 0000 1101 0.\n\t    0,     0, 0x000e,  // 149  0000 0000 1100 0.\n\t    0,     0, 0x000f,  // 150  0000 0000 1011 1.\n\t    0,     0, 0x0205,  // 151  0000 0000 1010 0.\n\t    0,     0, 0x1a01,  // 152  0000 0000 1101 1.\n\t    0,     0, 0x0106,  // 153  0000 0000 1011 0.\n\t180*3, 181*3,      0,  // 154  0000 0000 0111 1\n\t160*3, 163*3,      0,  // 155  0000 0000 0111 0\n\t196*3, 199*3,      0,  // 156  0000 0000 0011 10\n\t    0,     0, 0x001b,  // 157  0000 0000 0101 00.\n\t203*3, 185*3,      0,  // 158  0000 0000 0010 01\n\t202*3, 201*3,      0,  // 159  0000 0000 0011 11\n\t    0,     0, 0x0013,  // 160  0000 0000 0111 00.\n\t    0,     0, 0x0016,  // 161  0000 0000 0110 01.\n\t197*3, 207*3,      0,  // 162  0000 0000 0010 00\n\t    0,     0, 0x0012,  // 163  0000 0000 0111 01.\n\t191*3, 192*3,      0,  // 164  0000 0000 0001 10\n\t188*3, 190*3,      0,  // 165  0000 0000 0001 11\n\t    0,     0, 0x0014,  // 166  0000 0000 0110 11.\n\t184*3, 194*3,      0,  // 167  0000 0000 0001 01\n\t    0,     0, 0x0015,  // 168  0000 0000 0110 10.\n\t186*3, 193*3,      0,  // 169  0000 0000 0001 00\n\t    0,     0, 0x0017,  // 170  0000 0000 0110 00.\n\t204*3, 198*3,      0,  // 171  0000 0000 0011 01\n\t    0,     0, 0x0019,  // 172  0000 0000 0101 10.\n\t    0,     0, 0x0018,  // 173  0000 0000 0101 11.\n\t200*3, 205*3,      0,  // 174  0000 0000 0011 00\n\t    0,     0, 0x001f,  // 175  0000 0000 0100 00.\n\t    0,     0, 0x001e,  // 176  0000 0000 0100 01.\n\t    0,     0, 0x001c,  // 177  0000 0000 0100 11.\n\t    0,     0, 0x001d,  // 178  0000 0000 0100 10.\n\t    0,     0, 0x001a,  // 179  0000 0000 0101 01.\n\t    0,     0, 0x0011,  // 180  0000 0000 0111 10.\n\t    0,     0, 0x0010,  // 181  0000 0000 0111 11.\n\t189*3, 206*3,      0,  // 182  0000 0000 0010 11\n\t187*3, 195*3,      0,  // 183  0000 0000 0010 10\n\t218*3, 211*3,      0,  // 184  0000 0000 0001 010\n\t    0,     0, 0x0025,  // 185  0000 0000 0010 011.\n\t215*3, 216*3,      0,  // 186  0000 0000 0001 000\n\t    0,     0, 0x0024,  // 187  0000 0000 0010 100.\n\t210*3, 212*3,      0,  // 188  0000 0000 0001 110\n\t    0,     0, 0x0022,  // 189  0000 0000 0010 110.\n\t213*3, 209*3,      0,  // 190  0000 0000 0001 111\n\t221*3, 222*3,      0,  // 191  0000 0000 0001 100\n\t219*3, 208*3,      0,  // 192  0000 0000 0001 101\n\t217*3, 214*3,      0,  // 193  0000 0000 0001 001\n\t223*3, 220*3,      0,  // 194  0000 0000 0001 011\n\t    0,     0, 0x0023,  // 195  0000 0000 0010 101.\n\t    0,     0, 0x010b,  // 196  0000 0000 0011 100.\n\t    0,     0, 0x0028,  // 197  0000 0000 0010 000.\n\t    0,     0, 0x010c,  // 198  0000 0000 0011 011.\n\t    0,     0, 0x010a,  // 199  0000 0000 0011 101.\n\t    0,     0, 0x0020,  // 200  0000 0000 0011 000.\n\t    0,     0, 0x0108,  // 201  0000 0000 0011 111.\n\t    0,     0, 0x0109,  // 202  0000 0000 0011 110.\n\t    0,     0, 0x0026,  // 203  0000 0000 0010 010.\n\t    0,     0, 0x010d,  // 204  0000 0000 0011 010.\n\t    0,     0, 0x010e,  // 205  0000 0000 0011 001.\n\t    0,     0, 0x0021,  // 206  0000 0000 0010 111.\n\t    0,     0, 0x0027,  // 207  0000 0000 0010 001.\n\t    0,     0, 0x1f01,  // 208  0000 0000 0001 1011.\n\t    0,     0, 0x1b01,  // 209  0000 0000 0001 1111.\n\t    0,     0, 0x1e01,  // 210  0000 0000 0001 1100.\n\t    0,     0, 0x1002,  // 211  0000 0000 0001 0101.\n\t    0,     0, 0x1d01,  // 212  0000 0000 0001 1101.\n\t    0,     0, 0x1c01,  // 213  0000 0000 0001 1110.\n\t    0,     0, 0x010f,  // 214  0000 0000 0001 0011.\n\t    0,     0, 0x0112,  // 215  0000 0000 0001 0000.\n\t    0,     0, 0x0111,  // 216  0000 0000 0001 0001.\n\t    0,     0, 0x0110,  // 217  0000 0000 0001 0010.\n\t    0,     0, 0x0603,  // 218  0000 0000 0001 0100.\n\t    0,     0, 0x0b02,  // 219  0000 0000 0001 1010.\n\t    0,     0, 0x0e02,  // 220  0000 0000 0001 0111.\n\t    0,     0, 0x0d02,  // 221  0000 0000 0001 1000.\n\t    0,     0, 0x0c02,  // 222  0000 0000 0001 1001.\n\t    0,     0, 0x0f02   // 223  0000 0000 0001 0110.\n]);\n\nMPEG1.PICTURE_TYPE = {\n\tINTRA: 1,\n\tPREDICTIVE: 2,\n\tB: 3\n};\n\nMPEG1.START = {\n\tSEQUENCE: 0xB3,\n\tSLICE_FIRST: 0x01,\n\tSLICE_LAST: 0xAF,\n\tPICTURE: 0x00,\n\tEXTENSION: 0xB5,\n\tUSER_DATA: 0xB2\n};\n\nmodule.exports = MPEG1;\n","const JSMpeg = require(\"./jsmpeg\");\n\nvar Player = function(url, options) {\n\tthis.options = options || {};\n\n\tif (options.source) {\n\t\tthis.source = new options.source(url, options);\n\t\toptions.streaming = !!this.source.streaming;\n\t}\n\telse if (url.match(/^wss?:\\/\\//)) {\n\t\tthis.source = new JSMpeg.Source.WebSocket(url, options);\n\t\toptions.streaming = true;\n\t}\n\telse if (options.progressive !== false) {\n\t\tthis.source = new JSMpeg.Source.AjaxProgressive(url, options);\n\t\toptions.streaming = false;\n\t}\n\telse {\n\t\tthis.source = new JSMpeg.Source.Ajax(url, options);\n\t\toptions.streaming = false;\n\t}\n\n\tthis.maxAudioLag = options.maxAudioLag || 0.25;\n\tthis.loop = options.loop !== false;\n\tthis.autoplay = !!options.autoplay || options.streaming;\n\n\tthis.demuxer = new JSMpeg.Demuxer.TS(options);\n\tthis.source.connect(this.demuxer);\n\n\tif (options.video !== false) {\n\t\tthis.video = new JSMpeg.Decoder.MPEG1Video(options);\n\t\tthis.renderer = !options.disableGl && JSMpeg.Renderer.WebGL.IsSupported()\n\t\t\t? new JSMpeg.Renderer.WebGL(options)\n\t\t\t: new JSMpeg.Renderer.Canvas2D(options);\n\t\tthis.demuxer.connect(JSMpeg.Demuxer.TS.STREAM.VIDEO_1, this.video);\n\t\tthis.video.connect(this.renderer);\n\t}\n\n\tif (options.audio !== false && JSMpeg.AudioOutput.WebAudio.IsSupported()) {\n\t\tthis.audio = new JSMpeg.Decoder.MP2Audio(options);\n\t\tthis.audioOut = new JSMpeg.AudioOutput.WebAudio(options);\n\t\tthis.demuxer.connect(JSMpeg.Demuxer.TS.STREAM.AUDIO_1, this.audio);\n\t\tthis.audio.connect(this.audioOut);\n\t}\n\n\tObject.defineProperty(this, 'currentTime', {\n\t\tget: this.getCurrentTime,\n\t\tset: this.setCurrentTime\n\t});\n\tObject.defineProperty(this, 'volume', {\n\t\tget: this.getVolume,\n\t\tset: this.setVolume\n\t});\n\n\tthis.unpauseOnShow = false;\n\tif (options.pauseWhenHidden !== false) {\n\t\tdocument.addEventListener('visibilitychange', this.showHide.bind(this));\n\t}\n\n\tthis.source.start();\n\n\tif (this.autoplay) {\n\t\tthis.play();\n\t}\n};\n\nPlayer.prototype.showHide = function(ev) {\n\tif (document.visibilityState === 'hidden') {\n\t\tthis.unpauseOnShow = this.wantsToPlay;\n\t\tthis.pause();\n\t}\n\telse if (this.unpauseOnShow) {\n\t\tthis.play();\n\t}\n};\n\nPlayer.prototype.play = function(ev) {\n\tthis.animationId = requestAnimationFrame(this.update.bind(this));\n\tthis.wantsToPlay = true;\n};\n\nPlayer.prototype.pause = function(ev) {\n\tcancelAnimationFrame(this.animationId);\n\tthis.wantsToPlay = false;\n\tthis.isPlaying = false;\n\n\tif (this.audio && this.audio.canPlay) {\n\t\t// Seek to the currentTime again - audio may already be enqueued a bit\n\t\t// further, so we have to rewind it.\n\t\tthis.audioOut.stop();\n\t\tthis.seek(this.currentTime);\n\t}\n};\n\nPlayer.prototype.getVolume = function() {\n\treturn this.audioOut ? this.audioOut.volume : 0;\n};\n\nPlayer.prototype.setVolume = function(volume) {\n\tif (this.audioOut) {\n\t\tthis.audioOut.volume = volume;\n\t}\n};\n\nPlayer.prototype.stop = function(ev) {\n\tthis.pause();\n\tthis.seek(0);\n\tif (this.video && this.options.decodeFirstFrame !== false) {\n\t\tthis.video.decode();\n\t}\n};\n\nPlayer.prototype.destroy = function() {\n\tthis.pause();\n\tif (this.source) this.source.destroy();\n\tif (this.renderer) this.renderer.destroy();\n\tif (this.audioOut) this.audioOut.destroy();\n};\n\nPlayer.prototype.seek = function(time) {\n\tvar startOffset = this.audio && this.audio.canPlay\n\t\t? this.audio.startTime\n\t\t: this.video.startTime;\n\n\tif (this.video) {\n\t\tthis.video.seek(time + startOffset);\n\t}\n\tif (this.audio) {\n\t\tthis.audio.seek(time + startOffset);\n\t}\n\n\tthis.startTime = JSMpeg.Now() - time;\n};\n\nPlayer.prototype.getCurrentTime = function() {\n\treturn this.audio && this.audio.canPlay\n\t\t? this.audio.currentTime - this.audio.startTime\n\t\t: this.video.currentTime - this.video.startTime;\n};\n\nPlayer.prototype.setCurrentTime = function(time) {\n\tthis.seek(time);\n};\n\nPlayer.prototype.update = function() {\n\tthis.animationId = requestAnimationFrame(this.update.bind(this));\n\n\tif (!this.source.established) {\n\t\tif (this.renderer) {\n\t\t\tthis.renderer.renderProgress(this.source.progress);\n\t\t}\n\t\treturn;\n\t}\n\n\tif (!this.isPlaying) {\n\t\tthis.isPlaying = true;\n\t\tthis.startTime = JSMpeg.Now() - this.currentTime;\n\t}\n\n\tif (this.options.streaming) {\n\t\tthis.updateForStreaming();\n\t}\n\telse {\n\t\tthis.updateForStaticFile();\n\t}\n};\n\nPlayer.prototype.updateForStreaming = function() {\n\t// When streaming, immediately decode everything we have buffered up until\n\t// now to minimize playback latency.\n\n\tif (this.video) {\n\t\tthis.video.decode();\n\t}\n\n\tif (this.audio) {\n\t\tvar decoded = false;\n\t\tdo {\n\t\t\t// If there's a lot of audio enqueued already, disable output and\n\t\t\t// catch up with the encoding.\n\t\t\tif (this.audioOut.enqueuedTime > this.maxAudioLag) {\n\t\t\t\tthis.audioOut.resetEnqueuedTime();\n\t\t\t\tthis.audioOut.enabled = false;\n\t\t\t}\n\t\t\tdecoded = this.audio.decode();\n\t\t} while (decoded);\n\t\tthis.audioOut.enabled = true;\n\t}\n};\n\nPlayer.prototype.updateForStaticFile = function() {\n\tvar notEnoughData = false,\n\t\theadroom = 0;\n\n\t// If we have an audio track, we always try to sync the video to the audio.\n\t// Gaps and discontinuities are far more percetable in audio than in video.\n\n\tif (this.audio && this.audio.canPlay) {\n\t\t// Do we have to decode and enqueue some more audio data?\n\t\twhile (\n\t\t\t!notEnoughData &&\n\t\t\tthis.audio.decodedTime - this.audio.currentTime < 0.25\n\t\t) {\n\t\t\tnotEnoughData = !this.audio.decode();\n\t\t}\n\n\t\t// Sync video to audio\n\t\tif (this.video && this.video.currentTime < this.audio.currentTime) {\n\t\t\tnotEnoughData = !this.video.decode();\n\t\t}\n\n\t\theadroom = this.demuxer.currentTime - this.audio.currentTime;\n\t}\n\n\n\telse if (this.video) {\n\t\t// Video only - sync it to player's wallclock\n\t\tvar targetTime = (JSMpeg.Now() - this.startTime) + this.video.startTime,\n\t\t\tlateTime = targetTime - this.video.currentTime,\n\t\t\tframeTime = 1/this.video.frameRate;\n\n\t\tif (this.video && lateTime > 0) {\n\t\t\t// If the video is too far behind (>2 frames), simply reset the\n\t\t\t// target time to the next frame instead of trying to catch up.\n\t\t\tif (lateTime > frameTime * 2) {\n\t\t\t\tthis.startTime += lateTime;\n\t\t\t}\n\n\t\t\tnotEnoughData = !this.video.decode();\n\t\t}\n\n\t\theadroom = this.demuxer.currentTime - targetTime;\n\t}\n\n\t// Notify the source of the playhead headroom, so it can decide whether to\n\t// continue loading further data.\n\tthis.source.resume(headroom);\n\n\t// If we failed to decode and the source is complete, it means we reached\n\t// the end of our data. We may want to loop.\n\tif (notEnoughData && this.source.completed) {\n\t\tif (this.loop) {\n\t\t\tthis.seek(0);\n\t\t}\n\t\telse {\n\t\t\tthis.pause();\n\t\t}\n\t}\n};\n\nmodule.exports = Player;\n","const JSMpeg = require(\"./jsmpeg\");\n\nvar TS = function(options) {\n\tthis.bits = null;\n\tthis.leftoverBytes = null;\n\n\tthis.guessVideoFrameEnd = true;\n\tthis.pidsToStreamIds = {};\n\n\tthis.pesPacketInfo = {};\n\tthis.startTime = 0;\n\tthis.currentTime = 0;\n};\n\nTS.prototype.connect = function(streamId, destination) {\n\tthis.pesPacketInfo[streamId] = {\n\t\tdestination: destination,\n\t\tcurrentLength: 0,\n\t\ttotalLength: 0,\n\t\tpts: 0,\n\t\tbuffers: []\n\t};\n};\n\nTS.prototype.write = function(buffer) {\n\tif (this.leftoverBytes) {\n\t\tvar totalLength = buffer.byteLength + this.leftoverBytes.byteLength;\n\t\tthis.bits = new JSMpeg.BitBuffer(totalLength);\n\t\tthis.bits.write([this.leftoverBytes, buffer]);\n\t}\n\telse {\n\t\tthis.bits = new JSMpeg.BitBuffer(buffer);\n\t}\n\n\twhile (this.bits.has(188 << 3) && this.parsePacket()) {}\n\n\tvar leftoverCount = this.bits.byteLength - (this.bits.index >> 3);\n\tthis.leftoverBytes = leftoverCount > 0\n\t\t? this.bits.bytes.subarray(this.bits.index >> 3)\n\t\t: null;\n};\n\nTS.prototype.parsePacket = function() {\n\t// Check if we're in sync with packet boundaries; attempt to resync if not.\n\tif (this.bits.read(8) !== 0x47) {\n\t\tif (!this.resync()) {\n\t\t\t// Couldn't resync; maybe next time...\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tvar end = (this.bits.index >> 3) + 187;\n\tvar transportError = this.bits.read(1),\n\t\tpayloadStart = this.bits.read(1),\n\t\ttransportPriority = this.bits.read(1),\n\t\tpid = this.bits.read(13),\n\t\ttransportScrambling = this.bits.read(2),\n\t\tadaptationField = this.bits.read(2),\n\t\tcontinuityCounter = this.bits.read(4);\n\n\n\t// If this is the start of a new payload; signal the end of the previous\n\t// frame, if we didn't do so already.\n\tvar streamId = this.pidsToStreamIds[pid];\n\tif (payloadStart && streamId) {\n\t\tvar pi = this.pesPacketInfo[streamId];\n\t\tif (pi && pi.currentLength) {\n\t\t\tthis.packetComplete(pi);\n\t\t}\n\t}\n\n\t// Extract current payload\n\tif (adaptationField & 0x1) {\n\t\tif ((adaptationField & 0x2)) {\n\t\t\tvar adaptationFieldLength = this.bits.read(8);\n\t\t\tthis.bits.skip(adaptationFieldLength << 3);\n\t\t}\n\n\t\tif (payloadStart && this.bits.nextBytesAreStartCode()) {\n\t\t\tthis.bits.skip(24);\n\t\t\tstreamId = this.bits.read(8);\n\t\t\tthis.pidsToStreamIds[pid] = streamId;\n\n\t\t\tvar packetLength = this.bits.read(16)\n\t\t\tthis.bits.skip(8);\n\t\t\tvar ptsDtsFlag = this.bits.read(2);\n\t\t\tthis.bits.skip(6);\n\t\t\tvar headerLength = this.bits.read(8);\n\t\t\tvar payloadBeginIndex = this.bits.index + (headerLength << 3);\n\n\t\t\tvar pi = this.pesPacketInfo[streamId];\n\t\t\tif (pi) {\n\t\t\t\tvar pts = 0;\n\t\t\t\tif (ptsDtsFlag & 0x2) {\n\t\t\t\t\t// The Presentation Timestamp is encoded as 33(!) bit\n\t\t\t\t\t// integer, but has a \"marker bit\" inserted at weird places\n\t\t\t\t\t// in between, making the whole thing 5 bytes in size.\n\t\t\t\t\t// You can't make this shit up...\n\t\t\t\t\tthis.bits.skip(4);\n\t\t\t\t\tvar p32_30 = this.bits.read(3);\n\t\t\t\t\tthis.bits.skip(1);\n\t\t\t\t\tvar p29_15 = this.bits.read(15);\n\t\t\t\t\tthis.bits.skip(1);\n\t\t\t\t\tvar p14_0 = this.bits.read(15);\n\t\t\t\t\tthis.bits.skip(1);\n\n\t\t\t\t\t// Can't use bit shifts here; we need 33 bits of precision,\n\t\t\t\t\t// so we're using JavaScript's double number type. Also\n\t\t\t\t\t// divide by the 90khz clock to get the pts in seconds.\n\t\t\t\t\tpts = (p32_30 * 1073741824 + p29_15 * 32768 + p14_0)/90000;\n\n\t\t\t\t\tthis.currentTime = pts;\n\t\t\t\t\tif (this.startTime === -1) {\n\t\t\t\t\t\tthis.startTime = pts;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar payloadLength = packetLength\n\t\t\t\t\t? packetLength - headerLength - 3\n\t\t\t\t\t: 0;\n\t\t\t\tthis.packetStart(pi, pts, payloadLength);\n\t\t\t}\n\n\t\t\t// Skip the rest of the header without parsing it\n\t\t\tthis.bits.index = payloadBeginIndex;\n\t\t}\n\n\t\tif (streamId) {\n\t\t\t// Attempt to detect if the PES packet is complete. For Audio (and\n\t\t\t// other) packets, we received a total packet length with the PES\n\t\t\t// header, so we can check the current length.\n\n\t\t\t// For Video packets, we have to guess the end by detecting if this\n\t\t\t// TS packet was padded - there's no good reason to pad a TS packet\n\t\t\t// in between, but it might just fit exactly. If this fails, we can\n\t\t\t// only wait for the next PES header for that stream.\n\n\t\t\tvar pi = this.pesPacketInfo[streamId];\n\t\t\tif (pi) {\n\t\t\t\tvar start = this.bits.index >> 3;\n\t\t\t\tvar complete = this.packetAddData(pi, start, end);\n\n\t\t\t\tvar hasPadding = !payloadStart && (adaptationField & 0x2);\n\t\t\t\tif (complete || (this.guessVideoFrameEnd && hasPadding)) {\n\t\t\t\t\tthis.packetComplete(pi);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tthis.bits.index = end << 3;\n\treturn true;\n};\n\nTS.prototype.resync = function() {\n\t// Check if we have enough data to attempt a resync. We need 5 full packets.\n\tif (!this.bits.has((188 * 6) << 3)) {\n\t\treturn false;\n\t}\n\n\tvar byteIndex = this.bits.index >> 3;\n\n\t// Look for the first sync token in the first 187 bytes\n\tfor (var i = 0; i < 187; i++) {\n\t\tif (this.bits.bytes[byteIndex + i] === 0x47) {\n\n\t\t\t// Look for 4 more sync tokens, each 188 bytes appart\n\t\t\tvar foundSync = true;\n\t\t\tfor (var j = 1; j < 5; j++) {\n\t\t\t\tif (this.bits.bytes[byteIndex + i + 188 * j] !== 0x47) {\n\t\t\t\t\tfoundSync = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (foundSync) {\n\t\t\t\tthis.bits.index = (byteIndex + i + 1) << 3;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\n\t// In theory, we shouldn't arrive here. If we do, we had enough data but\n\t// still didn't find sync - this can only happen if we were fed garbage\n\t// data. Check your source!\n\tconsole.warn('JSMpeg: Possible garbage data. Skipping.');\n\tthis.bits.skip(187 << 3);\n\treturn false;\n};\n\nTS.prototype.packetStart = function(pi, pts, payloadLength) {\n\tpi.totalLength = payloadLength;\n\tpi.currentLength = 0;\n\tpi.pts = pts;\n};\n\nTS.prototype.packetAddData = function(pi, start, end) {\n\tpi.buffers.push(this.bits.bytes.subarray(start, end));\n\tpi.currentLength += end - start;\n\n\tvar complete = (pi.totalLength !== 0 && pi.currentLength >= pi.totalLength);\n\treturn complete;\n};\n\nTS.prototype.packetComplete = function(pi) {\n\tpi.destination.write(pi.pts, pi.buffers);\n\tpi.totalLength = 0;\n\tpi.currentLength = 0;\n\tpi.buffers = [];\n};\n\nTS.STREAM = {\n\tPACK_HEADER: 0xBA,\n\tSYSTEM_HEADER: 0xBB,\n\tPROGRAM_MAP: 0xBC,\n\tPRIVATE_1: 0xBD,\n\tPADDING: 0xBE,\n\tPRIVATE_2: 0xBF,\n\tAUDIO_1: 0xC0,\n\tVIDEO_1: 0xE0,\n\tDIRECTORY: 0xFF\n};\n\nmodule.exports = TS;\n","const JSMpeg = require(\"./jsmpeg\");\n\nvar VideoElement = function(element) {\n\tvar url = element.dataset.url;\n\n\tif (!url) {\n\t\tthrow (\"VideoElement has no `data-url` attribute\");\n\t}\n\n\t// Setup the div container, canvas and play button\n\tvar addStyles = function(element, styles) {\n\t\tfor (var name in styles) {\n\t\t\telement.style[name] = styles[name];\n\t\t}\n\t};\n\n\tthis.container = element;\n\taddStyles(this.container, {\n\t\tdisplay: 'inline-block',\n\t\tposition: 'relative',\n\t\tminWidth: '80px', minHeight: '80px'\n\t});\n\n\tthis.canvas = document.createElement('canvas');\n\tthis.canvas.width = 960;\n\tthis.canvas.height = 540;\n\taddStyles(this.canvas, {\n\t\tdisplay: 'block',\n\t\twidth: '100%'\n\t});\n\tthis.container.appendChild(this.canvas);\n\n\tthis.playButton = document.createElement('div');\n\tthis.playButton.innerHTML = VideoElement.PLAY_BUTTON;\n\taddStyles(this.playButton, {\n\t\tzIndex: 2, position: 'absolute',\n\t\ttop: '0', bottom: '0', left: '0', right: '0',\n\t\tmaxWidth: '75px', maxHeight: '75px',\n\t\tmargin: 'auto',\n\t\topacity: '0.7',\n\t\tcursor: 'pointer'\n\t});\n\tthis.container.appendChild(this.playButton);\n\n\t// Parse the data-options - we try to decode the values as json. This way\n\t// we can get proper boolean and number values. If JSON.parse() fails,\n\t// treat it as a string.\n\tvar options = {canvas: this.canvas};\n\tfor (var option in element.dataset) {\n\t\ttry {\n\t\t\toptions[option] = JSON.parse(element.dataset[option]);\n\t\t}\n\t\tcatch(err) {\n\t\t\toptions[option] = element.dataset[option];\n\t\t}\n\t}\n\n\t// Create the player instance\n\tthis.player = new JSMpeg.Player(url, options);\n\telement.playerInstance = this.player;\n\n\t// Setup the poster element, if any\n\tif (options.poster && !options.autoplay && !this.player.options.streaming) {\n\t\toptions.decodeFirstFrame = false;\n\t\tthis.poster = new Image();\n\t\tthis.poster.src = options.poster;\n\t\tthis.poster.addEventListener('load', this.posterLoaded)\n\t\taddStyles(this.poster, {\n\t\t\tdisplay: 'block', zIndex: 1, position: 'absolute',\n\t\t\ttop: 0, left: 0, bottom: 0, right: 0\n\t\t});\n\t\tthis.container.appendChild(this.poster);\n\t}\n\n\t// Add the click handler if this video is pausable\n\tif (!this.player.options.streaming) {\n\t\tthis.container.addEventListener('click', this.onClick.bind(this));\n\t}\n\n\t// Hide the play button if this video immediately begins playing\n\tif (options.autoplay || this.player.options.streaming) {\n\t\tthis.playButton.style.display = 'none';\n\t}\n\n\t// Set up the unlock audio buton for iOS devices. iOS only allows us to\n\t// play audio after a user action has initiated playing. For autoplay or\n\t// streaming players we set up a muted speaker icon as the button. For all\n\t// others, we can simply use the play button.\n\tif (this.player.audioOut && !this.player.audioOut.unlocked) {\n\t\tvar unlockAudioElement = this.container;\n\n\t\tif (options.autoplay || this.player.options.streaming) {\n\t\t\tthis.unmuteButton = document.createElement('div');\n\t\t\tthis.unmuteButton.innerHTML = VideoElement.UNMUTE_BUTTON;\n\t\t\taddStyles(this.unmuteButton, {\n\t\t\t\tzIndex: 2, position: 'absolute',\n\t\t\t\tbottom: '10px', right: '20px',\n\t\t\t\twidth: '75px', height: '75px',\n\t\t\t\tmargin: 'auto',\n\t\t\t\topacity: '0.7',\n\t\t\t\tcursor: 'pointer'\n\t\t\t});\n\t\t\tthis.container.appendChild(this.unmuteButton);\n\t\t\tunlockAudioElement = this.unmuteButton;\n\t\t}\n\n\t\tthis.unlockAudioBound = this.onUnlockAudio.bind(this, unlockAudioElement);\n\t\tunlockAudioElement.addEventListener('touchstart', this.unlockAudioBound, false);\n\t\tunlockAudioElement.addEventListener('click', this.unlockAudioBound, true);\n\t}\n};\n\nVideoElement.prototype.onUnlockAudio = function(element, ev) {\n\tif (this.unmuteButton) {\n\t\tev.preventDefault();\n\t\tev.stopPropagation();\n\t}\n\tthis.player.audioOut.unlock(function(){\n\t\tif (this.unmuteButton) {\n\t\t\tthis.unmuteButton.style.display = 'none';\n\t\t}\n\t\telement.removeEventListener('touchstart', this.unlockAudioBound);\n\t\telement.removeEventListener('click', this.unlockAudioBound);\n\t}.bind(this));\n};\n\nVideoElement.prototype.onClick = function(ev) {\n\tif (this.player.isPlaying) {\n\t\tthis.player.pause();\n\t\tthis.playButton.style.display = 'block';\n\t}\n\telse {\n\t\tthis.player.play();\n\t\tthis.playButton.style.display = 'none';\n\t\tif (this.poster) {\n\t\t\tthis.poster.style.display = 'none';\n\t\t}\n\t}\n};\n\nVideoElement.PLAY_BUTTON =\n\t'<svg style=\"max-width: 75px; max-height: 75px;\" ' +\n\t\t'viewBox=\"0 0 200 200\" alt=\"Play video\">' +\n\t\t'<circle cx=\"100\" cy=\"100\" r=\"90\" fill=\"none\" '+\n\t\t\t'stroke-width=\"15\" stroke=\"#fff\"/>' +\n\t\t'<polygon points=\"70, 55 70, 145 145, 100\" fill=\"#fff\"/>' +\n\t'</svg>';\n\nVideoElement.UNMUTE_BUTTON =\n\t'<svg style=\"max-width: 75px; max-height: 75px;\" viewBox=\"0 0 75 75\">' +\n\t\t'<polygon class=\"audio-speaker\" stroke=\"none\" fill=\"#fff\" '+\n\t\t\t'points=\"39,13 22,28 6,28 6,47 21,47 39,62 39,13\"/>' +\n\t\t'<g stroke=\"#fff\" stroke-width=\"5\">' +\n\t\t\t'<path d=\"M 49,50 69,26\"/>' +\n\t\t\t'<path d=\"M 69,50 49,26\"/>' +\n\t\t'</g>' +\n\t'</svg>';\n\nmodule.exports = VideoElement;\n","const JSMpeg = require(\"./jsmpeg\");\n\nvar WebAudioOut = function(options) {\n\tthis.context = WebAudioOut.CachedContext =\n\t\tWebAudioOut.CachedContext ||\n\t\tnew (window.AudioContext || window.webkitAudioContext)();\n\n\tthis.gain = this.context.createGain();\n\tthis.destination = this.gain;\n\n\t// Keep track of the number of connections to this AudioContext, so we\n\t// can safely close() it when we're the only one connected to it.\n\tthis.gain.connect(this.context.destination);\n\tthis.context._connections = (this.context._connections || 0) + 1;\n\n\tthis.startTime = 0;\n\tthis.buffer = null;\n\tthis.wallclockStartTime = 0;\n\tthis.volume = 1;\n\tthis.enabled = true;\n\n\tthis.unlocked = !WebAudioOut.NeedsUnlocking();\n\n\tObject.defineProperty(this, 'enqueuedTime', {get: this.getEnqueuedTime});\n};\n\nWebAudioOut.prototype.destroy = function() {\n\tthis.gain.disconnect();\n\tthis.context._connections--;\n\n\tif (this.context._connections === 0) {\n\t\tthis.context.close();\n\t\tWebAudioOut.CachedContext = null;\n\t}\n};\n\nWebAudioOut.prototype.play = function(sampleRate, left, right) {\n\tif (!this.enabled) {\n\t\treturn;\n\t}\n\n\t// If the context is not unlocked yet, we simply advance the start time\n\t// to \"fake\" actually playing audio. This will keep the video in sync.\n\tif (!this.unlocked) {\n\t\tvar ts = JSMpeg.Now()\n\t\tif (this.wallclockStartTime < ts) {\n\t\t\tthis.wallclockStartTime = ts;\n\t\t}\n\t\tthis.wallclockStartTime += left.length / sampleRate;\n\t\treturn;\n\t}\n\n\n\tthis.gain.gain.value = this.volume;\n\n\tvar buffer = this.context.createBuffer(2, left.length, sampleRate);\n\tbuffer.getChannelData(0).set(left);\n\tbuffer.getChannelData(1).set(right);\n\n\tvar source = this.context.createBufferSource();\n\tsource.buffer = buffer;\n\tsource.connect(this.destination);\n\n\tvar now = this.context.currentTime;\n\tvar duration = buffer.duration;\n\tif (this.startTime < now) {\n\t\tthis.startTime = now;\n\t\tthis.wallclockStartTime = JSMpeg.Now();\n\t}\n\n\tsource.start(this.startTime);\n\tthis.startTime += duration;\n\tthis.wallclockStartTime += duration;\n};\n\nWebAudioOut.prototype.stop = function() {\n\t// Meh; there seems to be no simple way to get a list of currently\n\t// active source nodes from the Audio Context, and maintaining this\n\t// list ourselfs would be a pain, so we just set the gain to 0\n\t// to cut off all enqueued audio instantly.\n\tthis.gain.gain.value = 0;\n};\n\nWebAudioOut.prototype.getEnqueuedTime = function() {\n\t// The AudioContext.currentTime is only updated every so often, so if we\n\t// want to get exact timing, we need to rely on the system time.\n\treturn Math.max(this.wallclockStartTime - JSMpeg.Now(), 0)\n};\n\nWebAudioOut.prototype.resetEnqueuedTime = function() {\n\tthis.startTime = this.context.currentTime;\n\tthis.wallclockStartTime = JSMpeg.Now();\n};\n\nWebAudioOut.prototype.unlock = function(callback) {\n\tif (this.unlocked) {\n\t\tif (callback) {\n\t\t\tcallback();\n\t\t}\n\t\treturn;\n\t}\n\n\tthis.unlockCallback = callback;\n\n\t// Create empty buffer and play it\n\tvar buffer = this.context.createBuffer(1, 1, 22050);\n\tvar source = this.context.createBufferSource();\n\tsource.buffer = buffer;\n\tsource.connect(this.destination);\n\tsource.start(0);\n\n\tsetTimeout(this.checkIfUnlocked.bind(this, source, 0), 0);\n};\n\nWebAudioOut.prototype.checkIfUnlocked = function(source, attempt) {\n\tif (\n\t\tsource.playbackState === source.PLAYING_STATE ||\n\t\tsource.playbackState === source.FINISHED_STATE\n\t) {\n\t\tthis.unlocked = true;\n\t\tif (this.unlockCallback) {\n\t\t\tthis.unlockCallback();\n\t\t\tthis.unlockCallback = null;\n\t\t}\n\t}\n\telse if (attempt < 10) {\n\t\t// Jeez, what a shit show. Thanks iOS!\n\t\tsetTimeout(this.checkIfUnlocked.bind(this, source, attempt+1), 100);\n\t}\n};\n\nWebAudioOut.NeedsUnlocking = function() {\n\treturn /iPhone|iPad|iPod/i.test(navigator.userAgent);\n};\n\nWebAudioOut.IsSupported = function() {\n\treturn (window.AudioContext || window.webkitAudioContext);\n};\n\nWebAudioOut.CachedContext = null;\n\nmodule.exports = WebAudioOut;\n","var WebGLRenderer = function(options) {\n\tthis.canvas = options.canvas || document.createElement('canvas');\n\tthis.width = this.canvas.width;\n\tthis.height = this.canvas.height;\n\tthis.enabled = true;\n\n\tvar contextCreateOptions = {\n\t\tpreserveDrawingBuffer: !!options.preserveDrawingBuffer,\n\t\talpha: false,\n\t\tdepth: false,\n\t\tstencil: false,\n\t\tantialias: false\n\t};\n\n\tthis.gl =\n\t\tthis.canvas.getContext('webgl', contextCreateOptions) ||\n\t\tthis.canvas.getContext('experimental-webgl', contextCreateOptions);\n\n\tif (!this.gl) {\n\t\tthrow new Error('Failed to get WebGL Context');\n\t}\n\n\tvar gl = this.gl;\n\tvar vertexAttr = null;\n\n\t// Init buffers\n\tthis.vertexBuffer = gl.createBuffer();\n\tvar vertexCoords = new Float32Array([0, 0, 0, 1, 1, 0, 1, 1]);\n\tgl.bindBuffer(gl.ARRAY_BUFFER, this.vertexBuffer);\n\tgl.bufferData(gl.ARRAY_BUFFER, vertexCoords, gl.STATIC_DRAW);\n\n\t// Setup the main YCrCbToRGBA shader\n\tthis.program = this.createProgram(\n\t\tWebGLRenderer.SHADER.VERTEX_IDENTITY,\n\t\tWebGLRenderer.SHADER.FRAGMENT_YCRCB_TO_RGBA\n\t);\n\tvertexAttr = gl.getAttribLocation(this.program, 'vertex');\n\tgl.enableVertexAttribArray(vertexAttr);\n\tgl.vertexAttribPointer(vertexAttr, 2, gl.FLOAT, false, 0, 0);\n\n\tthis.textureY = this.createTexture(0, 'textureY');\n\tthis.textureCb = this.createTexture(1, 'textureCb');\n\tthis.textureCr = this.createTexture(2, 'textureCr');\n\n\n\t// Setup the loading animation shader\n\tthis.loadingProgram = this.createProgram(\n\t\tWebGLRenderer.SHADER.VERTEX_IDENTITY,\n\t\tWebGLRenderer.SHADER.FRAGMENT_LOADING\n\t);\n\tvertexAttr = gl.getAttribLocation(this.loadingProgram, 'vertex');\n\tgl.enableVertexAttribArray(vertexAttr);\n\tgl.vertexAttribPointer(vertexAttr, 2, gl.FLOAT, false, 0, 0);\n\n\tthis.shouldCreateUnclampedViews = !this.allowsClampedTextureData();\n};\n\nWebGLRenderer.prototype.destroy = function() {\n\tvar gl = this.gl;\n\n\tgl.deleteTexture(this.textureY);\n\tgl.deleteTexture(this.textureCb);\n\tgl.deleteTexture(this.textureCr);\n\n\tgl.deleteProgram(this.program);\n\tgl.deleteProgram(this.loadingProgram);\n\n\tgl.deleteBuffer(this.vertexBuffer);\n};\n\nWebGLRenderer.prototype.resize = function(width, height) {\n\tthis.width = width|0;\n\tthis.height = height|0;\n\n\tthis.canvas.width = this.width;\n\tthis.canvas.height = this.height;\n\n\tthis.gl.useProgram(this.program);\n\tthis.gl.viewport(0, 0, this.width, this.height);\n};\n\nWebGLRenderer.prototype.createTexture = function(index, name) {\n\tvar gl = this.gl;\n\tvar texture = gl.createTexture();\n\n\tgl.bindTexture(gl.TEXTURE_2D, texture);\n\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\tgl.uniform1i(gl.getUniformLocation(this.program, name), index);\n\n\treturn texture;\n};\n\nWebGLRenderer.prototype.createProgram = function(vsh, fsh) {\n\tvar gl = this.gl;\n\tvar program = gl.createProgram();\n\n\tgl.attachShader(program, this.compileShader(gl.VERTEX_SHADER, vsh));\n\tgl.attachShader(program, this.compileShader(gl.FRAGMENT_SHADER, fsh));\n\tgl.linkProgram(program);\n\tgl.useProgram(program);\n\n\treturn program;\n};\n\nWebGLRenderer.prototype.compileShader = function(type, source) {\n\tvar gl = this.gl;\n\tvar shader = gl.createShader(type);\n\tgl.shaderSource(shader, source);\n\tgl.compileShader(shader);\n\n\tif (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n\t\tthrow new Error(gl.getShaderInfoLog(shader));\n\t}\n\n\treturn shader;\n};\n\nWebGLRenderer.prototype.allowsClampedTextureData = function() {\n\tvar gl = this.gl;\n\tvar texture = gl.createTexture();\n\n\tgl.bindTexture(gl.TEXTURE_2D, texture);\n\tgl.texImage2D(\n\t\tgl.TEXTURE_2D, 0, gl.LUMINANCE, 1, 1, 0,\n\t\tgl.LUMINANCE, gl.UNSIGNED_BYTE, new Uint8ClampedArray([0])\n\t);\n\treturn (gl.getError() === 0);\n};\n\nWebGLRenderer.prototype.renderProgress = function(progress) {\n\tvar gl = this.gl;\n\n\tgl.useProgram(this.loadingProgram);\n\n\tvar loc = gl.getUniformLocation(this.loadingProgram, 'progress');\n\tgl.uniform1f(loc, progress);\n\n\tgl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n};\n\nWebGLRenderer.prototype.render = function(y, cb, cr) {\n\tif (!this.enabled) {\n\t\treturn;\n\t}\n\n\tvar gl = this.gl;\n\tvar w = ((this.width + 15) >> 4) << 4,\n\t\th = this.height,\n\t\tw2 = w >> 1,\n\t\th2 = h >> 1;\n\n\t// In some browsers WebGL doesn't like Uint8ClampedArrays (this is a bug\n\t// and should be fixed soon-ish), so we have to create a Uint8Array view\n\t// for each plane.\n\tif (this.shouldCreateUnclampedViews) {\n\t\ty = new Uint8Array(y.buffer),\n\t\tcb = new Uint8Array(cb.buffer),\n\t\tcr = new Uint8Array(cr.buffer);\n\t}\n\n\tgl.useProgram(this.program);\n\n\tthis.updateTexture(gl.TEXTURE0, this.textureY, w, h, y);\n\tthis.updateTexture(gl.TEXTURE1, this.textureCb, w2, h2, cb);\n\tthis.updateTexture(gl.TEXTURE2, this.textureCr, w2, h2, cr);\n\n\tgl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n};\n\nWebGLRenderer.prototype.updateTexture = function(unit, texture, w, h, data) {\n\tvar gl = this.gl;\n\tgl.activeTexture(unit);\n\tgl.bindTexture(gl.TEXTURE_2D, texture);\n\tgl.texImage2D(\n\t\tgl.TEXTURE_2D, 0, gl.LUMINANCE, w, h, 0,\n\t\tgl.LUMINANCE, gl.UNSIGNED_BYTE, data\n\t);\n}\n\nWebGLRenderer.IsSupported = function() {\n\ttry {\n\t\tif (!window.WebGLRenderingContext) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar canvas = document.createElement('canvas');\n\t\treturn !!(\n\t\t\tcanvas.getContext('webgl') ||\n\t\t\tcanvas.getContext('experimental-webgl')\n\t\t);\n\t}\n\tcatch (err) {\n\t\treturn false;\n\t}\n};\n\nWebGLRenderer.SHADER = {\n\tFRAGMENT_YCRCB_TO_RGBA: [\n\t\t'precision mediump float;',\n\t\t'uniform sampler2D textureY;',\n\t\t'uniform sampler2D textureCb;',\n\t\t'uniform sampler2D textureCr;',\n\t\t'varying vec2 texCoord;',\n\n\t\t'mat4 rec601 = mat4(',\n\t\t\t'1.16438,  0.00000,  1.59603, -0.87079,',\n\t\t\t'1.16438, -0.39176, -0.81297,  0.52959,',\n\t\t\t'1.16438,  2.01723,  0.00000, -1.08139,',\n\t\t\t'0, 0, 0, 1',\n\t\t');',\n\n\t\t'void main() {',\n\t\t\t'float y = texture2D(textureY, texCoord).r;',\n\t\t\t'float cb = texture2D(textureCb, texCoord).r;',\n\t\t\t'float cr = texture2D(textureCr, texCoord).r;',\n\n\t\t\t'gl_FragColor = vec4(y, cr, cb, 1.0) * rec601;',\n\t\t'}'\n\t].join('\\n'),\n\n\tFRAGMENT_LOADING: [\n\t\t'precision mediump float;',\n\t\t'uniform float progress;',\n\t\t'varying vec2 texCoord;',\n\n\t\t'void main() {',\n\t\t\t'float c = ceil(progress-(1.0-texCoord.y));',\n\t\t\t'gl_FragColor = vec4(c,c,c,1);',\n\t\t'}'\n\t].join('\\n'),\n\n\tVERTEX_IDENTITY: [\n\t\t'attribute vec2 vertex;',\n\t\t'varying vec2 texCoord;',\n\n\t\t'void main() {',\n\t\t\t'texCoord = vertex;',\n\t\t\t'gl_Position = vec4((vertex * 2.0 - 1.0) * vec2(1, -1), 0.0, 1.0);',\n\t\t'}'\n\t].join('\\n')\n};\n\nmodule.exports = WebGLRenderer;\n","var WSSource = function(url, options) {\n\tthis.url = url;\n\tthis.options = options;\n\tthis.socket = null;\n\n\tthis.callbacks = {connect: [], data: []};\n\tthis.destination = null;\n\n\tthis.reconnectInterval = options.reconnectInterval !== undefined\n\t\t? options.reconnectInterval\n\t\t: 5;\n\tthis.shouldAttemptReconnect = !!this.reconnectInterval;\n\n\tthis.completed = false;\n\tthis.established = false;\n\tthis.progress = 0;\n\n\tthis.reconnectTimeoutId = 0;\n};\n\nWSSource.prototype.connect = function(destination) {\n\tthis.destination = destination;\n};\n\nWSSource.prototype.destroy = function() {\n\tclearTimeout(this.reconnectTimeoutId);\n\tthis.shouldAttemptReconnect = false;\n\tthis.socket.close();\n};\n\nWSSource.prototype.start = function() {\n\tthis.shouldAttemptReconnect = !!this.reconnectInterval;\n\tthis.progress = 0;\n\tthis.established = false;\n\n\tthis.socket = new WebSocket(this.url, this.options.protocols || null);\n\tthis.socket.binaryType = 'arraybuffer';\n\tthis.socket.onmessage = this.onMessage.bind(this);\n\tthis.socket.onopen = this.onOpen.bind(this);\n\tthis.socket.onerror = this.onClose.bind(this);\n\tthis.socket.onclose = this.onClose.bind(this);\n};\n\nWSSource.prototype.resume = function(secondsHeadroom) {\n\t// Nothing to do here\n};\n\nWSSource.prototype.onOpen = function() {\n\tthis.progress = 1;\n\tthis.established = true;\n};\n\nWSSource.prototype.onClose = function() {\n\tif (this.shouldAttemptReconnect) {\n\t\tclearTimeout(this.reconnectTimeoutId);\n\t\tthis.reconnectTimeoutId = setTimeout(function(){\n\t\t\tthis.start();\n\t\t}.bind(this), this.reconnectInterval*1000);\n\t}\n};\n\nWSSource.prototype.onMessage = function(ev) {\n\tif (this.destination) {\n\t\tthis.destination.write(ev.data);\n\t}\n};\n\nmodule.exports = WSSource;\n","export default __webpack_public_path__ + \"career.html\";","export default __webpack_public_path__ + \"dog-boarding.html\";","export default __webpack_public_path__ + \"dog-daycare.html\";","export default __webpack_public_path__ + \"dog-grooming.html\";","export default __webpack_public_path__ + \"dog-training.html\";","export default __webpack_public_path__ + \"dog-wash.html\";","export default __webpack_public_path__ + \"new-account.html\";","export default __webpack_public_path__ + \"to-company.html\";","export default __webpack_public_path__ + \"http-error.html\";","export default __webpack_public_path__ + \"index.html\";","export default __webpack_public_path__ + \"job-success.html\";","export default __webpack_public_path__ + \"job.html\";","export default __webpack_public_path__ + \"other.html\";","export default __webpack_public_path__ + \"policies.html\";","export default __webpack_public_path__ + \"price.html\";","export default __webpack_public_path__ + \"sign-up-success.html\";","export default __webpack_public_path__ + \"sign-up.html\";","export default __webpack_public_path__ + \"support.html\";","export default __webpack_public_path__ + \"alert.html\";","export default __webpack_public_path__ + \"basic-requirements.html\";","export default __webpack_public_path__ + \"boarding-hours.html\";","export default __webpack_public_path__ + \"contact-us.html\";","export default __webpack_public_path__ + \"features.html\";","export default __webpack_public_path__ + \"footer.html\";","export default __webpack_public_path__ + \"gallery.html\";","export default __webpack_public_path__ + \"get-started.html\";","export default __webpack_public_path__ + \"header.html\";","export default __webpack_public_path__ + \"holidays.html\";","export default __webpack_public_path__ + \"hours-of-operation.html\";","export default __webpack_public_path__ + \"nav.html\";","export default __webpack_public_path__ + \"price-nav.html\";","export default __webpack_public_path__ + \"price-table.html\";","export default __webpack_public_path__ + \"review.html\";","export default __webpack_public_path__ + \"sign-up-module.html\";","export default __webpack_public_path__ + \"tour.html\";","export default __webpack_public_path__ + \"verify.html\";","export default __webpack_public_path__ + \"webcam-login.html\";","export default __webpack_public_path__ + \"webcam.html\";","// extracted by mini-css-extract-plugin\nexport {};","/*! PhotoSwipe Default UI - 4.1.3 - 2019-01-08\n* http://photoswipe.com\n* Copyright (c) 2019 Dmitry Semenov; */\n/**\n*\n* UI on top of main sliding area (caption, arrows, close button, etc.).\n* Built just using public methods/properties of PhotoSwipe.\n* \n*/\n(function (root, factory) { \n\tif (typeof define === 'function' && define.amd) {\n\t\tdefine(factory);\n\t} else if (typeof exports === 'object') {\n\t\tmodule.exports = factory();\n\t} else {\n\t\troot.PhotoSwipeUI_Default = factory();\n\t}\n})(this, function () {\n\n\t'use strict';\n\n\n\nvar PhotoSwipeUI_Default =\n function(pswp, framework) {\n\n\tvar ui = this;\n\tvar _overlayUIUpdated = false,\n\t\t_controlsVisible = true,\n\t\t_fullscrenAPI,\n\t\t_controls,\n\t\t_captionContainer,\n\t\t_fakeCaptionContainer,\n\t\t_indexIndicator,\n\t\t_shareButton,\n\t\t_shareModal,\n\t\t_shareModalHidden = true,\n\t\t_initalCloseOnScrollValue,\n\t\t_isIdle,\n\t\t_listen,\n\n\t\t_loadingIndicator,\n\t\t_loadingIndicatorHidden,\n\t\t_loadingIndicatorTimeout,\n\n\t\t_galleryHasOneSlide,\n\n\t\t_options,\n\t\t_defaultUIOptions = {\n\t\t\tbarsSize: {top:44, bottom:'auto'},\n\t\t\tcloseElClasses: ['item', 'caption', 'zoom-wrap', 'ui', 'top-bar'], \n\t\t\ttimeToIdle: 4000, \n\t\t\ttimeToIdleOutside: 1000,\n\t\t\tloadingIndicatorDelay: 1000, // 2s\n\t\t\t\n\t\t\taddCaptionHTMLFn: function(item, captionEl /*, isFake */) {\n\t\t\t\tif(!item.title) {\n\t\t\t\t\tcaptionEl.children[0].innerHTML = '';\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tcaptionEl.children[0].innerHTML = item.title;\n\t\t\t\treturn true;\n\t\t\t},\n\n\t\t\tcloseEl:true,\n\t\t\tcaptionEl: true,\n\t\t\tfullscreenEl: true,\n\t\t\tzoomEl: true,\n\t\t\tshareEl: true,\n\t\t\tcounterEl: true,\n\t\t\tarrowEl: true,\n\t\t\tpreloaderEl: true,\n\n\t\t\ttapToClose: false,\n\t\t\ttapToToggleControls: true,\n\n\t\t\tclickToCloseNonZoomable: true,\n\n\t\t\tshareButtons: [\n\t\t\t\t{id:'facebook', label:'Share on Facebook', url:'https://www.facebook.com/sharer/sharer.php?u={{url}}'},\n\t\t\t\t{id:'twitter', label:'Tweet', url:'https://twitter.com/intent/tweet?text={{text}}&url={{url}}'},\n\t\t\t\t{id:'pinterest', label:'Pin it', url:'http://www.pinterest.com/pin/create/button/'+\n\t\t\t\t\t\t\t\t\t\t\t\t\t'?url={{url}}&media={{image_url}}&description={{text}}'},\n\t\t\t\t{id:'download', label:'Download image', url:'{{raw_image_url}}', download:true}\n\t\t\t],\n\t\t\tgetImageURLForShare: function( /* shareButtonData */ ) {\n\t\t\t\treturn pswp.currItem.src || '';\n\t\t\t},\n\t\t\tgetPageURLForShare: function( /* shareButtonData */ ) {\n\t\t\t\treturn window.location.href;\n\t\t\t},\n\t\t\tgetTextForShare: function( /* shareButtonData */ ) {\n\t\t\t\treturn pswp.currItem.title || '';\n\t\t\t},\n\t\t\t\t\n\t\t\tindexIndicatorSep: ' / ',\n\t\t\tfitControlsWidth: 1200\n\n\t\t},\n\t\t_blockControlsTap,\n\t\t_blockControlsTapTimeout;\n\n\n\n\tvar _onControlsTap = function(e) {\n\t\t\tif(_blockControlsTap) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\n\t\t\te = e || window.event;\n\n\t\t\tif(_options.timeToIdle && _options.mouseUsed && !_isIdle) {\n\t\t\t\t// reset idle timer\n\t\t\t\t_onIdleMouseMove();\n\t\t\t}\n\n\n\t\t\tvar target = e.target || e.srcElement,\n\t\t\t\tuiElement,\n\t\t\t\tclickedClass = target.getAttribute('class') || '',\n\t\t\t\tfound;\n\n\t\t\tfor(var i = 0; i < _uiElements.length; i++) {\n\t\t\t\tuiElement = _uiElements[i];\n\t\t\t\tif(uiElement.onTap && clickedClass.indexOf('pswp__' + uiElement.name ) > -1 ) {\n\t\t\t\t\tuiElement.onTap();\n\t\t\t\t\tfound = true;\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(found) {\n\t\t\t\tif(e.stopPropagation) {\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t}\n\t\t\t\t_blockControlsTap = true;\n\n\t\t\t\t// Some versions of Android don't prevent ghost click event \n\t\t\t\t// when preventDefault() was called on touchstart and/or touchend.\n\t\t\t\t// \n\t\t\t\t// This happens on v4.3, 4.2, 4.1, \n\t\t\t\t// older versions strangely work correctly, \n\t\t\t\t// but just in case we add delay on all of them)\t\n\t\t\t\tvar tapDelay = framework.features.isOldAndroid ? 600 : 30;\n\t\t\t\t_blockControlsTapTimeout = setTimeout(function() {\n\t\t\t\t\t_blockControlsTap = false;\n\t\t\t\t}, tapDelay);\n\t\t\t}\n\n\t\t},\n\t\t_fitControlsInViewport = function() {\n\t\t\treturn !pswp.likelyTouchDevice || _options.mouseUsed || screen.width > _options.fitControlsWidth;\n\t\t},\n\t\t_togglePswpClass = function(el, cName, add) {\n\t\t\tframework[ (add ? 'add' : 'remove') + 'Class' ](el, 'pswp__' + cName);\n\t\t},\n\n\t\t// add class when there is just one item in the gallery\n\t\t// (by default it hides left/right arrows and 1ofX counter)\n\t\t_countNumItems = function() {\n\t\t\tvar hasOneSlide = (_options.getNumItemsFn() === 1);\n\n\t\t\tif(hasOneSlide !== _galleryHasOneSlide) {\n\t\t\t\t_togglePswpClass(_controls, 'ui--one-slide', hasOneSlide);\n\t\t\t\t_galleryHasOneSlide = hasOneSlide;\n\t\t\t}\n\t\t},\n\t\t_toggleShareModalClass = function() {\n\t\t\t_togglePswpClass(_shareModal, 'share-modal--hidden', _shareModalHidden);\n\t\t},\n\t\t_toggleShareModal = function() {\n\n\t\t\t_shareModalHidden = !_shareModalHidden;\n\t\t\t\n\t\t\t\n\t\t\tif(!_shareModalHidden) {\n\t\t\t\t_toggleShareModalClass();\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tif(!_shareModalHidden) {\n\t\t\t\t\t\tframework.addClass(_shareModal, 'pswp__share-modal--fade-in');\n\t\t\t\t\t}\n\t\t\t\t}, 30);\n\t\t\t} else {\n\t\t\t\tframework.removeClass(_shareModal, 'pswp__share-modal--fade-in');\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tif(_shareModalHidden) {\n\t\t\t\t\t\t_toggleShareModalClass();\n\t\t\t\t\t}\n\t\t\t\t}, 300);\n\t\t\t}\n\t\t\t\n\t\t\tif(!_shareModalHidden) {\n\t\t\t\t_updateShareURLs();\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\n\t\t_openWindowPopup = function(e) {\n\t\t\te = e || window.event;\n\t\t\tvar target = e.target || e.srcElement;\n\n\t\t\tpswp.shout('shareLinkClick', e, target);\n\n\t\t\tif(!target.href) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif( target.hasAttribute('download') ) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\twindow.open(target.href, 'pswp_share', 'scrollbars=yes,resizable=yes,toolbar=no,'+\n\t\t\t\t\t\t\t\t\t\t'location=yes,width=550,height=420,top=100,left=' + \n\t\t\t\t\t\t\t\t\t\t(window.screen ? Math.round(screen.width / 2 - 275) : 100)  );\n\n\t\t\tif(!_shareModalHidden) {\n\t\t\t\t_toggleShareModal();\n\t\t\t}\n\t\t\t\n\t\t\treturn false;\n\t\t},\n\t\t_updateShareURLs = function() {\n\t\t\tvar shareButtonOut = '',\n\t\t\t\tshareButtonData,\n\t\t\t\tshareURL,\n\t\t\t\timage_url,\n\t\t\t\tpage_url,\n\t\t\t\tshare_text;\n\n\t\t\tfor(var i = 0; i < _options.shareButtons.length; i++) {\n\t\t\t\tshareButtonData = _options.shareButtons[i];\n\n\t\t\t\timage_url = _options.getImageURLForShare(shareButtonData);\n\t\t\t\tpage_url = _options.getPageURLForShare(shareButtonData);\n\t\t\t\tshare_text = _options.getTextForShare(shareButtonData);\n\n\t\t\t\tshareURL = shareButtonData.url.replace('{{url}}', encodeURIComponent(page_url) )\n\t\t\t\t\t\t\t\t\t.replace('{{image_url}}', encodeURIComponent(image_url) )\n\t\t\t\t\t\t\t\t\t.replace('{{raw_image_url}}', image_url )\n\t\t\t\t\t\t\t\t\t.replace('{{text}}', encodeURIComponent(share_text) );\n\n\t\t\t\tshareButtonOut += '<a href=\"' + shareURL + '\" target=\"_blank\" '+\n\t\t\t\t\t\t\t\t\t'class=\"pswp__share--' + shareButtonData.id + '\"' +\n\t\t\t\t\t\t\t\t\t(shareButtonData.download ? 'download' : '') + '>' + \n\t\t\t\t\t\t\t\t\tshareButtonData.label + '</a>';\n\n\t\t\t\tif(_options.parseShareButtonOut) {\n\t\t\t\t\tshareButtonOut = _options.parseShareButtonOut(shareButtonData, shareButtonOut);\n\t\t\t\t}\n\t\t\t}\n\t\t\t_shareModal.children[0].innerHTML = shareButtonOut;\n\t\t\t_shareModal.children[0].onclick = _openWindowPopup;\n\n\t\t},\n\t\t_hasCloseClass = function(target) {\n\t\t\tfor(var  i = 0; i < _options.closeElClasses.length; i++) {\n\t\t\t\tif( framework.hasClass(target, 'pswp__' + _options.closeElClasses[i]) ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t_idleInterval,\n\t\t_idleTimer,\n\t\t_idleIncrement = 0,\n\t\t_onIdleMouseMove = function() {\n\t\t\tclearTimeout(_idleTimer);\n\t\t\t_idleIncrement = 0;\n\t\t\tif(_isIdle) {\n\t\t\t\tui.setIdle(false);\n\t\t\t}\n\t\t},\n\t\t_onMouseLeaveWindow = function(e) {\n\t\t\te = e ? e : window.event;\n\t\t\tvar from = e.relatedTarget || e.toElement;\n\t\t\tif (!from || from.nodeName === 'HTML') {\n\t\t\t\tclearTimeout(_idleTimer);\n\t\t\t\t_idleTimer = setTimeout(function() {\n\t\t\t\t\tui.setIdle(true);\n\t\t\t\t}, _options.timeToIdleOutside);\n\t\t\t}\n\t\t},\n\t\t_setupFullscreenAPI = function() {\n\t\t\tif(_options.fullscreenEl && !framework.features.isOldAndroid) {\n\t\t\t\tif(!_fullscrenAPI) {\n\t\t\t\t\t_fullscrenAPI = ui.getFullscreenAPI();\n\t\t\t\t}\n\t\t\t\tif(_fullscrenAPI) {\n\t\t\t\t\tframework.bind(document, _fullscrenAPI.eventK, ui.updateFullscreen);\n\t\t\t\t\tui.updateFullscreen();\n\t\t\t\t\tframework.addClass(pswp.template, 'pswp--supports-fs');\n\t\t\t\t} else {\n\t\t\t\t\tframework.removeClass(pswp.template, 'pswp--supports-fs');\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t_setupLoadingIndicator = function() {\n\t\t\t// Setup loading indicator\n\t\t\tif(_options.preloaderEl) {\n\t\t\t\n\t\t\t\t_toggleLoadingIndicator(true);\n\n\t\t\t\t_listen('beforeChange', function() {\n\n\t\t\t\t\tclearTimeout(_loadingIndicatorTimeout);\n\n\t\t\t\t\t// display loading indicator with delay\n\t\t\t\t\t_loadingIndicatorTimeout = setTimeout(function() {\n\n\t\t\t\t\t\tif(pswp.currItem && pswp.currItem.loading) {\n\n\t\t\t\t\t\t\tif( !pswp.allowProgressiveImg() || (pswp.currItem.img && !pswp.currItem.img.naturalWidth)  ) {\n\t\t\t\t\t\t\t\t// show preloader if progressive loading is not enabled, \n\t\t\t\t\t\t\t\t// or image width is not defined yet (because of slow connection)\n\t\t\t\t\t\t\t\t_toggleLoadingIndicator(false); \n\t\t\t\t\t\t\t\t// items-controller.js function allowProgressiveImg\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t_toggleLoadingIndicator(true); // hide preloader\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}, _options.loadingIndicatorDelay);\n\t\t\t\t\t\n\t\t\t\t});\n\t\t\t\t_listen('imageLoadComplete', function(index, item) {\n\t\t\t\t\tif(pswp.currItem === item) {\n\t\t\t\t\t\t_toggleLoadingIndicator(true);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t}\n\t\t},\n\t\t_toggleLoadingIndicator = function(hide) {\n\t\t\tif( _loadingIndicatorHidden !== hide ) {\n\t\t\t\t_togglePswpClass(_loadingIndicator, 'preloader--active', !hide);\n\t\t\t\t_loadingIndicatorHidden = hide;\n\t\t\t}\n\t\t},\n\t\t_applyNavBarGaps = function(item) {\n\t\t\tvar gap = item.vGap;\n\n\t\t\tif( _fitControlsInViewport() ) {\n\t\t\t\t\n\t\t\t\tvar bars = _options.barsSize; \n\t\t\t\tif(_options.captionEl && bars.bottom === 'auto') {\n\t\t\t\t\tif(!_fakeCaptionContainer) {\n\t\t\t\t\t\t_fakeCaptionContainer = framework.createEl('pswp__caption pswp__caption--fake');\n\t\t\t\t\t\t_fakeCaptionContainer.appendChild( framework.createEl('pswp__caption__center') );\n\t\t\t\t\t\t_controls.insertBefore(_fakeCaptionContainer, _captionContainer);\n\t\t\t\t\t\tframework.addClass(_controls, 'pswp__ui--fit');\n\t\t\t\t\t}\n\t\t\t\t\tif( _options.addCaptionHTMLFn(item, _fakeCaptionContainer, true) ) {\n\n\t\t\t\t\t\tvar captionSize = _fakeCaptionContainer.clientHeight;\n\t\t\t\t\t\tgap.bottom = parseInt(captionSize,10) || 44;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tgap.bottom = bars.top; // if no caption, set size of bottom gap to size of top\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tgap.bottom = bars.bottom === 'auto' ? 0 : bars.bottom;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// height of top bar is static, no need to calculate it\n\t\t\t\tgap.top = bars.top;\n\t\t\t} else {\n\t\t\t\tgap.top = gap.bottom = 0;\n\t\t\t}\n\t\t},\n\t\t_setupIdle = function() {\n\t\t\t// Hide controls when mouse is used\n\t\t\tif(_options.timeToIdle) {\n\t\t\t\t_listen('mouseUsed', function() {\n\t\t\t\t\t\n\t\t\t\t\tframework.bind(document, 'mousemove', _onIdleMouseMove);\n\t\t\t\t\tframework.bind(document, 'mouseout', _onMouseLeaveWindow);\n\n\t\t\t\t\t_idleInterval = setInterval(function() {\n\t\t\t\t\t\t_idleIncrement++;\n\t\t\t\t\t\tif(_idleIncrement === 2) {\n\t\t\t\t\t\t\tui.setIdle(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, _options.timeToIdle / 2);\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\t_setupHidingControlsDuringGestures = function() {\n\n\t\t\t// Hide controls on vertical drag\n\t\t\t_listen('onVerticalDrag', function(now) {\n\t\t\t\tif(_controlsVisible && now < 0.95) {\n\t\t\t\t\tui.hideControls();\n\t\t\t\t} else if(!_controlsVisible && now >= 0.95) {\n\t\t\t\t\tui.showControls();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Hide controls when pinching to close\n\t\t\tvar pinchControlsHidden;\n\t\t\t_listen('onPinchClose' , function(now) {\n\t\t\t\tif(_controlsVisible && now < 0.9) {\n\t\t\t\t\tui.hideControls();\n\t\t\t\t\tpinchControlsHidden = true;\n\t\t\t\t} else if(pinchControlsHidden && !_controlsVisible && now > 0.9) {\n\t\t\t\t\tui.showControls();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t_listen('zoomGestureEnded', function() {\n\t\t\t\tpinchControlsHidden = false;\n\t\t\t\tif(pinchControlsHidden && !_controlsVisible) {\n\t\t\t\t\tui.showControls();\n\t\t\t\t}\n\t\t\t});\n\n\t\t};\n\n\n\n\tvar _uiElements = [\n\t\t{ \n\t\t\tname: 'caption', \n\t\t\toption: 'captionEl',\n\t\t\tonInit: function(el) {  \n\t\t\t\t_captionContainer = el; \n\t\t\t} \n\t\t},\n\t\t{ \n\t\t\tname: 'share-modal', \n\t\t\toption: 'shareEl',\n\t\t\tonInit: function(el) {  \n\t\t\t\t_shareModal = el;\n\t\t\t},\n\t\t\tonTap: function() {\n\t\t\t\t_toggleShareModal();\n\t\t\t} \n\t\t},\n\t\t{ \n\t\t\tname: 'button--share', \n\t\t\toption: 'shareEl',\n\t\t\tonInit: function(el) { \n\t\t\t\t_shareButton = el;\n\t\t\t},\n\t\t\tonTap: function() {\n\t\t\t\t_toggleShareModal();\n\t\t\t} \n\t\t},\n\t\t{ \n\t\t\tname: 'button--zoom', \n\t\t\toption: 'zoomEl',\n\t\t\tonTap: pswp.toggleDesktopZoom\n\t\t},\n\t\t{ \n\t\t\tname: 'counter', \n\t\t\toption: 'counterEl',\n\t\t\tonInit: function(el) {  \n\t\t\t\t_indexIndicator = el;\n\t\t\t} \n\t\t},\n\t\t{ \n\t\t\tname: 'button--close', \n\t\t\toption: 'closeEl',\n\t\t\tonTap: pswp.close\n\t\t},\n\t\t{ \n\t\t\tname: 'button--arrow--left', \n\t\t\toption: 'arrowEl',\n\t\t\tonTap: pswp.prev\n\t\t},\n\t\t{ \n\t\t\tname: 'button--arrow--right', \n\t\t\toption: 'arrowEl',\n\t\t\tonTap: pswp.next\n\t\t},\n\t\t{ \n\t\t\tname: 'button--fs', \n\t\t\toption: 'fullscreenEl',\n\t\t\tonTap: function() {  \n\t\t\t\tif(_fullscrenAPI.isFullscreen()) {\n\t\t\t\t\t_fullscrenAPI.exit();\n\t\t\t\t} else {\n\t\t\t\t\t_fullscrenAPI.enter();\n\t\t\t\t}\n\t\t\t} \n\t\t},\n\t\t{ \n\t\t\tname: 'preloader', \n\t\t\toption: 'preloaderEl',\n\t\t\tonInit: function(el) {  \n\t\t\t\t_loadingIndicator = el;\n\t\t\t} \n\t\t}\n\n\t];\n\n\tvar _setupUIElements = function() {\n\t\tvar item,\n\t\t\tclassAttr,\n\t\t\tuiElement;\n\n\t\tvar loopThroughChildElements = function(sChildren) {\n\t\t\tif(!sChildren) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar l = sChildren.length;\n\t\t\tfor(var i = 0; i < l; i++) {\n\t\t\t\titem = sChildren[i];\n\t\t\t\tclassAttr = item.className;\n\n\t\t\t\tfor(var a = 0; a < _uiElements.length; a++) {\n\t\t\t\t\tuiElement = _uiElements[a];\n\n\t\t\t\t\tif(classAttr.indexOf('pswp__' + uiElement.name) > -1  ) {\n\n\t\t\t\t\t\tif( _options[uiElement.option] ) { // if element is not disabled from options\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tframework.removeClass(item, 'pswp__element--disabled');\n\t\t\t\t\t\t\tif(uiElement.onInit) {\n\t\t\t\t\t\t\t\tuiElement.onInit(item);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t//item.style.display = 'block';\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tframework.addClass(item, 'pswp__element--disabled');\n\t\t\t\t\t\t\t//item.style.display = 'none';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tloopThroughChildElements(_controls.children);\n\n\t\tvar topBar =  framework.getChildByClass(_controls, 'pswp__top-bar');\n\t\tif(topBar) {\n\t\t\tloopThroughChildElements( topBar.children );\n\t\t}\n\t};\n\n\n\t\n\n\tui.init = function() {\n\n\t\t// extend options\n\t\tframework.extend(pswp.options, _defaultUIOptions, true);\n\n\t\t// create local link for fast access\n\t\t_options = pswp.options;\n\n\t\t// find pswp__ui element\n\t\t_controls = framework.getChildByClass(pswp.scrollWrap, 'pswp__ui');\n\n\t\t// create local link\n\t\t_listen = pswp.listen;\n\n\n\t\t_setupHidingControlsDuringGestures();\n\n\t\t// update controls when slides change\n\t\t_listen('beforeChange', ui.update);\n\n\t\t// toggle zoom on double-tap\n\t\t_listen('doubleTap', function(point) {\n\t\t\tvar initialZoomLevel = pswp.currItem.initialZoomLevel;\n\t\t\tif(pswp.getZoomLevel() !== initialZoomLevel) {\n\t\t\t\tpswp.zoomTo(initialZoomLevel, point, 333);\n\t\t\t} else {\n\t\t\t\tpswp.zoomTo(_options.getDoubleTapZoom(false, pswp.currItem), point, 333);\n\t\t\t}\n\t\t});\n\n\t\t// Allow text selection in caption\n\t\t_listen('preventDragEvent', function(e, isDown, preventObj) {\n\t\t\tvar t = e.target || e.srcElement;\n\t\t\tif(\n\t\t\t\tt && \n\t\t\t\tt.getAttribute('class') && e.type.indexOf('mouse') > -1 && \n\t\t\t\t( t.getAttribute('class').indexOf('__caption') > 0 || (/(SMALL|STRONG|EM)/i).test(t.tagName) ) \n\t\t\t) {\n\t\t\t\tpreventObj.prevent = false;\n\t\t\t}\n\t\t});\n\n\t\t// bind events for UI\n\t\t_listen('bindEvents', function() {\n\t\t\tframework.bind(_controls, 'pswpTap click', _onControlsTap);\n\t\t\tframework.bind(pswp.scrollWrap, 'pswpTap', ui.onGlobalTap);\n\n\t\t\tif(!pswp.likelyTouchDevice) {\n\t\t\t\tframework.bind(pswp.scrollWrap, 'mouseover', ui.onMouseOver);\n\t\t\t}\n\t\t});\n\n\t\t// unbind events for UI\n\t\t_listen('unbindEvents', function() {\n\t\t\tif(!_shareModalHidden) {\n\t\t\t\t_toggleShareModal();\n\t\t\t}\n\n\t\t\tif(_idleInterval) {\n\t\t\t\tclearInterval(_idleInterval);\n\t\t\t}\n\t\t\tframework.unbind(document, 'mouseout', _onMouseLeaveWindow);\n\t\t\tframework.unbind(document, 'mousemove', _onIdleMouseMove);\n\t\t\tframework.unbind(_controls, 'pswpTap click', _onControlsTap);\n\t\t\tframework.unbind(pswp.scrollWrap, 'pswpTap', ui.onGlobalTap);\n\t\t\tframework.unbind(pswp.scrollWrap, 'mouseover', ui.onMouseOver);\n\n\t\t\tif(_fullscrenAPI) {\n\t\t\t\tframework.unbind(document, _fullscrenAPI.eventK, ui.updateFullscreen);\n\t\t\t\tif(_fullscrenAPI.isFullscreen()) {\n\t\t\t\t\t_options.hideAnimationDuration = 0;\n\t\t\t\t\t_fullscrenAPI.exit();\n\t\t\t\t}\n\t\t\t\t_fullscrenAPI = null;\n\t\t\t}\n\t\t});\n\n\n\t\t// clean up things when gallery is destroyed\n\t\t_listen('destroy', function() {\n\t\t\tif(_options.captionEl) {\n\t\t\t\tif(_fakeCaptionContainer) {\n\t\t\t\t\t_controls.removeChild(_fakeCaptionContainer);\n\t\t\t\t}\n\t\t\t\tframework.removeClass(_captionContainer, 'pswp__caption--empty');\n\t\t\t}\n\n\t\t\tif(_shareModal) {\n\t\t\t\t_shareModal.children[0].onclick = null;\n\t\t\t}\n\t\t\tframework.removeClass(_controls, 'pswp__ui--over-close');\n\t\t\tframework.addClass( _controls, 'pswp__ui--hidden');\n\t\t\tui.setIdle(false);\n\t\t});\n\t\t\n\n\t\tif(!_options.showAnimationDuration) {\n\t\t\tframework.removeClass( _controls, 'pswp__ui--hidden');\n\t\t}\n\t\t_listen('initialZoomIn', function() {\n\t\t\tif(_options.showAnimationDuration) {\n\t\t\t\tframework.removeClass( _controls, 'pswp__ui--hidden');\n\t\t\t}\n\t\t});\n\t\t_listen('initialZoomOut', function() {\n\t\t\tframework.addClass( _controls, 'pswp__ui--hidden');\n\t\t});\n\n\t\t_listen('parseVerticalMargin', _applyNavBarGaps);\n\t\t\n\t\t_setupUIElements();\n\n\t\tif(_options.shareEl && _shareButton && _shareModal) {\n\t\t\t_shareModalHidden = true;\n\t\t}\n\n\t\t_countNumItems();\n\n\t\t_setupIdle();\n\n\t\t_setupFullscreenAPI();\n\n\t\t_setupLoadingIndicator();\n\t};\n\n\tui.setIdle = function(isIdle) {\n\t\t_isIdle = isIdle;\n\t\t_togglePswpClass(_controls, 'ui--idle', isIdle);\n\t};\n\n\tui.update = function() {\n\t\t// Don't update UI if it's hidden\n\t\tif(_controlsVisible && pswp.currItem) {\n\t\t\t\n\t\t\tui.updateIndexIndicator();\n\n\t\t\tif(_options.captionEl) {\n\t\t\t\t_options.addCaptionHTMLFn(pswp.currItem, _captionContainer);\n\n\t\t\t\t_togglePswpClass(_captionContainer, 'caption--empty', !pswp.currItem.title);\n\t\t\t}\n\n\t\t\t_overlayUIUpdated = true;\n\n\t\t} else {\n\t\t\t_overlayUIUpdated = false;\n\t\t}\n\n\t\tif(!_shareModalHidden) {\n\t\t\t_toggleShareModal();\n\t\t}\n\n\t\t_countNumItems();\n\t};\n\n\tui.updateFullscreen = function(e) {\n\n\t\tif(e) {\n\t\t\t// some browsers change window scroll position during the fullscreen\n\t\t\t// so PhotoSwipe updates it just in case\n\t\t\tsetTimeout(function() {\n\t\t\t\tpswp.setScrollOffset( 0, framework.getScrollY() );\n\t\t\t}, 50);\n\t\t}\n\t\t\n\t\t// toogle pswp--fs class on root element\n\t\tframework[ (_fullscrenAPI.isFullscreen() ? 'add' : 'remove') + 'Class' ](pswp.template, 'pswp--fs');\n\t};\n\n\tui.updateIndexIndicator = function() {\n\t\tif(_options.counterEl) {\n\t\t\t_indexIndicator.innerHTML = (pswp.getCurrentIndex()+1) + \n\t\t\t\t\t\t\t\t\t\t_options.indexIndicatorSep + \n\t\t\t\t\t\t\t\t\t\t_options.getNumItemsFn();\n\t\t}\n\t};\n\t\n\tui.onGlobalTap = function(e) {\n\t\te = e || window.event;\n\t\tvar target = e.target || e.srcElement;\n\n\t\tif(_blockControlsTap) {\n\t\t\treturn;\n\t\t}\n\n\t\tif(e.detail && e.detail.pointerType === 'mouse') {\n\n\t\t\t// close gallery if clicked outside of the image\n\t\t\tif(_hasCloseClass(target)) {\n\t\t\t\tpswp.close();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif(framework.hasClass(target, 'pswp__img')) {\n\t\t\t\tif(pswp.getZoomLevel() === 1 && pswp.getZoomLevel() <= pswp.currItem.fitRatio) {\n\t\t\t\t\tif(_options.clickToCloseNonZoomable) {\n\t\t\t\t\t\tpswp.close();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tpswp.toggleDesktopZoom(e.detail.releasePoint);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t} else {\n\n\t\t\t// tap anywhere (except buttons) to toggle visibility of controls\n\t\t\tif(_options.tapToToggleControls) {\n\t\t\t\tif(_controlsVisible) {\n\t\t\t\t\tui.hideControls();\n\t\t\t\t} else {\n\t\t\t\t\tui.showControls();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// tap to close gallery\n\t\t\tif(_options.tapToClose && (framework.hasClass(target, 'pswp__img') || _hasCloseClass(target)) ) {\n\t\t\t\tpswp.close();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t}\n\t};\n\tui.onMouseOver = function(e) {\n\t\te = e || window.event;\n\t\tvar target = e.target || e.srcElement;\n\n\t\t// add class when mouse is over an element that should close the gallery\n\t\t_togglePswpClass(_controls, 'ui--over-close', _hasCloseClass(target));\n\t};\n\n\tui.hideControls = function() {\n\t\tframework.addClass(_controls,'pswp__ui--hidden');\n\t\t_controlsVisible = false;\n\t};\n\n\tui.showControls = function() {\n\t\t_controlsVisible = true;\n\t\tif(!_overlayUIUpdated) {\n\t\t\tui.update();\n\t\t}\n\t\tframework.removeClass(_controls,'pswp__ui--hidden');\n\t};\n\n\tui.supportsFullscreen = function() {\n\t\tvar d = document;\n\t\treturn !!(d.exitFullscreen || d.mozCancelFullScreen || d.webkitExitFullscreen || d.msExitFullscreen);\n\t};\n\n\tui.getFullscreenAPI = function() {\n\t\tvar dE = document.documentElement,\n\t\t\tapi,\n\t\t\ttF = 'fullscreenchange';\n\n\t\tif (dE.requestFullscreen) {\n\t\t\tapi = {\n\t\t\t\tenterK: 'requestFullscreen',\n\t\t\t\texitK: 'exitFullscreen',\n\t\t\t\telementK: 'fullscreenElement',\n\t\t\t\teventK: tF\n\t\t\t};\n\n\t\t} else if(dE.mozRequestFullScreen ) {\n\t\t\tapi = {\n\t\t\t\tenterK: 'mozRequestFullScreen',\n\t\t\t\texitK: 'mozCancelFullScreen',\n\t\t\t\telementK: 'mozFullScreenElement',\n\t\t\t\teventK: 'moz' + tF\n\t\t\t};\n\n\t\t\t\n\n\t\t} else if(dE.webkitRequestFullscreen) {\n\t\t\tapi = {\n\t\t\t\tenterK: 'webkitRequestFullscreen',\n\t\t\t\texitK: 'webkitExitFullscreen',\n\t\t\t\telementK: 'webkitFullscreenElement',\n\t\t\t\teventK: 'webkit' + tF\n\t\t\t};\n\n\t\t} else if(dE.msRequestFullscreen) {\n\t\t\tapi = {\n\t\t\t\tenterK: 'msRequestFullscreen',\n\t\t\t\texitK: 'msExitFullscreen',\n\t\t\t\telementK: 'msFullscreenElement',\n\t\t\t\teventK: 'MSFullscreenChange'\n\t\t\t};\n\t\t}\n\n\t\tif(api) {\n\t\t\tapi.enter = function() { \n\t\t\t\t// disable close-on-scroll in fullscreen\n\t\t\t\t_initalCloseOnScrollValue = _options.closeOnScroll; \n\t\t\t\t_options.closeOnScroll = false; \n\n\t\t\t\tif(this.enterK === 'webkitRequestFullscreen') {\n\t\t\t\t\tpswp.template[this.enterK]( Element.ALLOW_KEYBOARD_INPUT );\n\t\t\t\t} else {\n\t\t\t\t\treturn pswp.template[this.enterK](); \n\t\t\t\t}\n\t\t\t};\n\t\t\tapi.exit = function() { \n\t\t\t\t_options.closeOnScroll = _initalCloseOnScrollValue;\n\n\t\t\t\treturn document[this.exitK](); \n\n\t\t\t};\n\t\t\tapi.isFullscreen = function() { return document[this.elementK]; };\n\t\t}\n\n\t\treturn api;\n\t};\n\n\n\n};\nreturn PhotoSwipeUI_Default;\n\n\n});\n","/*! PhotoSwipe - v4.1.3 - 2019-01-08\n* http://photoswipe.com\n* Copyright (c) 2019 Dmitry Semenov; */\n(function (root, factory) { \n\tif (typeof define === 'function' && define.amd) {\n\t\tdefine(factory);\n\t} else if (typeof exports === 'object') {\n\t\tmodule.exports = factory();\n\t} else {\n\t\troot.PhotoSwipe = factory();\n\t}\n})(this, function () {\n\n\t'use strict';\n\tvar PhotoSwipe = function(template, UiClass, items, options){\n\n/*>>framework-bridge*/\n/**\n *\n * Set of generic functions used by gallery.\n * \n * You're free to modify anything here as long as functionality is kept.\n * \n */\nvar framework = {\n\tfeatures: null,\n\tbind: function(target, type, listener, unbind) {\n\t\tvar methodName = (unbind ? 'remove' : 'add') + 'EventListener';\n\t\ttype = type.split(' ');\n\t\tfor(var i = 0; i < type.length; i++) {\n\t\t\tif(type[i]) {\n\t\t\t\ttarget[methodName]( type[i], listener, false);\n\t\t\t}\n\t\t}\n\t},\n\tisArray: function(obj) {\n\t\treturn (obj instanceof Array);\n\t},\n\tcreateEl: function(classes, tag) {\n\t\tvar el = document.createElement(tag || 'div');\n\t\tif(classes) {\n\t\t\tel.className = classes;\n\t\t}\n\t\treturn el;\n\t},\n\tgetScrollY: function() {\n\t\tvar yOffset = window.pageYOffset;\n\t\treturn yOffset !== undefined ? yOffset : document.documentElement.scrollTop;\n\t},\n\tunbind: function(target, type, listener) {\n\t\tframework.bind(target,type,listener,true);\n\t},\n\tremoveClass: function(el, className) {\n\t\tvar reg = new RegExp('(\\\\s|^)' + className + '(\\\\s|$)');\n\t\tel.className = el.className.replace(reg, ' ').replace(/^\\s\\s*/, '').replace(/\\s\\s*$/, ''); \n\t},\n\taddClass: function(el, className) {\n\t\tif( !framework.hasClass(el,className) ) {\n\t\t\tel.className += (el.className ? ' ' : '') + className;\n\t\t}\n\t},\n\thasClass: function(el, className) {\n\t\treturn el.className && new RegExp('(^|\\\\s)' + className + '(\\\\s|$)').test(el.className);\n\t},\n\tgetChildByClass: function(parentEl, childClassName) {\n\t\tvar node = parentEl.firstChild;\n\t\twhile(node) {\n\t\t\tif( framework.hasClass(node, childClassName) ) {\n\t\t\t\treturn node;\n\t\t\t}\n\t\t\tnode = node.nextSibling;\n\t\t}\n\t},\n\tarraySearch: function(array, value, key) {\n\t\tvar i = array.length;\n\t\twhile(i--) {\n\t\t\tif(array[i][key] === value) {\n\t\t\t\treturn i;\n\t\t\t} \n\t\t}\n\t\treturn -1;\n\t},\n\textend: function(o1, o2, preventOverwrite) {\n\t\tfor (var prop in o2) {\n\t\t\tif (o2.hasOwnProperty(prop)) {\n\t\t\t\tif(preventOverwrite && o1.hasOwnProperty(prop)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\to1[prop] = o2[prop];\n\t\t\t}\n\t\t}\n\t},\n\teasing: {\n\t\tsine: {\n\t\t\tout: function(k) {\n\t\t\t\treturn Math.sin(k * (Math.PI / 2));\n\t\t\t},\n\t\t\tinOut: function(k) {\n\t\t\t\treturn - (Math.cos(Math.PI * k) - 1) / 2;\n\t\t\t}\n\t\t},\n\t\tcubic: {\n\t\t\tout: function(k) {\n\t\t\t\treturn --k * k * k + 1;\n\t\t\t}\n\t\t}\n\t\t/*\n\t\t\telastic: {\n\t\t\t\tout: function ( k ) {\n\n\t\t\t\t\tvar s, a = 0.1, p = 0.4;\n\t\t\t\t\tif ( k === 0 ) return 0;\n\t\t\t\t\tif ( k === 1 ) return 1;\n\t\t\t\t\tif ( !a || a < 1 ) { a = 1; s = p / 4; }\n\t\t\t\t\telse s = p * Math.asin( 1 / a ) / ( 2 * Math.PI );\n\t\t\t\t\treturn ( a * Math.pow( 2, - 10 * k) * Math.sin( ( k - s ) * ( 2 * Math.PI ) / p ) + 1 );\n\n\t\t\t\t},\n\t\t\t},\n\t\t\tback: {\n\t\t\t\tout: function ( k ) {\n\t\t\t\t\tvar s = 1.70158;\n\t\t\t\t\treturn --k * k * ( ( s + 1 ) * k + s ) + 1;\n\t\t\t\t}\n\t\t\t}\n\t\t*/\n\t},\n\n\t/**\n\t * \n\t * @return {object}\n\t * \n\t * {\n\t *  raf : request animation frame function\n\t *  caf : cancel animation frame function\n\t *  transfrom : transform property key (with vendor), or null if not supported\n\t *  oldIE : IE8 or below\n\t * }\n\t * \n\t */\n\tdetectFeatures: function() {\n\t\tif(framework.features) {\n\t\t\treturn framework.features;\n\t\t}\n\t\tvar helperEl = framework.createEl(),\n\t\t\thelperStyle = helperEl.style,\n\t\t\tvendor = '',\n\t\t\tfeatures = {};\n\n\t\t// IE8 and below\n\t\tfeatures.oldIE = document.all && !document.addEventListener;\n\n\t\tfeatures.touch = 'ontouchstart' in window;\n\n\t\tif(window.requestAnimationFrame) {\n\t\t\tfeatures.raf = window.requestAnimationFrame;\n\t\t\tfeatures.caf = window.cancelAnimationFrame;\n\t\t}\n\n\t\tfeatures.pointerEvent = !!(window.PointerEvent) || navigator.msPointerEnabled;\n\n\t\t// fix false-positive detection of old Android in new IE\n\t\t// (IE11 ua string contains \"Android 4.0\")\n\t\t\n\t\tif(!features.pointerEvent) { \n\n\t\t\tvar ua = navigator.userAgent;\n\n\t\t\t// Detect if device is iPhone or iPod and if it's older than iOS 8\n\t\t\t// http://stackoverflow.com/a/14223920\n\t\t\t// \n\t\t\t// This detection is made because of buggy top/bottom toolbars\n\t\t\t// that don't trigger window.resize event.\n\t\t\t// For more info refer to _isFixedPosition variable in core.js\n\n\t\t\tif (/iP(hone|od)/.test(navigator.platform)) {\n\t\t\t\tvar v = (navigator.appVersion).match(/OS (\\d+)_(\\d+)_?(\\d+)?/);\n\t\t\t\tif(v && v.length > 0) {\n\t\t\t\t\tv = parseInt(v[1], 10);\n\t\t\t\t\tif(v >= 1 && v < 8 ) {\n\t\t\t\t\t\tfeatures.isOldIOSPhone = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Detect old Android (before KitKat)\n\t\t\t// due to bugs related to position:fixed\n\t\t\t// http://stackoverflow.com/questions/7184573/pick-up-the-android-version-in-the-browser-by-javascript\n\t\t\t\n\t\t\tvar match = ua.match(/Android\\s([0-9\\.]*)/);\n\t\t\tvar androidversion =  match ? match[1] : 0;\n\t\t\tandroidversion = parseFloat(androidversion);\n\t\t\tif(androidversion >= 1 ) {\n\t\t\t\tif(androidversion < 4.4) {\n\t\t\t\t\tfeatures.isOldAndroid = true; // for fixed position bug & performance\n\t\t\t\t}\n\t\t\t\tfeatures.androidVersion = androidversion; // for touchend bug\n\t\t\t}\t\n\t\t\tfeatures.isMobileOpera = /opera mini|opera mobi/i.test(ua);\n\n\t\t\t// p.s. yes, yes, UA sniffing is bad, propose your solution for above bugs.\n\t\t}\n\t\t\n\t\tvar styleChecks = ['transform', 'perspective', 'animationName'],\n\t\t\tvendors = ['', 'webkit','Moz','ms','O'],\n\t\t\tstyleCheckItem,\n\t\t\tstyleName;\n\n\t\tfor(var i = 0; i < 4; i++) {\n\t\t\tvendor = vendors[i];\n\n\t\t\tfor(var a = 0; a < 3; a++) {\n\t\t\t\tstyleCheckItem = styleChecks[a];\n\n\t\t\t\t// uppercase first letter of property name, if vendor is present\n\t\t\t\tstyleName = vendor + (vendor ? \n\t\t\t\t\t\t\t\t\t\tstyleCheckItem.charAt(0).toUpperCase() + styleCheckItem.slice(1) : \n\t\t\t\t\t\t\t\t\t\tstyleCheckItem);\n\t\t\t\n\t\t\t\tif(!features[styleCheckItem] && styleName in helperStyle ) {\n\t\t\t\t\tfeatures[styleCheckItem] = styleName;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(vendor && !features.raf) {\n\t\t\t\tvendor = vendor.toLowerCase();\n\t\t\t\tfeatures.raf = window[vendor+'RequestAnimationFrame'];\n\t\t\t\tif(features.raf) {\n\t\t\t\t\tfeatures.caf = window[vendor+'CancelAnimationFrame'] || \n\t\t\t\t\t\t\t\t\twindow[vendor+'CancelRequestAnimationFrame'];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\t\n\t\tif(!features.raf) {\n\t\t\tvar lastTime = 0;\n\t\t\tfeatures.raf = function(fn) {\n\t\t\t\tvar currTime = new Date().getTime();\n\t\t\t\tvar timeToCall = Math.max(0, 16 - (currTime - lastTime));\n\t\t\t\tvar id = window.setTimeout(function() { fn(currTime + timeToCall); }, timeToCall);\n\t\t\t\tlastTime = currTime + timeToCall;\n\t\t\t\treturn id;\n\t\t\t};\n\t\t\tfeatures.caf = function(id) { clearTimeout(id); };\n\t\t}\n\n\t\t// Detect SVG support\n\t\tfeatures.svg = !!document.createElementNS && \n\t\t\t\t\t\t!!document.createElementNS('http://www.w3.org/2000/svg', 'svg').createSVGRect;\n\n\t\tframework.features = features;\n\n\t\treturn features;\n\t}\n};\n\nframework.detectFeatures();\n\n// Override addEventListener for old versions of IE\nif(framework.features.oldIE) {\n\n\tframework.bind = function(target, type, listener, unbind) {\n\t\t\n\t\ttype = type.split(' ');\n\n\t\tvar methodName = (unbind ? 'detach' : 'attach') + 'Event',\n\t\t\tevName,\n\t\t\t_handleEv = function() {\n\t\t\t\tlistener.handleEvent.call(listener);\n\t\t\t};\n\n\t\tfor(var i = 0; i < type.length; i++) {\n\t\t\tevName = type[i];\n\t\t\tif(evName) {\n\n\t\t\t\tif(typeof listener === 'object' && listener.handleEvent) {\n\t\t\t\t\tif(!unbind) {\n\t\t\t\t\t\tlistener['oldIE' + evName] = _handleEv;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif(!listener['oldIE' + evName]) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\ttarget[methodName]( 'on' + evName, listener['oldIE' + evName]);\n\t\t\t\t} else {\n\t\t\t\t\ttarget[methodName]( 'on' + evName, listener);\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t};\n\t\n}\n\n/*>>framework-bridge*/\n\n/*>>core*/\n//function(template, UiClass, items, options)\n\nvar self = this;\n\n/**\n * Static vars, don't change unless you know what you're doing.\n */\nvar DOUBLE_TAP_RADIUS = 25, \n\tNUM_HOLDERS = 3;\n\n/**\n * Options\n */\nvar _options = {\n\tallowPanToNext:true,\n\tspacing: 0.12,\n\tbgOpacity: 1,\n\tmouseUsed: false,\n\tloop: true,\n\tpinchToClose: true,\n\tcloseOnScroll: true,\n\tcloseOnVerticalDrag: true,\n\tverticalDragRange: 0.75,\n\thideAnimationDuration: 333,\n\tshowAnimationDuration: 333,\n\tshowHideOpacity: false,\n\tfocus: true,\n\tescKey: true,\n\tarrowKeys: true,\n\tmainScrollEndFriction: 0.35,\n\tpanEndFriction: 0.35,\n\tisClickableElement: function(el) {\n        return el.tagName === 'A';\n    },\n    getDoubleTapZoom: function(isMouseClick, item) {\n    \tif(isMouseClick) {\n    \t\treturn 1;\n    \t} else {\n    \t\treturn item.initialZoomLevel < 0.7 ? 1 : 1.33;\n    \t}\n    },\n    maxSpreadZoom: 1.33,\n\tmodal: true,\n\n\t// not fully implemented yet\n\tscaleMode: 'fit' // TODO\n};\nframework.extend(_options, options);\n\n\n/**\n * Private helper variables & functions\n */\n\nvar _getEmptyPoint = function() { \n\t\treturn {x:0,y:0}; \n\t};\n\nvar _isOpen,\n\t_isDestroying,\n\t_closedByScroll,\n\t_currentItemIndex,\n\t_containerStyle,\n\t_containerShiftIndex,\n\t_currPanDist = _getEmptyPoint(),\n\t_startPanOffset = _getEmptyPoint(),\n\t_panOffset = _getEmptyPoint(),\n\t_upMoveEvents, // drag move, drag end & drag cancel events array\n\t_downEvents, // drag start events array\n\t_globalEventHandlers,\n\t_viewportSize = {},\n\t_currZoomLevel,\n\t_startZoomLevel,\n\t_translatePrefix,\n\t_translateSufix,\n\t_updateSizeInterval,\n\t_itemsNeedUpdate,\n\t_currPositionIndex = 0,\n\t_offset = {},\n\t_slideSize = _getEmptyPoint(), // size of slide area, including spacing\n\t_itemHolders,\n\t_prevItemIndex,\n\t_indexDiff = 0, // difference of indexes since last content update\n\t_dragStartEvent,\n\t_dragMoveEvent,\n\t_dragEndEvent,\n\t_dragCancelEvent,\n\t_transformKey,\n\t_pointerEventEnabled,\n\t_isFixedPosition = true,\n\t_likelyTouchDevice,\n\t_modules = [],\n\t_requestAF,\n\t_cancelAF,\n\t_initalClassName,\n\t_initalWindowScrollY,\n\t_oldIE,\n\t_currentWindowScrollY,\n\t_features,\n\t_windowVisibleSize = {},\n\t_renderMaxResolution = false,\n\t_orientationChangeTimeout,\n\n\n\t// Registers PhotoSWipe module (History, Controller ...)\n\t_registerModule = function(name, module) {\n\t\tframework.extend(self, module.publicMethods);\n\t\t_modules.push(name);\n\t},\n\n\t_getLoopedId = function(index) {\n\t\tvar numSlides = _getNumItems();\n\t\tif(index > numSlides - 1) {\n\t\t\treturn index - numSlides;\n\t\t} else  if(index < 0) {\n\t\t\treturn numSlides + index;\n\t\t}\n\t\treturn index;\n\t},\n\t\n\t// Micro bind/trigger\n\t_listeners = {},\n\t_listen = function(name, fn) {\n\t\tif(!_listeners[name]) {\n\t\t\t_listeners[name] = [];\n\t\t}\n\t\treturn _listeners[name].push(fn);\n\t},\n\t_shout = function(name) {\n\t\tvar listeners = _listeners[name];\n\n\t\tif(listeners) {\n\t\t\tvar args = Array.prototype.slice.call(arguments);\n\t\t\targs.shift();\n\n\t\t\tfor(var i = 0; i < listeners.length; i++) {\n\t\t\t\tlisteners[i].apply(self, args);\n\t\t\t}\n\t\t}\n\t},\n\n\t_getCurrentTime = function() {\n\t\treturn new Date().getTime();\n\t},\n\t_applyBgOpacity = function(opacity) {\n\t\t_bgOpacity = opacity;\n\t\tself.bg.style.opacity = opacity * _options.bgOpacity;\n\t},\n\n\t_applyZoomTransform = function(styleObj,x,y,zoom,item) {\n\t\tif(!_renderMaxResolution || (item && item !== self.currItem) ) {\n\t\t\tzoom = zoom / (item ? item.fitRatio : self.currItem.fitRatio);\t\n\t\t}\n\t\t\t\n\t\tstyleObj[_transformKey] = _translatePrefix + x + 'px, ' + y + 'px' + _translateSufix + ' scale(' + zoom + ')';\n\t},\n\t_applyCurrentZoomPan = function( allowRenderResolution ) {\n\t\tif(_currZoomElementStyle) {\n\n\t\t\tif(allowRenderResolution) {\n\t\t\t\tif(_currZoomLevel > self.currItem.fitRatio) {\n\t\t\t\t\tif(!_renderMaxResolution) {\n\t\t\t\t\t\t_setImageSize(self.currItem, false, true);\n\t\t\t\t\t\t_renderMaxResolution = true;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif(_renderMaxResolution) {\n\t\t\t\t\t\t_setImageSize(self.currItem);\n\t\t\t\t\t\t_renderMaxResolution = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\n\t\t\t_applyZoomTransform(_currZoomElementStyle, _panOffset.x, _panOffset.y, _currZoomLevel);\n\t\t}\n\t},\n\t_applyZoomPanToItem = function(item) {\n\t\tif(item.container) {\n\n\t\t\t_applyZoomTransform(item.container.style, \n\t\t\t\t\t\t\t\titem.initialPosition.x, \n\t\t\t\t\t\t\t\titem.initialPosition.y, \n\t\t\t\t\t\t\t\titem.initialZoomLevel,\n\t\t\t\t\t\t\t\titem);\n\t\t}\n\t},\n\t_setTranslateX = function(x, elStyle) {\n\t\telStyle[_transformKey] = _translatePrefix + x + 'px, 0px' + _translateSufix;\n\t},\n\t_moveMainScroll = function(x, dragging) {\n\n\t\tif(!_options.loop && dragging) {\n\t\t\tvar newSlideIndexOffset = _currentItemIndex + (_slideSize.x * _currPositionIndex - x) / _slideSize.x,\n\t\t\t\tdelta = Math.round(x - _mainScrollPos.x);\n\n\t\t\tif( (newSlideIndexOffset < 0 && delta > 0) || \n\t\t\t\t(newSlideIndexOffset >= _getNumItems() - 1 && delta < 0) ) {\n\t\t\t\tx = _mainScrollPos.x + delta * _options.mainScrollEndFriction;\n\t\t\t} \n\t\t}\n\t\t\n\t\t_mainScrollPos.x = x;\n\t\t_setTranslateX(x, _containerStyle);\n\t},\n\t_calculatePanOffset = function(axis, zoomLevel) {\n\t\tvar m = _midZoomPoint[axis] - _offset[axis];\n\t\treturn _startPanOffset[axis] + _currPanDist[axis] + m - m * ( zoomLevel / _startZoomLevel );\n\t},\n\t\n\t_equalizePoints = function(p1, p2) {\n\t\tp1.x = p2.x;\n\t\tp1.y = p2.y;\n\t\tif(p2.id) {\n\t\t\tp1.id = p2.id;\n\t\t}\n\t},\n\t_roundPoint = function(p) {\n\t\tp.x = Math.round(p.x);\n\t\tp.y = Math.round(p.y);\n\t},\n\n\t_mouseMoveTimeout = null,\n\t_onFirstMouseMove = function() {\n\t\t// Wait until mouse move event is fired at least twice during 100ms\n\t\t// We do this, because some mobile browsers trigger it on touchstart\n\t\tif(_mouseMoveTimeout ) { \n\t\t\tframework.unbind(document, 'mousemove', _onFirstMouseMove);\n\t\t\tframework.addClass(template, 'pswp--has_mouse');\n\t\t\t_options.mouseUsed = true;\n\t\t\t_shout('mouseUsed');\n\t\t}\n\t\t_mouseMoveTimeout = setTimeout(function() {\n\t\t\t_mouseMoveTimeout = null;\n\t\t}, 100);\n\t},\n\n\t_bindEvents = function() {\n\t\tframework.bind(document, 'keydown', self);\n\n\t\tif(_features.transform) {\n\t\t\t// don't bind click event in browsers that don't support transform (mostly IE8)\n\t\t\tframework.bind(self.scrollWrap, 'click', self);\n\t\t}\n\t\t\n\n\t\tif(!_options.mouseUsed) {\n\t\t\tframework.bind(document, 'mousemove', _onFirstMouseMove);\n\t\t}\n\n\t\tframework.bind(window, 'resize scroll orientationchange', self);\n\n\t\t_shout('bindEvents');\n\t},\n\n\t_unbindEvents = function() {\n\t\tframework.unbind(window, 'resize scroll orientationchange', self);\n\t\tframework.unbind(window, 'scroll', _globalEventHandlers.scroll);\n\t\tframework.unbind(document, 'keydown', self);\n\t\tframework.unbind(document, 'mousemove', _onFirstMouseMove);\n\n\t\tif(_features.transform) {\n\t\t\tframework.unbind(self.scrollWrap, 'click', self);\n\t\t}\n\n\t\tif(_isDragging) {\n\t\t\tframework.unbind(window, _upMoveEvents, self);\n\t\t}\n\n\t\tclearTimeout(_orientationChangeTimeout);\n\n\t\t_shout('unbindEvents');\n\t},\n\t\n\t_calculatePanBounds = function(zoomLevel, update) {\n\t\tvar bounds = _calculateItemSize( self.currItem, _viewportSize, zoomLevel );\n\t\tif(update) {\n\t\t\t_currPanBounds = bounds;\n\t\t}\n\t\treturn bounds;\n\t},\n\t\n\t_getMinZoomLevel = function(item) {\n\t\tif(!item) {\n\t\t\titem = self.currItem;\n\t\t}\n\t\treturn item.initialZoomLevel;\n\t},\n\t_getMaxZoomLevel = function(item) {\n\t\tif(!item) {\n\t\t\titem = self.currItem;\n\t\t}\n\t\treturn item.w > 0 ? _options.maxSpreadZoom : 1;\n\t},\n\n\t// Return true if offset is out of the bounds\n\t_modifyDestPanOffset = function(axis, destPanBounds, destPanOffset, destZoomLevel) {\n\t\tif(destZoomLevel === self.currItem.initialZoomLevel) {\n\t\t\tdestPanOffset[axis] = self.currItem.initialPosition[axis];\n\t\t\treturn true;\n\t\t} else {\n\t\t\tdestPanOffset[axis] = _calculatePanOffset(axis, destZoomLevel); \n\n\t\t\tif(destPanOffset[axis] > destPanBounds.min[axis]) {\n\t\t\t\tdestPanOffset[axis] = destPanBounds.min[axis];\n\t\t\t\treturn true;\n\t\t\t} else if(destPanOffset[axis] < destPanBounds.max[axis] ) {\n\t\t\t\tdestPanOffset[axis] = destPanBounds.max[axis];\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t},\n\n\t_setupTransforms = function() {\n\n\t\tif(_transformKey) {\n\t\t\t// setup 3d transforms\n\t\t\tvar allow3dTransform = _features.perspective && !_likelyTouchDevice;\n\t\t\t_translatePrefix = 'translate' + (allow3dTransform ? '3d(' : '(');\n\t\t\t_translateSufix = _features.perspective ? ', 0px)' : ')';\t\n\t\t\treturn;\n\t\t}\n\n\t\t// Override zoom/pan/move functions in case old browser is used (most likely IE)\n\t\t// (so they use left/top/width/height, instead of CSS transform)\n\t\n\t\t_transformKey = 'left';\n\t\tframework.addClass(template, 'pswp--ie');\n\n\t\t_setTranslateX = function(x, elStyle) {\n\t\t\telStyle.left = x + 'px';\n\t\t};\n\t\t_applyZoomPanToItem = function(item) {\n\n\t\t\tvar zoomRatio = item.fitRatio > 1 ? 1 : item.fitRatio,\n\t\t\t\ts = item.container.style,\n\t\t\t\tw = zoomRatio * item.w,\n\t\t\t\th = zoomRatio * item.h;\n\n\t\t\ts.width = w + 'px';\n\t\t\ts.height = h + 'px';\n\t\t\ts.left = item.initialPosition.x + 'px';\n\t\t\ts.top = item.initialPosition.y + 'px';\n\n\t\t};\n\t\t_applyCurrentZoomPan = function() {\n\t\t\tif(_currZoomElementStyle) {\n\n\t\t\t\tvar s = _currZoomElementStyle,\n\t\t\t\t\titem = self.currItem,\n\t\t\t\t\tzoomRatio = item.fitRatio > 1 ? 1 : item.fitRatio,\n\t\t\t\t\tw = zoomRatio * item.w,\n\t\t\t\t\th = zoomRatio * item.h;\n\n\t\t\t\ts.width = w + 'px';\n\t\t\t\ts.height = h + 'px';\n\n\n\t\t\t\ts.left = _panOffset.x + 'px';\n\t\t\t\ts.top = _panOffset.y + 'px';\n\t\t\t}\n\t\t\t\n\t\t};\n\t},\n\n\t_onKeyDown = function(e) {\n\t\tvar keydownAction = '';\n\t\tif(_options.escKey && e.keyCode === 27) { \n\t\t\tkeydownAction = 'close';\n\t\t} else if(_options.arrowKeys) {\n\t\t\tif(e.keyCode === 37) {\n\t\t\t\tkeydownAction = 'prev';\n\t\t\t} else if(e.keyCode === 39) { \n\t\t\t\tkeydownAction = 'next';\n\t\t\t}\n\t\t}\n\n\t\tif(keydownAction) {\n\t\t\t// don't do anything if special key pressed to prevent from overriding default browser actions\n\t\t\t// e.g. in Chrome on Mac cmd+arrow-left returns to previous page\n\t\t\tif( !e.ctrlKey && !e.altKey && !e.shiftKey && !e.metaKey ) {\n\t\t\t\tif(e.preventDefault) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t} else {\n\t\t\t\t\te.returnValue = false;\n\t\t\t\t} \n\t\t\t\tself[keydownAction]();\n\t\t\t}\n\t\t}\n\t},\n\n\t_onGlobalClick = function(e) {\n\t\tif(!e) {\n\t\t\treturn;\n\t\t}\n\n\t\t// don't allow click event to pass through when triggering after drag or some other gesture\n\t\tif(_moved || _zoomStarted || _mainScrollAnimating || _verticalDragInitiated) {\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t}\n\t},\n\n\t_updatePageScrollOffset = function() {\n\t\tself.setScrollOffset(0, framework.getScrollY());\t\t\n\t};\n\t\n\n\n\t\n\n\n\n// Micro animation engine\nvar _animations = {},\n\t_numAnimations = 0,\n\t_stopAnimation = function(name) {\n\t\tif(_animations[name]) {\n\t\t\tif(_animations[name].raf) {\n\t\t\t\t_cancelAF( _animations[name].raf );\n\t\t\t}\n\t\t\t_numAnimations--;\n\t\t\tdelete _animations[name];\n\t\t}\n\t},\n\t_registerStartAnimation = function(name) {\n\t\tif(_animations[name]) {\n\t\t\t_stopAnimation(name);\n\t\t}\n\t\tif(!_animations[name]) {\n\t\t\t_numAnimations++;\n\t\t\t_animations[name] = {};\n\t\t}\n\t},\n\t_stopAllAnimations = function() {\n\t\tfor (var prop in _animations) {\n\n\t\t\tif( _animations.hasOwnProperty( prop ) ) {\n\t\t\t\t_stopAnimation(prop);\n\t\t\t} \n\t\t\t\n\t\t}\n\t},\n\t_animateProp = function(name, b, endProp, d, easingFn, onUpdate, onComplete) {\n\t\tvar startAnimTime = _getCurrentTime(), t;\n\t\t_registerStartAnimation(name);\n\n\t\tvar animloop = function(){\n\t\t\tif ( _animations[name] ) {\n\t\t\t\t\n\t\t\t\tt = _getCurrentTime() - startAnimTime; // time diff\n\t\t\t\t//b - beginning (start prop)\n\t\t\t\t//d - anim duration\n\n\t\t\t\tif ( t >= d ) {\n\t\t\t\t\t_stopAnimation(name);\n\t\t\t\t\tonUpdate(endProp);\n\t\t\t\t\tif(onComplete) {\n\t\t\t\t\t\tonComplete();\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tonUpdate( (endProp - b) * easingFn(t/d) + b );\n\n\t\t\t\t_animations[name].raf = _requestAF(animloop);\n\t\t\t}\n\t\t};\n\t\tanimloop();\n\t};\n\t\n\n\nvar publicMethods = {\n\n\t// make a few local variables and functions public\n\tshout: _shout,\n\tlisten: _listen,\n\tviewportSize: _viewportSize,\n\toptions: _options,\n\n\tisMainScrollAnimating: function() {\n\t\treturn _mainScrollAnimating;\n\t},\n\tgetZoomLevel: function() {\n\t\treturn _currZoomLevel;\n\t},\n\tgetCurrentIndex: function() {\n\t\treturn _currentItemIndex;\n\t},\n\tisDragging: function() {\n\t\treturn _isDragging;\n\t},\t\n\tisZooming: function() {\n\t\treturn _isZooming;\n\t},\n\tsetScrollOffset: function(x,y) {\n\t\t_offset.x = x;\n\t\t_currentWindowScrollY = _offset.y = y;\n\t\t_shout('updateScrollOffset', _offset);\n\t},\n\tapplyZoomPan: function(zoomLevel,panX,panY,allowRenderResolution) {\n\t\t_panOffset.x = panX;\n\t\t_panOffset.y = panY;\n\t\t_currZoomLevel = zoomLevel;\n\t\t_applyCurrentZoomPan( allowRenderResolution );\n\t},\n\n\tinit: function() {\n\n\t\tif(_isOpen || _isDestroying) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar i;\n\n\t\tself.framework = framework; // basic functionality\n\t\tself.template = template; // root DOM element of PhotoSwipe\n\t\tself.bg = framework.getChildByClass(template, 'pswp__bg');\n\n\t\t_initalClassName = template.className;\n\t\t_isOpen = true;\n\t\t\t\t\n\t\t_features = framework.detectFeatures();\n\t\t_requestAF = _features.raf;\n\t\t_cancelAF = _features.caf;\n\t\t_transformKey = _features.transform;\n\t\t_oldIE = _features.oldIE;\n\t\t\n\t\tself.scrollWrap = framework.getChildByClass(template, 'pswp__scroll-wrap');\n\t\tself.container = framework.getChildByClass(self.scrollWrap, 'pswp__container');\n\n\t\t_containerStyle = self.container.style; // for fast access\n\n\t\t// Objects that hold slides (there are only 3 in DOM)\n\t\tself.itemHolders = _itemHolders = [\n\t\t\t{el:self.container.children[0] , wrap:0, index: -1},\n\t\t\t{el:self.container.children[1] , wrap:0, index: -1},\n\t\t\t{el:self.container.children[2] , wrap:0, index: -1}\n\t\t];\n\n\t\t// hide nearby item holders until initial zoom animation finishes (to avoid extra Paints)\n\t\t_itemHolders[0].el.style.display = _itemHolders[2].el.style.display = 'none';\n\n\t\t_setupTransforms();\n\n\t\t// Setup global events\n\t\t_globalEventHandlers = {\n\t\t\tresize: self.updateSize,\n\n\t\t\t// Fixes: iOS 10.3 resize event\n\t\t\t// does not update scrollWrap.clientWidth instantly after resize\n\t\t\t// https://github.com/dimsemenov/PhotoSwipe/issues/1315\n\t\t\torientationchange: function() {\n\t\t\t\tclearTimeout(_orientationChangeTimeout);\n\t\t\t\t_orientationChangeTimeout = setTimeout(function() {\n\t\t\t\t\tif(_viewportSize.x !== self.scrollWrap.clientWidth) {\n\t\t\t\t\t\tself.updateSize();\n\t\t\t\t\t}\n\t\t\t\t}, 500);\n\t\t\t},\n\t\t\tscroll: _updatePageScrollOffset,\n\t\t\tkeydown: _onKeyDown,\n\t\t\tclick: _onGlobalClick\n\t\t};\n\n\t\t// disable show/hide effects on old browsers that don't support CSS animations or transforms, \n\t\t// old IOS, Android and Opera mobile. Blackberry seems to work fine, even older models.\n\t\tvar oldPhone = _features.isOldIOSPhone || _features.isOldAndroid || _features.isMobileOpera;\n\t\tif(!_features.animationName || !_features.transform || oldPhone) {\n\t\t\t_options.showAnimationDuration = _options.hideAnimationDuration = 0;\n\t\t}\n\n\t\t// init modules\n\t\tfor(i = 0; i < _modules.length; i++) {\n\t\t\tself['init' + _modules[i]]();\n\t\t}\n\t\t\n\t\t// init\n\t\tif(UiClass) {\n\t\t\tvar ui = self.ui = new UiClass(self, framework);\n\t\t\tui.init();\n\t\t}\n\n\t\t_shout('firstUpdate');\n\t\t_currentItemIndex = _currentItemIndex || _options.index || 0;\n\t\t// validate index\n\t\tif( isNaN(_currentItemIndex) || _currentItemIndex < 0 || _currentItemIndex >= _getNumItems() ) {\n\t\t\t_currentItemIndex = 0;\n\t\t}\n\t\tself.currItem = _getItemAt( _currentItemIndex );\n\n\t\t\n\t\tif(_features.isOldIOSPhone || _features.isOldAndroid) {\n\t\t\t_isFixedPosition = false;\n\t\t}\n\t\t\n\t\ttemplate.setAttribute('aria-hidden', 'false');\n\t\tif(_options.modal) {\n\t\t\tif(!_isFixedPosition) {\n\t\t\t\ttemplate.style.position = 'absolute';\n\t\t\t\ttemplate.style.top = framework.getScrollY() + 'px';\n\t\t\t} else {\n\t\t\t\ttemplate.style.position = 'fixed';\n\t\t\t}\n\t\t}\n\n\t\tif(_currentWindowScrollY === undefined) {\n\t\t\t_shout('initialLayout');\n\t\t\t_currentWindowScrollY = _initalWindowScrollY = framework.getScrollY();\n\t\t}\n\t\t\n\t\t// add classes to root element of PhotoSwipe\n\t\tvar rootClasses = 'pswp--open ';\n\t\tif(_options.mainClass) {\n\t\t\trootClasses += _options.mainClass + ' ';\n\t\t}\n\t\tif(_options.showHideOpacity) {\n\t\t\trootClasses += 'pswp--animate_opacity ';\n\t\t}\n\t\trootClasses += _likelyTouchDevice ? 'pswp--touch' : 'pswp--notouch';\n\t\trootClasses += _features.animationName ? ' pswp--css_animation' : '';\n\t\trootClasses += _features.svg ? ' pswp--svg' : '';\n\t\tframework.addClass(template, rootClasses);\n\n\t\tself.updateSize();\n\n\t\t// initial update\n\t\t_containerShiftIndex = -1;\n\t\t_indexDiff = null;\n\t\tfor(i = 0; i < NUM_HOLDERS; i++) {\n\t\t\t_setTranslateX( (i+_containerShiftIndex) * _slideSize.x, _itemHolders[i].el.style);\n\t\t}\n\n\t\tif(!_oldIE) {\n\t\t\tframework.bind(self.scrollWrap, _downEvents, self); // no dragging for old IE\n\t\t}\t\n\n\t\t_listen('initialZoomInEnd', function() {\n\t\t\tself.setContent(_itemHolders[0], _currentItemIndex-1);\n\t\t\tself.setContent(_itemHolders[2], _currentItemIndex+1);\n\n\t\t\t_itemHolders[0].el.style.display = _itemHolders[2].el.style.display = 'block';\n\n\t\t\tif(_options.focus) {\n\t\t\t\t// focus causes layout, \n\t\t\t\t// which causes lag during the animation, \n\t\t\t\t// that's why we delay it untill the initial zoom transition ends\n\t\t\t\ttemplate.focus();\n\t\t\t}\n\t\t\t \n\n\t\t\t_bindEvents();\n\t\t});\n\n\t\t// set content for center slide (first time)\n\t\tself.setContent(_itemHolders[1], _currentItemIndex);\n\t\t\n\t\tself.updateCurrItem();\n\n\t\t_shout('afterInit');\n\n\t\tif(!_isFixedPosition) {\n\n\t\t\t// On all versions of iOS lower than 8.0, we check size of viewport every second.\n\t\t\t// \n\t\t\t// This is done to detect when Safari top & bottom bars appear, \n\t\t\t// as this action doesn't trigger any events (like resize). \n\t\t\t// \n\t\t\t// On iOS8 they fixed this.\n\t\t\t// \n\t\t\t// 10 Nov 2014: iOS 7 usage ~40%. iOS 8 usage 56%.\n\t\t\t\n\t\t\t_updateSizeInterval = setInterval(function() {\n\t\t\t\tif(!_numAnimations && !_isDragging && !_isZooming && (_currZoomLevel === self.currItem.initialZoomLevel)  ) {\n\t\t\t\t\tself.updateSize();\n\t\t\t\t}\n\t\t\t}, 1000);\n\t\t}\n\n\t\tframework.addClass(template, 'pswp--visible');\n\t},\n\n\t// Close the gallery, then destroy it\n\tclose: function() {\n\t\tif(!_isOpen) {\n\t\t\treturn;\n\t\t}\n\n\t\t_isOpen = false;\n\t\t_isDestroying = true;\n\t\t_shout('close');\n\t\t_unbindEvents();\n\n\t\t_showOrHide(self.currItem, null, true, self.destroy);\n\t},\n\n\t// destroys the gallery (unbinds events, cleans up intervals and timeouts to avoid memory leaks)\n\tdestroy: function() {\n\t\t_shout('destroy');\n\n\t\tif(_showOrHideTimeout) {\n\t\t\tclearTimeout(_showOrHideTimeout);\n\t\t}\n\t\t\n\t\ttemplate.setAttribute('aria-hidden', 'true');\n\t\ttemplate.className = _initalClassName;\n\n\t\tif(_updateSizeInterval) {\n\t\t\tclearInterval(_updateSizeInterval);\n\t\t}\n\n\t\tframework.unbind(self.scrollWrap, _downEvents, self);\n\n\t\t// we unbind scroll event at the end, as closing animation may depend on it\n\t\tframework.unbind(window, 'scroll', self);\n\n\t\t_stopDragUpdateLoop();\n\n\t\t_stopAllAnimations();\n\n\t\t_listeners = null;\n\t},\n\n\t/**\n\t * Pan image to position\n\t * @param {Number} x     \n\t * @param {Number} y     \n\t * @param {Boolean} force Will ignore bounds if set to true.\n\t */\n\tpanTo: function(x,y,force) {\n\t\tif(!force) {\n\t\t\tif(x > _currPanBounds.min.x) {\n\t\t\t\tx = _currPanBounds.min.x;\n\t\t\t} else if(x < _currPanBounds.max.x) {\n\t\t\t\tx = _currPanBounds.max.x;\n\t\t\t}\n\n\t\t\tif(y > _currPanBounds.min.y) {\n\t\t\t\ty = _currPanBounds.min.y;\n\t\t\t} else if(y < _currPanBounds.max.y) {\n\t\t\t\ty = _currPanBounds.max.y;\n\t\t\t}\n\t\t}\n\t\t\n\t\t_panOffset.x = x;\n\t\t_panOffset.y = y;\n\t\t_applyCurrentZoomPan();\n\t},\n\t\n\thandleEvent: function (e) {\n\t\te = e || window.event;\n\t\tif(_globalEventHandlers[e.type]) {\n\t\t\t_globalEventHandlers[e.type](e);\n\t\t}\n\t},\n\n\n\tgoTo: function(index) {\n\n\t\tindex = _getLoopedId(index);\n\n\t\tvar diff = index - _currentItemIndex;\n\t\t_indexDiff = diff;\n\n\t\t_currentItemIndex = index;\n\t\tself.currItem = _getItemAt( _currentItemIndex );\n\t\t_currPositionIndex -= diff;\n\t\t\n\t\t_moveMainScroll(_slideSize.x * _currPositionIndex);\n\t\t\n\n\t\t_stopAllAnimations();\n\t\t_mainScrollAnimating = false;\n\n\t\tself.updateCurrItem();\n\t},\n\tnext: function() {\n\t\tself.goTo( _currentItemIndex + 1);\n\t},\n\tprev: function() {\n\t\tself.goTo( _currentItemIndex - 1);\n\t},\n\n\t// update current zoom/pan objects\n\tupdateCurrZoomItem: function(emulateSetContent) {\n\t\tif(emulateSetContent) {\n\t\t\t_shout('beforeChange', 0);\n\t\t}\n\n\t\t// itemHolder[1] is middle (current) item\n\t\tif(_itemHolders[1].el.children.length) {\n\t\t\tvar zoomElement = _itemHolders[1].el.children[0];\n\t\t\tif( framework.hasClass(zoomElement, 'pswp__zoom-wrap') ) {\n\t\t\t\t_currZoomElementStyle = zoomElement.style;\n\t\t\t} else {\n\t\t\t\t_currZoomElementStyle = null;\n\t\t\t}\n\t\t} else {\n\t\t\t_currZoomElementStyle = null;\n\t\t}\n\t\t\n\t\t_currPanBounds = self.currItem.bounds;\t\n\t\t_startZoomLevel = _currZoomLevel = self.currItem.initialZoomLevel;\n\n\t\t_panOffset.x = _currPanBounds.center.x;\n\t\t_panOffset.y = _currPanBounds.center.y;\n\n\t\tif(emulateSetContent) {\n\t\t\t_shout('afterChange');\n\t\t}\n\t},\n\n\n\tinvalidateCurrItems: function() {\n\t\t_itemsNeedUpdate = true;\n\t\tfor(var i = 0; i < NUM_HOLDERS; i++) {\n\t\t\tif( _itemHolders[i].item ) {\n\t\t\t\t_itemHolders[i].item.needsUpdate = true;\n\t\t\t}\n\t\t}\n\t},\n\n\tupdateCurrItem: function(beforeAnimation) {\n\n\t\tif(_indexDiff === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar diffAbs = Math.abs(_indexDiff),\n\t\t\ttempHolder;\n\n\t\tif(beforeAnimation && diffAbs < 2) {\n\t\t\treturn;\n\t\t}\n\n\n\t\tself.currItem = _getItemAt( _currentItemIndex );\n\t\t_renderMaxResolution = false;\n\t\t\n\t\t_shout('beforeChange', _indexDiff);\n\n\t\tif(diffAbs >= NUM_HOLDERS) {\n\t\t\t_containerShiftIndex += _indexDiff + (_indexDiff > 0 ? -NUM_HOLDERS : NUM_HOLDERS);\n\t\t\tdiffAbs = NUM_HOLDERS;\n\t\t}\n\t\tfor(var i = 0; i < diffAbs; i++) {\n\t\t\tif(_indexDiff > 0) {\n\t\t\t\ttempHolder = _itemHolders.shift();\n\t\t\t\t_itemHolders[NUM_HOLDERS-1] = tempHolder; // move first to last\n\n\t\t\t\t_containerShiftIndex++;\n\t\t\t\t_setTranslateX( (_containerShiftIndex+2) * _slideSize.x, tempHolder.el.style);\n\t\t\t\tself.setContent(tempHolder, _currentItemIndex - diffAbs + i + 1 + 1);\n\t\t\t} else {\n\t\t\t\ttempHolder = _itemHolders.pop();\n\t\t\t\t_itemHolders.unshift( tempHolder ); // move last to first\n\n\t\t\t\t_containerShiftIndex--;\n\t\t\t\t_setTranslateX( _containerShiftIndex * _slideSize.x, tempHolder.el.style);\n\t\t\t\tself.setContent(tempHolder, _currentItemIndex + diffAbs - i - 1 - 1);\n\t\t\t}\n\t\t\t\n\t\t}\n\n\t\t// reset zoom/pan on previous item\n\t\tif(_currZoomElementStyle && Math.abs(_indexDiff) === 1) {\n\n\t\t\tvar prevItem = _getItemAt(_prevItemIndex);\n\t\t\tif(prevItem.initialZoomLevel !== _currZoomLevel) {\n\t\t\t\t_calculateItemSize(prevItem , _viewportSize );\n\t\t\t\t_setImageSize(prevItem);\n\t\t\t\t_applyZoomPanToItem( prevItem ); \t\t\t\t\n\t\t\t}\n\n\t\t}\n\n\t\t// reset diff after update\n\t\t_indexDiff = 0;\n\n\t\tself.updateCurrZoomItem();\n\n\t\t_prevItemIndex = _currentItemIndex;\n\n\t\t_shout('afterChange');\n\t\t\n\t},\n\n\n\n\tupdateSize: function(force) {\n\t\t\n\t\tif(!_isFixedPosition && _options.modal) {\n\t\t\tvar windowScrollY = framework.getScrollY();\n\t\t\tif(_currentWindowScrollY !== windowScrollY) {\n\t\t\t\ttemplate.style.top = windowScrollY + 'px';\n\t\t\t\t_currentWindowScrollY = windowScrollY;\n\t\t\t}\n\t\t\tif(!force && _windowVisibleSize.x === window.innerWidth && _windowVisibleSize.y === window.innerHeight) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t_windowVisibleSize.x = window.innerWidth;\n\t\t\t_windowVisibleSize.y = window.innerHeight;\n\n\t\t\t//template.style.width = _windowVisibleSize.x + 'px';\n\t\t\ttemplate.style.height = _windowVisibleSize.y + 'px';\n\t\t}\n\n\n\n\t\t_viewportSize.x = self.scrollWrap.clientWidth;\n\t\t_viewportSize.y = self.scrollWrap.clientHeight;\n\n\t\t_updatePageScrollOffset();\n\n\t\t_slideSize.x = _viewportSize.x + Math.round(_viewportSize.x * _options.spacing);\n\t\t_slideSize.y = _viewportSize.y;\n\n\t\t_moveMainScroll(_slideSize.x * _currPositionIndex);\n\n\t\t_shout('beforeResize'); // even may be used for example to switch image sources\n\n\n\t\t// don't re-calculate size on inital size update\n\t\tif(_containerShiftIndex !== undefined) {\n\n\t\t\tvar holder,\n\t\t\t\titem,\n\t\t\t\thIndex;\n\n\t\t\tfor(var i = 0; i < NUM_HOLDERS; i++) {\n\t\t\t\tholder = _itemHolders[i];\n\t\t\t\t_setTranslateX( (i+_containerShiftIndex) * _slideSize.x, holder.el.style);\n\n\t\t\t\thIndex = _currentItemIndex+i-1;\n\n\t\t\t\tif(_options.loop && _getNumItems() > 2) {\n\t\t\t\t\thIndex = _getLoopedId(hIndex);\n\t\t\t\t}\n\n\t\t\t\t// update zoom level on items and refresh source (if needsUpdate)\n\t\t\t\titem = _getItemAt( hIndex );\n\n\t\t\t\t// re-render gallery item if `needsUpdate`,\n\t\t\t\t// or doesn't have `bounds` (entirely new slide object)\n\t\t\t\tif( item && (_itemsNeedUpdate || item.needsUpdate || !item.bounds) ) {\n\n\t\t\t\t\tself.cleanSlide( item );\n\t\t\t\t\t\n\t\t\t\t\tself.setContent( holder, hIndex );\n\n\t\t\t\t\t// if \"center\" slide\n\t\t\t\t\tif(i === 1) {\n\t\t\t\t\t\tself.currItem = item;\n\t\t\t\t\t\tself.updateCurrZoomItem(true);\n\t\t\t\t\t}\n\n\t\t\t\t\titem.needsUpdate = false;\n\n\t\t\t\t} else if(holder.index === -1 && hIndex >= 0) {\n\t\t\t\t\t// add content first time\n\t\t\t\t\tself.setContent( holder, hIndex );\n\t\t\t\t}\n\t\t\t\tif(item && item.container) {\n\t\t\t\t\t_calculateItemSize(item, _viewportSize);\n\t\t\t\t\t_setImageSize(item);\n\t\t\t\t\t_applyZoomPanToItem( item );\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t\t_itemsNeedUpdate = false;\n\t\t}\t\n\n\t\t_startZoomLevel = _currZoomLevel = self.currItem.initialZoomLevel;\n\t\t_currPanBounds = self.currItem.bounds;\n\n\t\tif(_currPanBounds) {\n\t\t\t_panOffset.x = _currPanBounds.center.x;\n\t\t\t_panOffset.y = _currPanBounds.center.y;\n\t\t\t_applyCurrentZoomPan( true );\n\t\t}\n\t\t\n\t\t_shout('resize');\n\t},\n\t\n\t// Zoom current item to\n\tzoomTo: function(destZoomLevel, centerPoint, speed, easingFn, updateFn) {\n\t\t/*\n\t\t\tif(destZoomLevel === 'fit') {\n\t\t\t\tdestZoomLevel = self.currItem.fitRatio;\n\t\t\t} else if(destZoomLevel === 'fill') {\n\t\t\t\tdestZoomLevel = self.currItem.fillRatio;\n\t\t\t}\n\t\t*/\n\n\t\tif(centerPoint) {\n\t\t\t_startZoomLevel = _currZoomLevel;\n\t\t\t_midZoomPoint.x = Math.abs(centerPoint.x) - _panOffset.x ;\n\t\t\t_midZoomPoint.y = Math.abs(centerPoint.y) - _panOffset.y ;\n\t\t\t_equalizePoints(_startPanOffset, _panOffset);\n\t\t}\n\n\t\tvar destPanBounds = _calculatePanBounds(destZoomLevel, false),\n\t\t\tdestPanOffset = {};\n\n\t\t_modifyDestPanOffset('x', destPanBounds, destPanOffset, destZoomLevel);\n\t\t_modifyDestPanOffset('y', destPanBounds, destPanOffset, destZoomLevel);\n\n\t\tvar initialZoomLevel = _currZoomLevel;\n\t\tvar initialPanOffset = {\n\t\t\tx: _panOffset.x,\n\t\t\ty: _panOffset.y\n\t\t};\n\n\t\t_roundPoint(destPanOffset);\n\n\t\tvar onUpdate = function(now) {\n\t\t\tif(now === 1) {\n\t\t\t\t_currZoomLevel = destZoomLevel;\n\t\t\t\t_panOffset.x = destPanOffset.x;\n\t\t\t\t_panOffset.y = destPanOffset.y;\n\t\t\t} else {\n\t\t\t\t_currZoomLevel = (destZoomLevel - initialZoomLevel) * now + initialZoomLevel;\n\t\t\t\t_panOffset.x = (destPanOffset.x - initialPanOffset.x) * now + initialPanOffset.x;\n\t\t\t\t_panOffset.y = (destPanOffset.y - initialPanOffset.y) * now + initialPanOffset.y;\n\t\t\t}\n\n\t\t\tif(updateFn) {\n\t\t\t\tupdateFn(now);\n\t\t\t}\n\n\t\t\t_applyCurrentZoomPan( now === 1 );\n\t\t};\n\n\t\tif(speed) {\n\t\t\t_animateProp('customZoomTo', 0, 1, speed, easingFn || framework.easing.sine.inOut, onUpdate);\n\t\t} else {\n\t\t\tonUpdate(1);\n\t\t}\n\t}\n\n\n};\n\n\n/*>>core*/\n\n/*>>gestures*/\n/**\n * Mouse/touch/pointer event handlers.\n * \n * separated from @core.js for readability\n */\n\nvar MIN_SWIPE_DISTANCE = 30,\n\tDIRECTION_CHECK_OFFSET = 10; // amount of pixels to drag to determine direction of swipe\n\nvar _gestureStartTime,\n\t_gestureCheckSpeedTime,\n\n\t// pool of objects that are used during dragging of zooming\n\tp = {}, // first point\n\tp2 = {}, // second point (for zoom gesture)\n\tdelta = {},\n\t_currPoint = {},\n\t_startPoint = {},\n\t_currPointers = [],\n\t_startMainScrollPos = {},\n\t_releaseAnimData,\n\t_posPoints = [], // array of points during dragging, used to determine type of gesture\n\t_tempPoint = {},\n\n\t_isZoomingIn,\n\t_verticalDragInitiated,\n\t_oldAndroidTouchEndTimeout,\n\t_currZoomedItemIndex = 0,\n\t_centerPoint = _getEmptyPoint(),\n\t_lastReleaseTime = 0,\n\t_isDragging, // at least one pointer is down\n\t_isMultitouch, // at least two _pointers are down\n\t_zoomStarted, // zoom level changed during zoom gesture\n\t_moved,\n\t_dragAnimFrame,\n\t_mainScrollShifted,\n\t_currentPoints, // array of current touch points\n\t_isZooming,\n\t_currPointsDistance,\n\t_startPointsDistance,\n\t_currPanBounds,\n\t_mainScrollPos = _getEmptyPoint(),\n\t_currZoomElementStyle,\n\t_mainScrollAnimating, // true, if animation after swipe gesture is running\n\t_midZoomPoint = _getEmptyPoint(),\n\t_currCenterPoint = _getEmptyPoint(),\n\t_direction,\n\t_isFirstMove,\n\t_opacityChanged,\n\t_bgOpacity,\n\t_wasOverInitialZoom,\n\n\t_isEqualPoints = function(p1, p2) {\n\t\treturn p1.x === p2.x && p1.y === p2.y;\n\t},\n\t_isNearbyPoints = function(touch0, touch1) {\n\t\treturn Math.abs(touch0.x - touch1.x) < DOUBLE_TAP_RADIUS && Math.abs(touch0.y - touch1.y) < DOUBLE_TAP_RADIUS;\n\t},\n\t_calculatePointsDistance = function(p1, p2) {\n\t\t_tempPoint.x = Math.abs( p1.x - p2.x );\n\t\t_tempPoint.y = Math.abs( p1.y - p2.y );\n\t\treturn Math.sqrt(_tempPoint.x * _tempPoint.x + _tempPoint.y * _tempPoint.y);\n\t},\n\t_stopDragUpdateLoop = function() {\n\t\tif(_dragAnimFrame) {\n\t\t\t_cancelAF(_dragAnimFrame);\n\t\t\t_dragAnimFrame = null;\n\t\t}\n\t},\n\t_dragUpdateLoop = function() {\n\t\tif(_isDragging) {\n\t\t\t_dragAnimFrame = _requestAF(_dragUpdateLoop);\n\t\t\t_renderMovement();\n\t\t}\n\t},\n\t_canPan = function() {\n\t\treturn !(_options.scaleMode === 'fit' && _currZoomLevel ===  self.currItem.initialZoomLevel);\n\t},\n\t\n\t// find the closest parent DOM element\n\t_closestElement = function(el, fn) {\n\t  \tif(!el || el === document) {\n\t  \t\treturn false;\n\t  \t}\n\n\t  \t// don't search elements above pswp__scroll-wrap\n\t  \tif(el.getAttribute('class') && el.getAttribute('class').indexOf('pswp__scroll-wrap') > -1 ) {\n\t  \t\treturn false;\n\t  \t}\n\n\t  \tif( fn(el) ) {\n\t  \t\treturn el;\n\t  \t}\n\n\t  \treturn _closestElement(el.parentNode, fn);\n\t},\n\n\t_preventObj = {},\n\t_preventDefaultEventBehaviour = function(e, isDown) {\n\t    _preventObj.prevent = !_closestElement(e.target, _options.isClickableElement);\n\n\t\t_shout('preventDragEvent', e, isDown, _preventObj);\n\t\treturn _preventObj.prevent;\n\n\t},\n\t_convertTouchToPoint = function(touch, p) {\n\t\tp.x = touch.pageX;\n\t\tp.y = touch.pageY;\n\t\tp.id = touch.identifier;\n\t\treturn p;\n\t},\n\t_findCenterOfPoints = function(p1, p2, pCenter) {\n\t\tpCenter.x = (p1.x + p2.x) * 0.5;\n\t\tpCenter.y = (p1.y + p2.y) * 0.5;\n\t},\n\t_pushPosPoint = function(time, x, y) {\n\t\tif(time - _gestureCheckSpeedTime > 50) {\n\t\t\tvar o = _posPoints.length > 2 ? _posPoints.shift() : {};\n\t\t\to.x = x;\n\t\t\to.y = y; \n\t\t\t_posPoints.push(o);\n\t\t\t_gestureCheckSpeedTime = time;\n\t\t}\n\t},\n\n\t_calculateVerticalDragOpacityRatio = function() {\n\t\tvar yOffset = _panOffset.y - self.currItem.initialPosition.y; // difference between initial and current position\n\t\treturn 1 -  Math.abs( yOffset / (_viewportSize.y / 2)  );\n\t},\n\n\t\n\t// points pool, reused during touch events\n\t_ePoint1 = {},\n\t_ePoint2 = {},\n\t_tempPointsArr = [],\n\t_tempCounter,\n\t_getTouchPoints = function(e) {\n\t\t// clean up previous points, without recreating array\n\t\twhile(_tempPointsArr.length > 0) {\n\t\t\t_tempPointsArr.pop();\n\t\t}\n\n\t\tif(!_pointerEventEnabled) {\n\t\t\tif(e.type.indexOf('touch') > -1) {\n\n\t\t\t\tif(e.touches && e.touches.length > 0) {\n\t\t\t\t\t_tempPointsArr[0] = _convertTouchToPoint(e.touches[0], _ePoint1);\n\t\t\t\t\tif(e.touches.length > 1) {\n\t\t\t\t\t\t_tempPointsArr[1] = _convertTouchToPoint(e.touches[1], _ePoint2);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t} else {\n\t\t\t\t_ePoint1.x = e.pageX;\n\t\t\t\t_ePoint1.y = e.pageY;\n\t\t\t\t_ePoint1.id = '';\n\t\t\t\t_tempPointsArr[0] = _ePoint1;//_ePoint1;\n\t\t\t}\n\t\t} else {\n\t\t\t_tempCounter = 0;\n\t\t\t// we can use forEach, as pointer events are supported only in modern browsers\n\t\t\t_currPointers.forEach(function(p) {\n\t\t\t\tif(_tempCounter === 0) {\n\t\t\t\t\t_tempPointsArr[0] = p;\n\t\t\t\t} else if(_tempCounter === 1) {\n\t\t\t\t\t_tempPointsArr[1] = p;\n\t\t\t\t}\n\t\t\t\t_tempCounter++;\n\n\t\t\t});\n\t\t}\n\t\treturn _tempPointsArr;\n\t},\n\n\t_panOrMoveMainScroll = function(axis, delta) {\n\n\t\tvar panFriction,\n\t\t\toverDiff = 0,\n\t\t\tnewOffset = _panOffset[axis] + delta[axis],\n\t\t\tstartOverDiff,\n\t\t\tdir = delta[axis] > 0,\n\t\t\tnewMainScrollPosition = _mainScrollPos.x + delta.x,\n\t\t\tmainScrollDiff = _mainScrollPos.x - _startMainScrollPos.x,\n\t\t\tnewPanPos,\n\t\t\tnewMainScrollPos;\n\n\t\t// calculate fdistance over the bounds and friction\n\t\tif(newOffset > _currPanBounds.min[axis] || newOffset < _currPanBounds.max[axis]) {\n\t\t\tpanFriction = _options.panEndFriction;\n\t\t\t// Linear increasing of friction, so at 1/4 of viewport it's at max value. \n\t\t\t// Looks not as nice as was expected. Left for history.\n\t\t\t// panFriction = (1 - (_panOffset[axis] + delta[axis] + panBounds.min[axis]) / (_viewportSize[axis] / 4) );\n\t\t} else {\n\t\t\tpanFriction = 1;\n\t\t}\n\t\t\n\t\tnewOffset = _panOffset[axis] + delta[axis] * panFriction;\n\n\t\t// move main scroll or start panning\n\t\tif(_options.allowPanToNext || _currZoomLevel === self.currItem.initialZoomLevel) {\n\n\n\t\t\tif(!_currZoomElementStyle) {\n\t\t\t\t\n\t\t\t\tnewMainScrollPos = newMainScrollPosition;\n\n\t\t\t} else if(_direction === 'h' && axis === 'x' && !_zoomStarted ) {\n\t\t\t\t\n\t\t\t\tif(dir) {\n\t\t\t\t\tif(newOffset > _currPanBounds.min[axis]) {\n\t\t\t\t\t\tpanFriction = _options.panEndFriction;\n\t\t\t\t\t\toverDiff = _currPanBounds.min[axis] - newOffset;\n\t\t\t\t\t\tstartOverDiff = _currPanBounds.min[axis] - _startPanOffset[axis];\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// drag right\n\t\t\t\t\tif( (startOverDiff <= 0 || mainScrollDiff < 0) && _getNumItems() > 1 ) {\n\t\t\t\t\t\tnewMainScrollPos = newMainScrollPosition;\n\t\t\t\t\t\tif(mainScrollDiff < 0 && newMainScrollPosition > _startMainScrollPos.x) {\n\t\t\t\t\t\t\tnewMainScrollPos = _startMainScrollPos.x;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif(_currPanBounds.min.x !== _currPanBounds.max.x) {\n\t\t\t\t\t\t\tnewPanPos = newOffset;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif(newOffset < _currPanBounds.max[axis] ) {\n\t\t\t\t\t\tpanFriction =_options.panEndFriction;\n\t\t\t\t\t\toverDiff = newOffset - _currPanBounds.max[axis];\n\t\t\t\t\t\tstartOverDiff = _startPanOffset[axis] - _currPanBounds.max[axis];\n\t\t\t\t\t}\n\n\t\t\t\t\tif( (startOverDiff <= 0 || mainScrollDiff > 0) && _getNumItems() > 1 ) {\n\t\t\t\t\t\tnewMainScrollPos = newMainScrollPosition;\n\n\t\t\t\t\t\tif(mainScrollDiff > 0 && newMainScrollPosition < _startMainScrollPos.x) {\n\t\t\t\t\t\t\tnewMainScrollPos = _startMainScrollPos.x;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif(_currPanBounds.min.x !== _currPanBounds.max.x) {\n\t\t\t\t\t\t\tnewPanPos = newOffset;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\n\t\t\t\t//\n\t\t\t}\n\n\t\t\tif(axis === 'x') {\n\n\t\t\t\tif(newMainScrollPos !== undefined) {\n\t\t\t\t\t_moveMainScroll(newMainScrollPos, true);\n\t\t\t\t\tif(newMainScrollPos === _startMainScrollPos.x) {\n\t\t\t\t\t\t_mainScrollShifted = false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t_mainScrollShifted = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif(_currPanBounds.min.x !== _currPanBounds.max.x) {\n\t\t\t\t\tif(newPanPos !== undefined) {\n\t\t\t\t\t\t_panOffset.x = newPanPos;\n\t\t\t\t\t} else if(!_mainScrollShifted) {\n\t\t\t\t\t\t_panOffset.x += delta.x * panFriction;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn newMainScrollPos !== undefined;\n\t\t\t}\n\n\t\t}\n\n\t\tif(!_mainScrollAnimating) {\n\t\t\t\n\t\t\tif(!_mainScrollShifted) {\n\t\t\t\tif(_currZoomLevel > self.currItem.fitRatio) {\n\t\t\t\t\t_panOffset[axis] += delta[axis] * panFriction;\n\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t\n\t\t}\n\t\t\n\t},\n\n\t// Pointerdown/touchstart/mousedown handler\n\t_onDragStart = function(e) {\n\n\t\t// Allow dragging only via left mouse button.\n\t\t// As this handler is not added in IE8 - we ignore e.which\n\t\t// \n\t\t// http://www.quirksmode.org/js/events_properties.html\n\t\t// https://developer.mozilla.org/en-US/docs/Web/API/event.button\n\t\tif(e.type === 'mousedown' && e.button > 0  ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif(_initialZoomRunning) {\n\t\t\te.preventDefault();\n\t\t\treturn;\n\t\t}\n\n\t\tif(_oldAndroidTouchEndTimeout && e.type === 'mousedown') {\n\t\t\treturn;\n\t\t}\n\n\t\tif(_preventDefaultEventBehaviour(e, true)) {\n\t\t\te.preventDefault();\n\t\t}\n\n\n\n\t\t_shout('pointerDown');\n\n\t\tif(_pointerEventEnabled) {\n\t\t\tvar pointerIndex = framework.arraySearch(_currPointers, e.pointerId, 'id');\n\t\t\tif(pointerIndex < 0) {\n\t\t\t\tpointerIndex = _currPointers.length;\n\t\t\t}\n\t\t\t_currPointers[pointerIndex] = {x:e.pageX, y:e.pageY, id: e.pointerId};\n\t\t}\n\t\t\n\n\n\t\tvar startPointsList = _getTouchPoints(e),\n\t\t\tnumPoints = startPointsList.length;\n\n\t\t_currentPoints = null;\n\n\t\t_stopAllAnimations();\n\n\t\t// init drag\n\t\tif(!_isDragging || numPoints === 1) {\n\n\t\t\t\n\n\t\t\t_isDragging = _isFirstMove = true;\n\t\t\tframework.bind(window, _upMoveEvents, self);\n\n\t\t\t_isZoomingIn = \n\t\t\t\t_wasOverInitialZoom = \n\t\t\t\t_opacityChanged = \n\t\t\t\t_verticalDragInitiated = \n\t\t\t\t_mainScrollShifted = \n\t\t\t\t_moved = \n\t\t\t\t_isMultitouch = \n\t\t\t\t_zoomStarted = false;\n\n\t\t\t_direction = null;\n\n\t\t\t_shout('firstTouchStart', startPointsList);\n\n\t\t\t_equalizePoints(_startPanOffset, _panOffset);\n\n\t\t\t_currPanDist.x = _currPanDist.y = 0;\n\t\t\t_equalizePoints(_currPoint, startPointsList[0]);\n\t\t\t_equalizePoints(_startPoint, _currPoint);\n\n\t\t\t//_equalizePoints(_startMainScrollPos, _mainScrollPos);\n\t\t\t_startMainScrollPos.x = _slideSize.x * _currPositionIndex;\n\n\t\t\t_posPoints = [{\n\t\t\t\tx: _currPoint.x,\n\t\t\t\ty: _currPoint.y\n\t\t\t}];\n\n\t\t\t_gestureCheckSpeedTime = _gestureStartTime = _getCurrentTime();\n\n\t\t\t//_mainScrollAnimationEnd(true);\n\t\t\t_calculatePanBounds( _currZoomLevel, true );\n\t\t\t\n\t\t\t// Start rendering\n\t\t\t_stopDragUpdateLoop();\n\t\t\t_dragUpdateLoop();\n\t\t\t\n\t\t}\n\n\t\t// init zoom\n\t\tif(!_isZooming && numPoints > 1 && !_mainScrollAnimating && !_mainScrollShifted) {\n\t\t\t_startZoomLevel = _currZoomLevel;\n\t\t\t_zoomStarted = false; // true if zoom changed at least once\n\n\t\t\t_isZooming = _isMultitouch = true;\n\t\t\t_currPanDist.y = _currPanDist.x = 0;\n\n\t\t\t_equalizePoints(_startPanOffset, _panOffset);\n\n\t\t\t_equalizePoints(p, startPointsList[0]);\n\t\t\t_equalizePoints(p2, startPointsList[1]);\n\n\t\t\t_findCenterOfPoints(p, p2, _currCenterPoint);\n\n\t\t\t_midZoomPoint.x = Math.abs(_currCenterPoint.x) - _panOffset.x;\n\t\t\t_midZoomPoint.y = Math.abs(_currCenterPoint.y) - _panOffset.y;\n\t\t\t_currPointsDistance = _startPointsDistance = _calculatePointsDistance(p, p2);\n\t\t}\n\n\n\t},\n\n\t// Pointermove/touchmove/mousemove handler\n\t_onDragMove = function(e) {\n\n\t\te.preventDefault();\n\n\t\tif(_pointerEventEnabled) {\n\t\t\tvar pointerIndex = framework.arraySearch(_currPointers, e.pointerId, 'id');\n\t\t\tif(pointerIndex > -1) {\n\t\t\t\tvar p = _currPointers[pointerIndex];\n\t\t\t\tp.x = e.pageX;\n\t\t\t\tp.y = e.pageY; \n\t\t\t}\n\t\t}\n\n\t\tif(_isDragging) {\n\t\t\tvar touchesList = _getTouchPoints(e);\n\t\t\tif(!_direction && !_moved && !_isZooming) {\n\n\t\t\t\tif(_mainScrollPos.x !== _slideSize.x * _currPositionIndex) {\n\t\t\t\t\t// if main scroll position is shifted – direction is always horizontal\n\t\t\t\t\t_direction = 'h';\n\t\t\t\t} else {\n\t\t\t\t\tvar diff = Math.abs(touchesList[0].x - _currPoint.x) - Math.abs(touchesList[0].y - _currPoint.y);\n\t\t\t\t\t// check the direction of movement\n\t\t\t\t\tif(Math.abs(diff) >= DIRECTION_CHECK_OFFSET) {\n\t\t\t\t\t\t_direction = diff > 0 ? 'h' : 'v';\n\t\t\t\t\t\t_currentPoints = touchesList;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t} else {\n\t\t\t\t_currentPoints = touchesList;\n\t\t\t}\n\t\t}\t\n\t},\n\t// \n\t_renderMovement =  function() {\n\n\t\tif(!_currentPoints) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar numPoints = _currentPoints.length;\n\n\t\tif(numPoints === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\t_equalizePoints(p, _currentPoints[0]);\n\n\t\tdelta.x = p.x - _currPoint.x;\n\t\tdelta.y = p.y - _currPoint.y;\n\n\t\tif(_isZooming && numPoints > 1) {\n\t\t\t// Handle behaviour for more than 1 point\n\n\t\t\t_currPoint.x = p.x;\n\t\t\t_currPoint.y = p.y;\n\t\t\n\t\t\t// check if one of two points changed\n\t\t\tif( !delta.x && !delta.y && _isEqualPoints(_currentPoints[1], p2) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t_equalizePoints(p2, _currentPoints[1]);\n\n\n\t\t\tif(!_zoomStarted) {\n\t\t\t\t_zoomStarted = true;\n\t\t\t\t_shout('zoomGestureStarted');\n\t\t\t}\n\t\t\t\n\t\t\t// Distance between two points\n\t\t\tvar pointsDistance = _calculatePointsDistance(p,p2);\n\n\t\t\tvar zoomLevel = _calculateZoomLevel(pointsDistance);\n\n\t\t\t// slightly over the of initial zoom level\n\t\t\tif(zoomLevel > self.currItem.initialZoomLevel + self.currItem.initialZoomLevel / 15) {\n\t\t\t\t_wasOverInitialZoom = true;\n\t\t\t}\n\n\t\t\t// Apply the friction if zoom level is out of the bounds\n\t\t\tvar zoomFriction = 1,\n\t\t\t\tminZoomLevel = _getMinZoomLevel(),\n\t\t\t\tmaxZoomLevel = _getMaxZoomLevel();\n\n\t\t\tif ( zoomLevel < minZoomLevel ) {\n\t\t\t\t\n\t\t\t\tif(_options.pinchToClose && !_wasOverInitialZoom && _startZoomLevel <= self.currItem.initialZoomLevel) {\n\t\t\t\t\t// fade out background if zooming out\n\t\t\t\t\tvar minusDiff = minZoomLevel - zoomLevel;\n\t\t\t\t\tvar percent = 1 - minusDiff / (minZoomLevel / 1.2);\n\n\t\t\t\t\t_applyBgOpacity(percent);\n\t\t\t\t\t_shout('onPinchClose', percent);\n\t\t\t\t\t_opacityChanged = true;\n\t\t\t\t} else {\n\t\t\t\t\tzoomFriction = (minZoomLevel - zoomLevel) / minZoomLevel;\n\t\t\t\t\tif(zoomFriction > 1) {\n\t\t\t\t\t\tzoomFriction = 1;\n\t\t\t\t\t}\n\t\t\t\t\tzoomLevel = minZoomLevel - zoomFriction * (minZoomLevel / 3);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t} else if ( zoomLevel > maxZoomLevel ) {\n\t\t\t\t// 1.5 - extra zoom level above the max. E.g. if max is x6, real max 6 + 1.5 = 7.5\n\t\t\t\tzoomFriction = (zoomLevel - maxZoomLevel) / ( minZoomLevel * 6 );\n\t\t\t\tif(zoomFriction > 1) {\n\t\t\t\t\tzoomFriction = 1;\n\t\t\t\t}\n\t\t\t\tzoomLevel = maxZoomLevel + zoomFriction * minZoomLevel;\n\t\t\t}\n\n\t\t\tif(zoomFriction < 0) {\n\t\t\t\tzoomFriction = 0;\n\t\t\t}\n\n\t\t\t// distance between touch points after friction is applied\n\t\t\t_currPointsDistance = pointsDistance;\n\n\t\t\t// _centerPoint - The point in the middle of two pointers\n\t\t\t_findCenterOfPoints(p, p2, _centerPoint);\n\t\t\n\t\t\t// paning with two pointers pressed\n\t\t\t_currPanDist.x += _centerPoint.x - _currCenterPoint.x;\n\t\t\t_currPanDist.y += _centerPoint.y - _currCenterPoint.y;\n\t\t\t_equalizePoints(_currCenterPoint, _centerPoint);\n\n\t\t\t_panOffset.x = _calculatePanOffset('x', zoomLevel);\n\t\t\t_panOffset.y = _calculatePanOffset('y', zoomLevel);\n\n\t\t\t_isZoomingIn = zoomLevel > _currZoomLevel;\n\t\t\t_currZoomLevel = zoomLevel;\n\t\t\t_applyCurrentZoomPan();\n\n\t\t} else {\n\n\t\t\t// handle behaviour for one point (dragging or panning)\n\n\t\t\tif(!_direction) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif(_isFirstMove) {\n\t\t\t\t_isFirstMove = false;\n\n\t\t\t\t// subtract drag distance that was used during the detection direction  \n\n\t\t\t\tif( Math.abs(delta.x) >= DIRECTION_CHECK_OFFSET) {\n\t\t\t\t\tdelta.x -= _currentPoints[0].x - _startPoint.x;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif( Math.abs(delta.y) >= DIRECTION_CHECK_OFFSET) {\n\t\t\t\t\tdelta.y -= _currentPoints[0].y - _startPoint.y;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t_currPoint.x = p.x;\n\t\t\t_currPoint.y = p.y;\n\n\t\t\t// do nothing if pointers position hasn't changed\n\t\t\tif(delta.x === 0 && delta.y === 0) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif(_direction === 'v' && _options.closeOnVerticalDrag) {\n\t\t\t\tif(!_canPan()) {\n\t\t\t\t\t_currPanDist.y += delta.y;\n\t\t\t\t\t_panOffset.y += delta.y;\n\n\t\t\t\t\tvar opacityRatio = _calculateVerticalDragOpacityRatio();\n\n\t\t\t\t\t_verticalDragInitiated = true;\n\t\t\t\t\t_shout('onVerticalDrag', opacityRatio);\n\n\t\t\t\t\t_applyBgOpacity(opacityRatio);\n\t\t\t\t\t_applyCurrentZoomPan();\n\t\t\t\t\treturn ;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t_pushPosPoint(_getCurrentTime(), p.x, p.y);\n\n\t\t\t_moved = true;\n\t\t\t_currPanBounds = self.currItem.bounds;\n\t\t\t\n\t\t\tvar mainScrollChanged = _panOrMoveMainScroll('x', delta);\n\t\t\tif(!mainScrollChanged) {\n\t\t\t\t_panOrMoveMainScroll('y', delta);\n\n\t\t\t\t_roundPoint(_panOffset);\n\t\t\t\t_applyCurrentZoomPan();\n\t\t\t}\n\n\t\t}\n\n\t},\n\t\n\t// Pointerup/pointercancel/touchend/touchcancel/mouseup event handler\n\t_onDragRelease = function(e) {\n\n\t\tif(_features.isOldAndroid ) {\n\n\t\t\tif(_oldAndroidTouchEndTimeout && e.type === 'mouseup') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// on Android (v4.1, 4.2, 4.3 & possibly older) \n\t\t\t// ghost mousedown/up event isn't preventable via e.preventDefault,\n\t\t\t// which causes fake mousedown event\n\t\t\t// so we block mousedown/up for 600ms\n\t\t\tif( e.type.indexOf('touch') > -1 ) {\n\t\t\t\tclearTimeout(_oldAndroidTouchEndTimeout);\n\t\t\t\t_oldAndroidTouchEndTimeout = setTimeout(function() {\n\t\t\t\t\t_oldAndroidTouchEndTimeout = 0;\n\t\t\t\t}, 600);\n\t\t\t}\n\t\t\t\n\t\t}\n\n\t\t_shout('pointerUp');\n\n\t\tif(_preventDefaultEventBehaviour(e, false)) {\n\t\t\te.preventDefault();\n\t\t}\n\n\t\tvar releasePoint;\n\n\t\tif(_pointerEventEnabled) {\n\t\t\tvar pointerIndex = framework.arraySearch(_currPointers, e.pointerId, 'id');\n\t\t\t\n\t\t\tif(pointerIndex > -1) {\n\t\t\t\treleasePoint = _currPointers.splice(pointerIndex, 1)[0];\n\n\t\t\t\tif(navigator.msPointerEnabled) {\n\t\t\t\t\tvar MSPOINTER_TYPES = {\n\t\t\t\t\t\t4: 'mouse', // event.MSPOINTER_TYPE_MOUSE\n\t\t\t\t\t\t2: 'touch', // event.MSPOINTER_TYPE_TOUCH \n\t\t\t\t\t\t3: 'pen' // event.MSPOINTER_TYPE_PEN\n\t\t\t\t\t};\n\t\t\t\t\treleasePoint.type = MSPOINTER_TYPES[e.pointerType];\n\n\t\t\t\t\tif(!releasePoint.type) {\n\t\t\t\t\t\treleasePoint.type = e.pointerType || 'mouse';\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treleasePoint.type = e.pointerType || 'mouse';\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\tvar touchList = _getTouchPoints(e),\n\t\t\tgestureType,\n\t\t\tnumPoints = touchList.length;\n\n\t\tif(e.type === 'mouseup') {\n\t\t\tnumPoints = 0;\n\t\t}\n\n\t\t// Do nothing if there were 3 touch points or more\n\t\tif(numPoints === 2) {\n\t\t\t_currentPoints = null;\n\t\t\treturn true;\n\t\t}\n\n\t\t// if second pointer released\n\t\tif(numPoints === 1) {\n\t\t\t_equalizePoints(_startPoint, touchList[0]);\n\t\t}\t\t\t\t\n\n\n\t\t// pointer hasn't moved, send \"tap release\" point\n\t\tif(numPoints === 0 && !_direction && !_mainScrollAnimating) {\n\t\t\tif(!releasePoint) {\n\t\t\t\tif(e.type === 'mouseup') {\n\t\t\t\t\treleasePoint = {x: e.pageX, y: e.pageY, type:'mouse'};\n\t\t\t\t} else if(e.changedTouches && e.changedTouches[0]) {\n\t\t\t\t\treleasePoint = {x: e.changedTouches[0].pageX, y: e.changedTouches[0].pageY, type:'touch'};\n\t\t\t\t}\t\t\n\t\t\t}\n\n\t\t\t_shout('touchRelease', e, releasePoint);\n\t\t}\n\n\t\t// Difference in time between releasing of two last touch points (zoom gesture)\n\t\tvar releaseTimeDiff = -1;\n\n\t\t// Gesture completed, no pointers left\n\t\tif(numPoints === 0) {\n\t\t\t_isDragging = false;\n\t\t\tframework.unbind(window, _upMoveEvents, self);\n\n\t\t\t_stopDragUpdateLoop();\n\n\t\t\tif(_isZooming) {\n\t\t\t\t// Two points released at the same time\n\t\t\t\treleaseTimeDiff = 0;\n\t\t\t} else if(_lastReleaseTime !== -1) {\n\t\t\t\treleaseTimeDiff = _getCurrentTime() - _lastReleaseTime;\n\t\t\t}\n\t\t}\n\t\t_lastReleaseTime = numPoints === 1 ? _getCurrentTime() : -1;\n\t\t\n\t\tif(releaseTimeDiff !== -1 && releaseTimeDiff < 150) {\n\t\t\tgestureType = 'zoom';\n\t\t} else {\n\t\t\tgestureType = 'swipe';\n\t\t}\n\n\t\tif(_isZooming && numPoints < 2) {\n\t\t\t_isZooming = false;\n\n\t\t\t// Only second point released\n\t\t\tif(numPoints === 1) {\n\t\t\t\tgestureType = 'zoomPointerUp';\n\t\t\t}\n\t\t\t_shout('zoomGestureEnded');\n\t\t}\n\n\t\t_currentPoints = null;\n\t\tif(!_moved && !_zoomStarted && !_mainScrollAnimating && !_verticalDragInitiated) {\n\t\t\t// nothing to animate\n\t\t\treturn;\n\t\t}\n\t\n\t\t_stopAllAnimations();\n\n\t\t\n\t\tif(!_releaseAnimData) {\n\t\t\t_releaseAnimData = _initDragReleaseAnimationData();\n\t\t}\n\t\t\n\t\t_releaseAnimData.calculateSwipeSpeed('x');\n\n\n\t\tif(_verticalDragInitiated) {\n\n\t\t\tvar opacityRatio = _calculateVerticalDragOpacityRatio();\n\n\t\t\tif(opacityRatio < _options.verticalDragRange) {\n\t\t\t\tself.close();\n\t\t\t} else {\n\t\t\t\tvar initalPanY = _panOffset.y,\n\t\t\t\t\tinitialBgOpacity = _bgOpacity;\n\n\t\t\t\t_animateProp('verticalDrag', 0, 1, 300, framework.easing.cubic.out, function(now) {\n\t\t\t\t\t\n\t\t\t\t\t_panOffset.y = (self.currItem.initialPosition.y - initalPanY) * now + initalPanY;\n\n\t\t\t\t\t_applyBgOpacity(  (1 - initialBgOpacity) * now + initialBgOpacity );\n\t\t\t\t\t_applyCurrentZoomPan();\n\t\t\t\t});\n\n\t\t\t\t_shout('onVerticalDrag', 1);\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\n\t\t// main scroll \n\t\tif(  (_mainScrollShifted || _mainScrollAnimating) && numPoints === 0) {\n\t\t\tvar itemChanged = _finishSwipeMainScrollGesture(gestureType, _releaseAnimData);\n\t\t\tif(itemChanged) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tgestureType = 'zoomPointerUp';\n\t\t}\n\n\t\t// prevent zoom/pan animation when main scroll animation runs\n\t\tif(_mainScrollAnimating) {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\t// Complete simple zoom gesture (reset zoom level if it's out of the bounds)  \n\t\tif(gestureType !== 'swipe') {\n\t\t\t_completeZoomGesture();\n\t\t\treturn;\n\t\t}\n\t\n\t\t// Complete pan gesture if main scroll is not shifted, and it's possible to pan current image\n\t\tif(!_mainScrollShifted && _currZoomLevel > self.currItem.fitRatio) {\n\t\t\t_completePanGesture(_releaseAnimData);\n\t\t}\n\t},\n\n\n\t// Returns object with data about gesture\n\t// It's created only once and then reused\n\t_initDragReleaseAnimationData  = function() {\n\t\t// temp local vars\n\t\tvar lastFlickDuration,\n\t\t\ttempReleasePos;\n\n\t\t// s = this\n\t\tvar s = {\n\t\t\tlastFlickOffset: {},\n\t\t\tlastFlickDist: {},\n\t\t\tlastFlickSpeed: {},\n\t\t\tslowDownRatio:  {},\n\t\t\tslowDownRatioReverse:  {},\n\t\t\tspeedDecelerationRatio:  {},\n\t\t\tspeedDecelerationRatioAbs:  {},\n\t\t\tdistanceOffset:  {},\n\t\t\tbackAnimDestination: {},\n\t\t\tbackAnimStarted: {},\n\t\t\tcalculateSwipeSpeed: function(axis) {\n\t\t\t\t\n\n\t\t\t\tif( _posPoints.length > 1) {\n\t\t\t\t\tlastFlickDuration = _getCurrentTime() - _gestureCheckSpeedTime + 50;\n\t\t\t\t\ttempReleasePos = _posPoints[_posPoints.length-2][axis];\n\t\t\t\t} else {\n\t\t\t\t\tlastFlickDuration = _getCurrentTime() - _gestureStartTime; // total gesture duration\n\t\t\t\t\ttempReleasePos = _startPoint[axis];\n\t\t\t\t}\n\t\t\t\ts.lastFlickOffset[axis] = _currPoint[axis] - tempReleasePos;\n\t\t\t\ts.lastFlickDist[axis] = Math.abs(s.lastFlickOffset[axis]);\n\t\t\t\tif(s.lastFlickDist[axis] > 20) {\n\t\t\t\t\ts.lastFlickSpeed[axis] = s.lastFlickOffset[axis] / lastFlickDuration;\n\t\t\t\t} else {\n\t\t\t\t\ts.lastFlickSpeed[axis] = 0;\n\t\t\t\t}\n\t\t\t\tif( Math.abs(s.lastFlickSpeed[axis]) < 0.1 ) {\n\t\t\t\t\ts.lastFlickSpeed[axis] = 0;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\ts.slowDownRatio[axis] = 0.95;\n\t\t\t\ts.slowDownRatioReverse[axis] = 1 - s.slowDownRatio[axis];\n\t\t\t\ts.speedDecelerationRatio[axis] = 1;\n\t\t\t},\n\n\t\t\tcalculateOverBoundsAnimOffset: function(axis, speed) {\n\t\t\t\tif(!s.backAnimStarted[axis]) {\n\n\t\t\t\t\tif(_panOffset[axis] > _currPanBounds.min[axis]) {\n\t\t\t\t\t\ts.backAnimDestination[axis] = _currPanBounds.min[axis];\n\t\t\t\t\t\t\n\t\t\t\t\t} else if(_panOffset[axis] < _currPanBounds.max[axis]) {\n\t\t\t\t\t\ts.backAnimDestination[axis] = _currPanBounds.max[axis];\n\t\t\t\t\t}\n\n\t\t\t\t\tif(s.backAnimDestination[axis] !== undefined) {\n\t\t\t\t\t\ts.slowDownRatio[axis] = 0.7;\n\t\t\t\t\t\ts.slowDownRatioReverse[axis] = 1 - s.slowDownRatio[axis];\n\t\t\t\t\t\tif(s.speedDecelerationRatioAbs[axis] < 0.05) {\n\n\t\t\t\t\t\t\ts.lastFlickSpeed[axis] = 0;\n\t\t\t\t\t\t\ts.backAnimStarted[axis] = true;\n\n\t\t\t\t\t\t\t_animateProp('bounceZoomPan'+axis,_panOffset[axis], \n\t\t\t\t\t\t\t\ts.backAnimDestination[axis], \n\t\t\t\t\t\t\t\tspeed || 300, \n\t\t\t\t\t\t\t\tframework.easing.sine.out, \n\t\t\t\t\t\t\t\tfunction(pos) {\n\t\t\t\t\t\t\t\t\t_panOffset[axis] = pos;\n\t\t\t\t\t\t\t\t\t_applyCurrentZoomPan();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// Reduces the speed by slowDownRatio (per 10ms)\n\t\t\tcalculateAnimOffset: function(axis) {\n\t\t\t\tif(!s.backAnimStarted[axis]) {\n\t\t\t\t\ts.speedDecelerationRatio[axis] = s.speedDecelerationRatio[axis] * (s.slowDownRatio[axis] + \n\t\t\t\t\t\t\t\t\t\t\t\ts.slowDownRatioReverse[axis] - \n\t\t\t\t\t\t\t\t\t\t\t\ts.slowDownRatioReverse[axis] * s.timeDiff / 10);\n\n\t\t\t\t\ts.speedDecelerationRatioAbs[axis] = Math.abs(s.lastFlickSpeed[axis] * s.speedDecelerationRatio[axis]);\n\t\t\t\t\ts.distanceOffset[axis] = s.lastFlickSpeed[axis] * s.speedDecelerationRatio[axis] * s.timeDiff;\n\t\t\t\t\t_panOffset[axis] += s.distanceOffset[axis];\n\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tpanAnimLoop: function() {\n\t\t\t\tif ( _animations.zoomPan ) {\n\t\t\t\t\t_animations.zoomPan.raf = _requestAF(s.panAnimLoop);\n\n\t\t\t\t\ts.now = _getCurrentTime();\n\t\t\t\t\ts.timeDiff = s.now - s.lastNow;\n\t\t\t\t\ts.lastNow = s.now;\n\t\t\t\t\t\n\t\t\t\t\ts.calculateAnimOffset('x');\n\t\t\t\t\ts.calculateAnimOffset('y');\n\n\t\t\t\t\t_applyCurrentZoomPan();\n\t\t\t\t\t\n\t\t\t\t\ts.calculateOverBoundsAnimOffset('x');\n\t\t\t\t\ts.calculateOverBoundsAnimOffset('y');\n\n\n\t\t\t\t\tif (s.speedDecelerationRatioAbs.x < 0.05 && s.speedDecelerationRatioAbs.y < 0.05) {\n\n\t\t\t\t\t\t// round pan position\n\t\t\t\t\t\t_panOffset.x = Math.round(_panOffset.x);\n\t\t\t\t\t\t_panOffset.y = Math.round(_panOffset.y);\n\t\t\t\t\t\t_applyCurrentZoomPan();\n\t\t\t\t\t\t\n\t\t\t\t\t\t_stopAnimation('zoomPan');\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t};\n\t\treturn s;\n\t},\n\n\t_completePanGesture = function(animData) {\n\t\t// calculate swipe speed for Y axis (paanning)\n\t\tanimData.calculateSwipeSpeed('y');\n\n\t\t_currPanBounds = self.currItem.bounds;\n\t\t\n\t\tanimData.backAnimDestination = {};\n\t\tanimData.backAnimStarted = {};\n\n\t\t// Avoid acceleration animation if speed is too low\n\t\tif(Math.abs(animData.lastFlickSpeed.x) <= 0.05 && Math.abs(animData.lastFlickSpeed.y) <= 0.05 ) {\n\t\t\tanimData.speedDecelerationRatioAbs.x = animData.speedDecelerationRatioAbs.y = 0;\n\n\t\t\t// Run pan drag release animation. E.g. if you drag image and release finger without momentum.\n\t\t\tanimData.calculateOverBoundsAnimOffset('x');\n\t\t\tanimData.calculateOverBoundsAnimOffset('y');\n\t\t\treturn true;\n\t\t}\n\n\t\t// Animation loop that controls the acceleration after pan gesture ends\n\t\t_registerStartAnimation('zoomPan');\n\t\tanimData.lastNow = _getCurrentTime();\n\t\tanimData.panAnimLoop();\n\t},\n\n\n\t_finishSwipeMainScrollGesture = function(gestureType, _releaseAnimData) {\n\t\tvar itemChanged;\n\t\tif(!_mainScrollAnimating) {\n\t\t\t_currZoomedItemIndex = _currentItemIndex;\n\t\t}\n\n\n\t\t\n\t\tvar itemsDiff;\n\n\t\tif(gestureType === 'swipe') {\n\t\t\tvar totalShiftDist = _currPoint.x - _startPoint.x,\n\t\t\t\tisFastLastFlick = _releaseAnimData.lastFlickDist.x < 10;\n\n\t\t\t// if container is shifted for more than MIN_SWIPE_DISTANCE, \n\t\t\t// and last flick gesture was in right direction\n\t\t\tif(totalShiftDist > MIN_SWIPE_DISTANCE && \n\t\t\t\t(isFastLastFlick || _releaseAnimData.lastFlickOffset.x > 20) ) {\n\t\t\t\t// go to prev item\n\t\t\t\titemsDiff = -1;\n\t\t\t} else if(totalShiftDist < -MIN_SWIPE_DISTANCE && \n\t\t\t\t(isFastLastFlick || _releaseAnimData.lastFlickOffset.x < -20) ) {\n\t\t\t\t// go to next item\n\t\t\t\titemsDiff = 1;\n\t\t\t}\n\t\t}\n\n\t\tvar nextCircle;\n\n\t\tif(itemsDiff) {\n\t\t\t\n\t\t\t_currentItemIndex += itemsDiff;\n\n\t\t\tif(_currentItemIndex < 0) {\n\t\t\t\t_currentItemIndex = _options.loop ? _getNumItems()-1 : 0;\n\t\t\t\tnextCircle = true;\n\t\t\t} else if(_currentItemIndex >= _getNumItems()) {\n\t\t\t\t_currentItemIndex = _options.loop ? 0 : _getNumItems()-1;\n\t\t\t\tnextCircle = true;\n\t\t\t}\n\n\t\t\tif(!nextCircle || _options.loop) {\n\t\t\t\t_indexDiff += itemsDiff;\n\t\t\t\t_currPositionIndex -= itemsDiff;\n\t\t\t\titemChanged = true;\n\t\t\t}\n\t\t\t\n\n\t\t\t\n\t\t}\n\n\t\tvar animateToX = _slideSize.x * _currPositionIndex;\n\t\tvar animateToDist = Math.abs( animateToX - _mainScrollPos.x );\n\t\tvar finishAnimDuration;\n\n\n\t\tif(!itemChanged && animateToX > _mainScrollPos.x !== _releaseAnimData.lastFlickSpeed.x > 0) {\n\t\t\t// \"return to current\" duration, e.g. when dragging from slide 0 to -1\n\t\t\tfinishAnimDuration = 333; \n\t\t} else {\n\t\t\tfinishAnimDuration = Math.abs(_releaseAnimData.lastFlickSpeed.x) > 0 ? \n\t\t\t\t\t\t\t\t\tanimateToDist / Math.abs(_releaseAnimData.lastFlickSpeed.x) : \n\t\t\t\t\t\t\t\t\t333;\n\n\t\t\tfinishAnimDuration = Math.min(finishAnimDuration, 400);\n\t\t\tfinishAnimDuration = Math.max(finishAnimDuration, 250);\n\t\t}\n\n\t\tif(_currZoomedItemIndex === _currentItemIndex) {\n\t\t\titemChanged = false;\n\t\t}\n\t\t\n\t\t_mainScrollAnimating = true;\n\t\t\n\t\t_shout('mainScrollAnimStart');\n\n\t\t_animateProp('mainScroll', _mainScrollPos.x, animateToX, finishAnimDuration, framework.easing.cubic.out, \n\t\t\t_moveMainScroll,\n\t\t\tfunction() {\n\t\t\t\t_stopAllAnimations();\n\t\t\t\t_mainScrollAnimating = false;\n\t\t\t\t_currZoomedItemIndex = -1;\n\t\t\t\t\n\t\t\t\tif(itemChanged || _currZoomedItemIndex !== _currentItemIndex) {\n\t\t\t\t\tself.updateCurrItem();\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t_shout('mainScrollAnimComplete');\n\t\t\t}\n\t\t);\n\n\t\tif(itemChanged) {\n\t\t\tself.updateCurrItem(true);\n\t\t}\n\n\t\treturn itemChanged;\n\t},\n\n\t_calculateZoomLevel = function(touchesDistance) {\n\t\treturn  1 / _startPointsDistance * touchesDistance * _startZoomLevel;\n\t},\n\n\t// Resets zoom if it's out of bounds\n\t_completeZoomGesture = function() {\n\t\tvar destZoomLevel = _currZoomLevel,\n\t\t\tminZoomLevel = _getMinZoomLevel(),\n\t\t\tmaxZoomLevel = _getMaxZoomLevel();\n\n\t\tif ( _currZoomLevel < minZoomLevel ) {\n\t\t\tdestZoomLevel = minZoomLevel;\n\t\t} else if ( _currZoomLevel > maxZoomLevel ) {\n\t\t\tdestZoomLevel = maxZoomLevel;\n\t\t}\n\n\t\tvar destOpacity = 1,\n\t\t\tonUpdate,\n\t\t\tinitialOpacity = _bgOpacity;\n\n\t\tif(_opacityChanged && !_isZoomingIn && !_wasOverInitialZoom && _currZoomLevel < minZoomLevel) {\n\t\t\t//_closedByScroll = true;\n\t\t\tself.close();\n\t\t\treturn true;\n\t\t}\n\n\t\tif(_opacityChanged) {\n\t\t\tonUpdate = function(now) {\n\t\t\t\t_applyBgOpacity(  (destOpacity - initialOpacity) * now + initialOpacity );\n\t\t\t};\n\t\t}\n\n\t\tself.zoomTo(destZoomLevel, 0, 200,  framework.easing.cubic.out, onUpdate);\n\t\treturn true;\n\t};\n\n\n_registerModule('Gestures', {\n\tpublicMethods: {\n\n\t\tinitGestures: function() {\n\n\t\t\t// helper function that builds touch/pointer/mouse events\n\t\t\tvar addEventNames = function(pref, down, move, up, cancel) {\n\t\t\t\t_dragStartEvent = pref + down;\n\t\t\t\t_dragMoveEvent = pref + move;\n\t\t\t\t_dragEndEvent = pref + up;\n\t\t\t\tif(cancel) {\n\t\t\t\t\t_dragCancelEvent = pref + cancel;\n\t\t\t\t} else {\n\t\t\t\t\t_dragCancelEvent = '';\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t_pointerEventEnabled = _features.pointerEvent;\n\t\t\tif(_pointerEventEnabled && _features.touch) {\n\t\t\t\t// we don't need touch events, if browser supports pointer events\n\t\t\t\t_features.touch = false;\n\t\t\t}\n\n\t\t\tif(_pointerEventEnabled) {\n\t\t\t\tif(navigator.msPointerEnabled) {\n\t\t\t\t\t// IE10 pointer events are case-sensitive\n\t\t\t\t\taddEventNames('MSPointer', 'Down', 'Move', 'Up', 'Cancel');\n\t\t\t\t} else {\n\t\t\t\t\taddEventNames('pointer', 'down', 'move', 'up', 'cancel');\n\t\t\t\t}\n\t\t\t} else if(_features.touch) {\n\t\t\t\taddEventNames('touch', 'start', 'move', 'end', 'cancel');\n\t\t\t\t_likelyTouchDevice = true;\n\t\t\t} else {\n\t\t\t\taddEventNames('mouse', 'down', 'move', 'up');\t\n\t\t\t}\n\n\t\t\t_upMoveEvents = _dragMoveEvent + ' ' + _dragEndEvent  + ' ' +  _dragCancelEvent;\n\t\t\t_downEvents = _dragStartEvent;\n\n\t\t\tif(_pointerEventEnabled && !_likelyTouchDevice) {\n\t\t\t\t_likelyTouchDevice = (navigator.maxTouchPoints > 1) || (navigator.msMaxTouchPoints > 1);\n\t\t\t}\n\t\t\t// make variable public\n\t\t\tself.likelyTouchDevice = _likelyTouchDevice; \n\t\t\t\n\t\t\t_globalEventHandlers[_dragStartEvent] = _onDragStart;\n\t\t\t_globalEventHandlers[_dragMoveEvent] = _onDragMove;\n\t\t\t_globalEventHandlers[_dragEndEvent] = _onDragRelease; // the Kraken\n\n\t\t\tif(_dragCancelEvent) {\n\t\t\t\t_globalEventHandlers[_dragCancelEvent] = _globalEventHandlers[_dragEndEvent];\n\t\t\t}\n\n\t\t\t// Bind mouse events on device with detected hardware touch support, in case it supports multiple types of input.\n\t\t\tif(_features.touch) {\n\t\t\t\t_downEvents += ' mousedown';\n\t\t\t\t_upMoveEvents += ' mousemove mouseup';\n\t\t\t\t_globalEventHandlers.mousedown = _globalEventHandlers[_dragStartEvent];\n\t\t\t\t_globalEventHandlers.mousemove = _globalEventHandlers[_dragMoveEvent];\n\t\t\t\t_globalEventHandlers.mouseup = _globalEventHandlers[_dragEndEvent];\n\t\t\t}\n\n\t\t\tif(!_likelyTouchDevice) {\n\t\t\t\t// don't allow pan to next slide from zoomed state on Desktop\n\t\t\t\t_options.allowPanToNext = false;\n\t\t\t}\n\t\t}\n\n\t}\n});\n\n\n/*>>gestures*/\n\n/*>>show-hide-transition*/\n/**\n * show-hide-transition.js:\n *\n * Manages initial opening or closing transition.\n *\n * If you're not planning to use transition for gallery at all,\n * you may set options hideAnimationDuration and showAnimationDuration to 0,\n * and just delete startAnimation function.\n * \n */\n\n\nvar _showOrHideTimeout,\n\t_showOrHide = function(item, img, out, completeFn) {\n\n\t\tif(_showOrHideTimeout) {\n\t\t\tclearTimeout(_showOrHideTimeout);\n\t\t}\n\n\t\t_initialZoomRunning = true;\n\t\t_initialContentSet = true;\n\t\t\n\t\t// dimensions of small thumbnail {x:,y:,w:}.\n\t\t// Height is optional, as calculated based on large image.\n\t\tvar thumbBounds; \n\t\tif(item.initialLayout) {\n\t\t\tthumbBounds = item.initialLayout;\n\t\t\titem.initialLayout = null;\n\t\t} else {\n\t\t\tthumbBounds = _options.getThumbBoundsFn && _options.getThumbBoundsFn(_currentItemIndex);\n\t\t}\n\n\t\tvar duration = out ? _options.hideAnimationDuration : _options.showAnimationDuration;\n\n\t\tvar onComplete = function() {\n\t\t\t_stopAnimation('initialZoom');\n\t\t\tif(!out) {\n\t\t\t\t_applyBgOpacity(1);\n\t\t\t\tif(img) {\n\t\t\t\t\timg.style.display = 'block';\n\t\t\t\t}\n\t\t\t\tframework.addClass(template, 'pswp--animated-in');\n\t\t\t\t_shout('initialZoom' + (out ? 'OutEnd' : 'InEnd'));\n\t\t\t} else {\n\t\t\t\tself.template.removeAttribute('style');\n\t\t\t\tself.bg.removeAttribute('style');\n\t\t\t}\n\n\t\t\tif(completeFn) {\n\t\t\t\tcompleteFn();\n\t\t\t}\n\t\t\t_initialZoomRunning = false;\n\t\t};\n\n\t\t// if bounds aren't provided, just open gallery without animation\n\t\tif(!duration || !thumbBounds || thumbBounds.x === undefined) {\n\n\t\t\t_shout('initialZoom' + (out ? 'Out' : 'In') );\n\n\t\t\t_currZoomLevel = item.initialZoomLevel;\n\t\t\t_equalizePoints(_panOffset,  item.initialPosition );\n\t\t\t_applyCurrentZoomPan();\n\n\t\t\ttemplate.style.opacity = out ? 0 : 1;\n\t\t\t_applyBgOpacity(1);\n\n\t\t\tif(duration) {\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tonComplete();\n\t\t\t\t}, duration);\n\t\t\t} else {\n\t\t\t\tonComplete();\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tvar startAnimation = function() {\n\t\t\tvar closeWithRaf = _closedByScroll,\n\t\t\t\tfadeEverything = !self.currItem.src || self.currItem.loadError || _options.showHideOpacity;\n\t\t\t\n\t\t\t// apply hw-acceleration to image\n\t\t\tif(item.miniImg) {\n\t\t\t\titem.miniImg.style.webkitBackfaceVisibility = 'hidden';\n\t\t\t}\n\n\t\t\tif(!out) {\n\t\t\t\t_currZoomLevel = thumbBounds.w / item.w;\n\t\t\t\t_panOffset.x = thumbBounds.x;\n\t\t\t\t_panOffset.y = thumbBounds.y - _initalWindowScrollY;\n\n\t\t\t\tself[fadeEverything ? 'template' : 'bg'].style.opacity = 0.001;\n\t\t\t\t_applyCurrentZoomPan();\n\t\t\t}\n\n\t\t\t_registerStartAnimation('initialZoom');\n\t\t\t\n\t\t\tif(out && !closeWithRaf) {\n\t\t\t\tframework.removeClass(template, 'pswp--animated-in');\n\t\t\t}\n\n\t\t\tif(fadeEverything) {\n\t\t\t\tif(out) {\n\t\t\t\t\tframework[ (closeWithRaf ? 'remove' : 'add') + 'Class' ](template, 'pswp--animate_opacity');\n\t\t\t\t} else {\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\tframework.addClass(template, 'pswp--animate_opacity');\n\t\t\t\t\t}, 30);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t_showOrHideTimeout = setTimeout(function() {\n\n\t\t\t\t_shout('initialZoom' + (out ? 'Out' : 'In') );\n\t\t\t\t\n\n\t\t\t\tif(!out) {\n\n\t\t\t\t\t// \"in\" animation always uses CSS transitions (instead of rAF).\n\t\t\t\t\t// CSS transition work faster here, \n\t\t\t\t\t// as developer may also want to animate other things, \n\t\t\t\t\t// like ui on top of sliding area, which can be animated just via CSS\n\t\t\t\t\t\n\t\t\t\t\t_currZoomLevel = item.initialZoomLevel;\n\t\t\t\t\t_equalizePoints(_panOffset,  item.initialPosition );\n\t\t\t\t\t_applyCurrentZoomPan();\n\t\t\t\t\t_applyBgOpacity(1);\n\n\t\t\t\t\tif(fadeEverything) {\n\t\t\t\t\t\ttemplate.style.opacity = 1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t_applyBgOpacity(1);\n\t\t\t\t\t}\n\n\t\t\t\t\t_showOrHideTimeout = setTimeout(onComplete, duration + 20);\n\t\t\t\t} else {\n\n\t\t\t\t\t// \"out\" animation uses rAF only when PhotoSwipe is closed by browser scroll, to recalculate position\n\t\t\t\t\tvar destZoomLevel = thumbBounds.w / item.w,\n\t\t\t\t\t\tinitialPanOffset = {\n\t\t\t\t\t\t\tx: _panOffset.x,\n\t\t\t\t\t\t\ty: _panOffset.y\n\t\t\t\t\t\t},\n\t\t\t\t\t\tinitialZoomLevel = _currZoomLevel,\n\t\t\t\t\t\tinitalBgOpacity = _bgOpacity,\n\t\t\t\t\t\tonUpdate = function(now) {\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(now === 1) {\n\t\t\t\t\t\t\t\t_currZoomLevel = destZoomLevel;\n\t\t\t\t\t\t\t\t_panOffset.x = thumbBounds.x;\n\t\t\t\t\t\t\t\t_panOffset.y = thumbBounds.y  - _currentWindowScrollY;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t_currZoomLevel = (destZoomLevel - initialZoomLevel) * now + initialZoomLevel;\n\t\t\t\t\t\t\t\t_panOffset.x = (thumbBounds.x - initialPanOffset.x) * now + initialPanOffset.x;\n\t\t\t\t\t\t\t\t_panOffset.y = (thumbBounds.y - _currentWindowScrollY - initialPanOffset.y) * now + initialPanOffset.y;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t_applyCurrentZoomPan();\n\t\t\t\t\t\t\tif(fadeEverything) {\n\t\t\t\t\t\t\t\ttemplate.style.opacity = 1 - now;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t_applyBgOpacity( initalBgOpacity - now * initalBgOpacity );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\n\t\t\t\t\tif(closeWithRaf) {\n\t\t\t\t\t\t_animateProp('initialZoom', 0, 1, duration, framework.easing.cubic.out, onUpdate, onComplete);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tonUpdate(1);\n\t\t\t\t\t\t_showOrHideTimeout = setTimeout(onComplete, duration + 20);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\n\t\t\t}, out ? 25 : 90); // Main purpose of this delay is to give browser time to paint and\n\t\t\t\t\t// create composite layers of PhotoSwipe UI parts (background, controls, caption, arrows).\n\t\t\t\t\t// Which avoids lag at the beginning of scale transition.\n\t\t};\n\t\tstartAnimation();\n\n\t\t\n\t};\n\n/*>>show-hide-transition*/\n\n/*>>items-controller*/\n/**\n*\n* Controller manages gallery items, their dimensions, and their content.\n* \n*/\n\nvar _items,\n\t_tempPanAreaSize = {},\n\t_imagesToAppendPool = [],\n\t_initialContentSet,\n\t_initialZoomRunning,\n\t_controllerDefaultOptions = {\n\t\tindex: 0,\n\t\terrorMsg: '<div class=\"pswp__error-msg\"><a href=\"%url%\" target=\"_blank\">The image</a> could not be loaded.</div>',\n\t\tforceProgressiveLoading: false, // TODO\n\t\tpreload: [1,1],\n\t\tgetNumItemsFn: function() {\n\t\t\treturn _items.length;\n\t\t}\n\t};\n\n\nvar _getItemAt,\n\t_getNumItems,\n\t_initialIsLoop,\n\t_getZeroBounds = function() {\n\t\treturn {\n\t\t\tcenter:{x:0,y:0}, \n\t\t\tmax:{x:0,y:0}, \n\t\t\tmin:{x:0,y:0}\n\t\t};\n\t},\n\t_calculateSingleItemPanBounds = function(item, realPanElementW, realPanElementH ) {\n\t\tvar bounds = item.bounds;\n\n\t\t// position of element when it's centered\n\t\tbounds.center.x = Math.round((_tempPanAreaSize.x - realPanElementW) / 2);\n\t\tbounds.center.y = Math.round((_tempPanAreaSize.y - realPanElementH) / 2) + item.vGap.top;\n\n\t\t// maximum pan position\n\t\tbounds.max.x = (realPanElementW > _tempPanAreaSize.x) ? \n\t\t\t\t\t\t\tMath.round(_tempPanAreaSize.x - realPanElementW) : \n\t\t\t\t\t\t\tbounds.center.x;\n\t\t\n\t\tbounds.max.y = (realPanElementH > _tempPanAreaSize.y) ? \n\t\t\t\t\t\t\tMath.round(_tempPanAreaSize.y - realPanElementH) + item.vGap.top : \n\t\t\t\t\t\t\tbounds.center.y;\n\t\t\n\t\t// minimum pan position\n\t\tbounds.min.x = (realPanElementW > _tempPanAreaSize.x) ? 0 : bounds.center.x;\n\t\tbounds.min.y = (realPanElementH > _tempPanAreaSize.y) ? item.vGap.top : bounds.center.y;\n\t},\n\t_calculateItemSize = function(item, viewportSize, zoomLevel) {\n\n\t\tif (item.src && !item.loadError) {\n\t\t\tvar isInitial = !zoomLevel;\n\t\t\t\n\t\t\tif(isInitial) {\n\t\t\t\tif(!item.vGap) {\n\t\t\t\t\titem.vGap = {top:0,bottom:0};\n\t\t\t\t}\n\t\t\t\t// allows overriding vertical margin for individual items\n\t\t\t\t_shout('parseVerticalMargin', item);\n\t\t\t}\n\n\n\t\t\t_tempPanAreaSize.x = viewportSize.x;\n\t\t\t_tempPanAreaSize.y = viewportSize.y - item.vGap.top - item.vGap.bottom;\n\n\t\t\tif (isInitial) {\n\t\t\t\tvar hRatio = _tempPanAreaSize.x / item.w;\n\t\t\t\tvar vRatio = _tempPanAreaSize.y / item.h;\n\n\t\t\t\titem.fitRatio = hRatio < vRatio ? hRatio : vRatio;\n\t\t\t\t//item.fillRatio = hRatio > vRatio ? hRatio : vRatio;\n\n\t\t\t\tvar scaleMode = _options.scaleMode;\n\n\t\t\t\tif (scaleMode === 'orig') {\n\t\t\t\t\tzoomLevel = 1;\n\t\t\t\t} else if (scaleMode === 'fit') {\n\t\t\t\t\tzoomLevel = item.fitRatio;\n\t\t\t\t}\n\n\t\t\t\tif (zoomLevel > 1) {\n\t\t\t\t\tzoomLevel = 1;\n\t\t\t\t}\n\n\t\t\t\titem.initialZoomLevel = zoomLevel;\n\t\t\t\t\n\t\t\t\tif(!item.bounds) {\n\t\t\t\t\t// reuse bounds object\n\t\t\t\t\titem.bounds = _getZeroBounds(); \n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(!zoomLevel) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t_calculateSingleItemPanBounds(item, item.w * zoomLevel, item.h * zoomLevel);\n\n\t\t\tif (isInitial && zoomLevel === item.initialZoomLevel) {\n\t\t\t\titem.initialPosition = item.bounds.center;\n\t\t\t}\n\n\t\t\treturn item.bounds;\n\t\t} else {\n\t\t\titem.w = item.h = 0;\n\t\t\titem.initialZoomLevel = item.fitRatio = 1;\n\t\t\titem.bounds = _getZeroBounds();\n\t\t\titem.initialPosition = item.bounds.center;\n\n\t\t\t// if it's not image, we return zero bounds (content is not zoomable)\n\t\t\treturn item.bounds;\n\t\t}\n\t\t\n\t},\n\n\t\n\n\n\t_appendImage = function(index, item, baseDiv, img, preventAnimation, keepPlaceholder) {\n\t\t\n\n\t\tif(item.loadError) {\n\t\t\treturn;\n\t\t}\n\n\t\tif(img) {\n\n\t\t\titem.imageAppended = true;\n\t\t\t_setImageSize(item, img, (item === self.currItem && _renderMaxResolution) );\n\t\t\t\n\t\t\tbaseDiv.appendChild(img);\n\n\t\t\tif(keepPlaceholder) {\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tif(item && item.loaded && item.placeholder) {\n\t\t\t\t\t\titem.placeholder.style.display = 'none';\n\t\t\t\t\t\titem.placeholder = null;\n\t\t\t\t\t}\n\t\t\t\t}, 500);\n\t\t\t}\n\t\t}\n\t},\n\t\n\n\n\t_preloadImage = function(item) {\n\t\titem.loading = true;\n\t\titem.loaded = false;\n\t\tvar img = item.img = framework.createEl('pswp__img', 'img');\n\t\tvar onComplete = function() {\n\t\t\titem.loading = false;\n\t\t\titem.loaded = true;\n\n\t\t\tif(item.loadComplete) {\n\t\t\t\titem.loadComplete(item);\n\t\t\t} else {\n\t\t\t\titem.img = null; // no need to store image object\n\t\t\t}\n\t\t\timg.onload = img.onerror = null;\n\t\t\timg = null;\n\t\t};\n\t\timg.onload = onComplete;\n\t\timg.onerror = function() {\n\t\t\titem.loadError = true;\n\t\t\tonComplete();\n\t\t};\t\t\n\n\t\timg.src = item.src;// + '?a=' + Math.random();\n\n\t\treturn img;\n\t},\n\t_checkForError = function(item, cleanUp) {\n\t\tif(item.src && item.loadError && item.container) {\n\n\t\t\tif(cleanUp) {\n\t\t\t\titem.container.innerHTML = '';\n\t\t\t}\n\n\t\t\titem.container.innerHTML = _options.errorMsg.replace('%url%',  item.src );\n\t\t\treturn true;\n\t\t\t\n\t\t}\n\t},\n\t_setImageSize = function(item, img, maxRes) {\n\t\tif(!item.src) {\n\t\t\treturn;\n\t\t}\n\n\t\tif(!img) {\n\t\t\timg = item.container.lastChild;\n\t\t}\n\n\t\tvar w = maxRes ? item.w : Math.round(item.w * item.fitRatio),\n\t\t\th = maxRes ? item.h : Math.round(item.h * item.fitRatio);\n\t\t\n\t\tif(item.placeholder && !item.loaded) {\n\t\t\titem.placeholder.style.width = w + 'px';\n\t\t\titem.placeholder.style.height = h + 'px';\n\t\t}\n\n\t\timg.style.width = w + 'px';\n\t\timg.style.height = h + 'px';\n\t},\n\t_appendImagesPool = function() {\n\n\t\tif(_imagesToAppendPool.length) {\n\t\t\tvar poolItem;\n\n\t\t\tfor(var i = 0; i < _imagesToAppendPool.length; i++) {\n\t\t\t\tpoolItem = _imagesToAppendPool[i];\n\t\t\t\tif( poolItem.holder.index === poolItem.index ) {\n\t\t\t\t\t_appendImage(poolItem.index, poolItem.item, poolItem.baseDiv, poolItem.img, false, poolItem.clearPlaceholder);\n\t\t\t\t}\n\t\t\t}\n\t\t\t_imagesToAppendPool = [];\n\t\t}\n\t};\n\t\n\n\n_registerModule('Controller', {\n\n\tpublicMethods: {\n\n\t\tlazyLoadItem: function(index) {\n\t\t\tindex = _getLoopedId(index);\n\t\t\tvar item = _getItemAt(index);\n\n\t\t\tif(!item || ((item.loaded || item.loading) && !_itemsNeedUpdate)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t_shout('gettingData', index, item);\n\n\t\t\tif (!item.src) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t_preloadImage(item);\n\t\t},\n\t\tinitController: function() {\n\t\t\tframework.extend(_options, _controllerDefaultOptions, true);\n\t\t\tself.items = _items = items;\n\t\t\t_getItemAt = self.getItemAt;\n\t\t\t_getNumItems = _options.getNumItemsFn; //self.getNumItems;\n\n\n\n\t\t\t_initialIsLoop = _options.loop;\n\t\t\tif(_getNumItems() < 3) {\n\t\t\t\t_options.loop = false; // disable loop if less then 3 items\n\t\t\t}\n\n\t\t\t_listen('beforeChange', function(diff) {\n\n\t\t\t\tvar p = _options.preload,\n\t\t\t\t\tisNext = diff === null ? true : (diff >= 0),\n\t\t\t\t\tpreloadBefore = Math.min(p[0], _getNumItems() ),\n\t\t\t\t\tpreloadAfter = Math.min(p[1], _getNumItems() ),\n\t\t\t\t\ti;\n\n\n\t\t\t\tfor(i = 1; i <= (isNext ? preloadAfter : preloadBefore); i++) {\n\t\t\t\t\tself.lazyLoadItem(_currentItemIndex+i);\n\t\t\t\t}\n\t\t\t\tfor(i = 1; i <= (isNext ? preloadBefore : preloadAfter); i++) {\n\t\t\t\t\tself.lazyLoadItem(_currentItemIndex-i);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t_listen('initialLayout', function() {\n\t\t\t\tself.currItem.initialLayout = _options.getThumbBoundsFn && _options.getThumbBoundsFn(_currentItemIndex);\n\t\t\t});\n\n\t\t\t_listen('mainScrollAnimComplete', _appendImagesPool);\n\t\t\t_listen('initialZoomInEnd', _appendImagesPool);\n\n\n\n\t\t\t_listen('destroy', function() {\n\t\t\t\tvar item;\n\t\t\t\tfor(var i = 0; i < _items.length; i++) {\n\t\t\t\t\titem = _items[i];\n\t\t\t\t\t// remove reference to DOM elements, for GC\n\t\t\t\t\tif(item.container) {\n\t\t\t\t\t\titem.container = null; \n\t\t\t\t\t}\n\t\t\t\t\tif(item.placeholder) {\n\t\t\t\t\t\titem.placeholder = null;\n\t\t\t\t\t}\n\t\t\t\t\tif(item.img) {\n\t\t\t\t\t\titem.img = null;\n\t\t\t\t\t}\n\t\t\t\t\tif(item.preloader) {\n\t\t\t\t\t\titem.preloader = null;\n\t\t\t\t\t}\n\t\t\t\t\tif(item.loadError) {\n\t\t\t\t\t\titem.loaded = item.loadError = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t_imagesToAppendPool = null;\n\t\t\t});\n\t\t},\n\n\n\t\tgetItemAt: function(index) {\n\t\t\tif (index >= 0) {\n\t\t\t\treturn _items[index] !== undefined ? _items[index] : false;\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\n\t\tallowProgressiveImg: function() {\n\t\t\t// 1. Progressive image loading isn't working on webkit/blink \n\t\t\t//    when hw-acceleration (e.g. translateZ) is applied to IMG element.\n\t\t\t//    That's why in PhotoSwipe parent element gets zoom transform, not image itself.\n\t\t\t//    \n\t\t\t// 2. Progressive image loading sometimes blinks in webkit/blink when applying animation to parent element.\n\t\t\t//    That's why it's disabled on touch devices (mainly because of swipe transition)\n\t\t\t//    \n\t\t\t// 3. Progressive image loading sometimes doesn't work in IE (up to 11).\n\n\t\t\t// Don't allow progressive loading on non-large touch devices\n\t\t\treturn _options.forceProgressiveLoading || !_likelyTouchDevice || _options.mouseUsed || screen.width > 1200; \n\t\t\t// 1200 - to eliminate touch devices with large screen (like Chromebook Pixel)\n\t\t},\n\n\t\tsetContent: function(holder, index) {\n\n\t\t\tif(_options.loop) {\n\t\t\t\tindex = _getLoopedId(index);\n\t\t\t}\n\n\t\t\tvar prevItem = self.getItemAt(holder.index);\n\t\t\tif(prevItem) {\n\t\t\t\tprevItem.container = null;\n\t\t\t}\n\t\n\t\t\tvar item = self.getItemAt(index),\n\t\t\t\timg;\n\t\t\t\n\t\t\tif(!item) {\n\t\t\t\tholder.el.innerHTML = '';\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// allow to override data\n\t\t\t_shout('gettingData', index, item);\n\n\t\t\tholder.index = index;\n\t\t\tholder.item = item;\n\n\t\t\t// base container DIV is created only once for each of 3 holders\n\t\t\tvar baseDiv = item.container = framework.createEl('pswp__zoom-wrap'); \n\n\t\t\t\n\n\t\t\tif(!item.src && item.html) {\n\t\t\t\tif(item.html.tagName) {\n\t\t\t\t\tbaseDiv.appendChild(item.html);\n\t\t\t\t} else {\n\t\t\t\t\tbaseDiv.innerHTML = item.html;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t_checkForError(item);\n\n\t\t\t_calculateItemSize(item, _viewportSize);\n\t\t\t\n\t\t\tif(item.src && !item.loadError && !item.loaded) {\n\n\t\t\t\titem.loadComplete = function(item) {\n\n\t\t\t\t\t// gallery closed before image finished loading\n\t\t\t\t\tif(!_isOpen) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// check if holder hasn't changed while image was loading\n\t\t\t\t\tif(holder && holder.index === index ) {\n\t\t\t\t\t\tif( _checkForError(item, true) ) {\n\t\t\t\t\t\t\titem.loadComplete = item.img = null;\n\t\t\t\t\t\t\t_calculateItemSize(item, _viewportSize);\n\t\t\t\t\t\t\t_applyZoomPanToItem(item);\n\n\t\t\t\t\t\t\tif(holder.index === _currentItemIndex) {\n\t\t\t\t\t\t\t\t// recalculate dimensions\n\t\t\t\t\t\t\t\tself.updateCurrZoomItem();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif( !item.imageAppended ) {\n\t\t\t\t\t\t\tif(_features.transform && (_mainScrollAnimating || _initialZoomRunning) ) {\n\t\t\t\t\t\t\t\t_imagesToAppendPool.push({\n\t\t\t\t\t\t\t\t\titem:item,\n\t\t\t\t\t\t\t\t\tbaseDiv:baseDiv,\n\t\t\t\t\t\t\t\t\timg:item.img,\n\t\t\t\t\t\t\t\t\tindex:index,\n\t\t\t\t\t\t\t\t\tholder:holder,\n\t\t\t\t\t\t\t\t\tclearPlaceholder:true\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t_appendImage(index, item, baseDiv, item.img, _mainScrollAnimating || _initialZoomRunning, true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// remove preloader & mini-img\n\t\t\t\t\t\t\tif(!_initialZoomRunning && item.placeholder) {\n\t\t\t\t\t\t\t\titem.placeholder.style.display = 'none';\n\t\t\t\t\t\t\t\titem.placeholder = null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\titem.loadComplete = null;\n\t\t\t\t\titem.img = null; // no need to store image element after it's added\n\n\t\t\t\t\t_shout('imageLoadComplete', index, item);\n\t\t\t\t};\n\n\t\t\t\tif(framework.features.transform) {\n\t\t\t\t\t\n\t\t\t\t\tvar placeholderClassName = 'pswp__img pswp__img--placeholder'; \n\t\t\t\t\tplaceholderClassName += (item.msrc ? '' : ' pswp__img--placeholder--blank');\n\n\t\t\t\t\tvar placeholder = framework.createEl(placeholderClassName, item.msrc ? 'img' : '');\n\t\t\t\t\tif(item.msrc) {\n\t\t\t\t\t\tplaceholder.src = item.msrc;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t_setImageSize(item, placeholder);\n\n\t\t\t\t\tbaseDiv.appendChild(placeholder);\n\t\t\t\t\titem.placeholder = placeholder;\n\n\t\t\t\t}\n\t\t\t\t\n\n\t\t\t\t\n\n\t\t\t\tif(!item.loading) {\n\t\t\t\t\t_preloadImage(item);\n\t\t\t\t}\n\n\n\t\t\t\tif( self.allowProgressiveImg() ) {\n\t\t\t\t\t// just append image\n\t\t\t\t\tif(!_initialContentSet && _features.transform) {\n\t\t\t\t\t\t_imagesToAppendPool.push({\n\t\t\t\t\t\t\titem:item, \n\t\t\t\t\t\t\tbaseDiv:baseDiv, \n\t\t\t\t\t\t\timg:item.img, \n\t\t\t\t\t\t\tindex:index, \n\t\t\t\t\t\t\tholder:holder\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\t_appendImage(index, item, baseDiv, item.img, true, true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t} else if(item.src && !item.loadError) {\n\t\t\t\t// image object is created every time, due to bugs of image loading & delay when switching images\n\t\t\t\timg = framework.createEl('pswp__img', 'img');\n\t\t\t\timg.style.opacity = 1;\n\t\t\t\timg.src = item.src;\n\t\t\t\t_setImageSize(item, img);\n\t\t\t\t_appendImage(index, item, baseDiv, img, true);\n\t\t\t}\n\t\t\t\n\n\t\t\tif(!_initialContentSet && index === _currentItemIndex) {\n\t\t\t\t_currZoomElementStyle = baseDiv.style;\n\t\t\t\t_showOrHide(item, (img ||item.img) );\n\t\t\t} else {\n\t\t\t\t_applyZoomPanToItem(item);\n\t\t\t}\n\n\t\t\tholder.el.innerHTML = '';\n\t\t\tholder.el.appendChild(baseDiv);\n\t\t},\n\n\t\tcleanSlide: function( item ) {\n\t\t\tif(item.img ) {\n\t\t\t\titem.img.onload = item.img.onerror = null;\n\t\t\t}\n\t\t\titem.loaded = item.loading = item.img = item.imageAppended = false;\n\t\t}\n\n\t}\n});\n\n/*>>items-controller*/\n\n/*>>tap*/\n/**\n * tap.js:\n *\n * Displatches tap and double-tap events.\n * \n */\n\nvar tapTimer,\n\ttapReleasePoint = {},\n\t_dispatchTapEvent = function(origEvent, releasePoint, pointerType) {\t\t\n\t\tvar e = document.createEvent( 'CustomEvent' ),\n\t\t\teDetail = {\n\t\t\t\torigEvent:origEvent, \n\t\t\t\ttarget:origEvent.target, \n\t\t\t\treleasePoint: releasePoint, \n\t\t\t\tpointerType:pointerType || 'touch'\n\t\t\t};\n\n\t\te.initCustomEvent( 'pswpTap', true, true, eDetail );\n\t\torigEvent.target.dispatchEvent(e);\n\t};\n\n_registerModule('Tap', {\n\tpublicMethods: {\n\t\tinitTap: function() {\n\t\t\t_listen('firstTouchStart', self.onTapStart);\n\t\t\t_listen('touchRelease', self.onTapRelease);\n\t\t\t_listen('destroy', function() {\n\t\t\t\ttapReleasePoint = {};\n\t\t\t\ttapTimer = null;\n\t\t\t});\n\t\t},\n\t\tonTapStart: function(touchList) {\n\t\t\tif(touchList.length > 1) {\n\t\t\t\tclearTimeout(tapTimer);\n\t\t\t\ttapTimer = null;\n\t\t\t}\n\t\t},\n\t\tonTapRelease: function(e, releasePoint) {\n\t\t\tif(!releasePoint) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif(!_moved && !_isMultitouch && !_numAnimations) {\n\t\t\t\tvar p0 = releasePoint;\n\t\t\t\tif(tapTimer) {\n\t\t\t\t\tclearTimeout(tapTimer);\n\t\t\t\t\ttapTimer = null;\n\n\t\t\t\t\t// Check if taped on the same place\n\t\t\t\t\tif ( _isNearbyPoints(p0, tapReleasePoint) ) {\n\t\t\t\t\t\t_shout('doubleTap', p0);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif(releasePoint.type === 'mouse') {\n\t\t\t\t\t_dispatchTapEvent(e, releasePoint, 'mouse');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar clickedTagName = e.target.tagName.toUpperCase();\n\t\t\t\t// avoid double tap delay on buttons and elements that have class pswp__single-tap\n\t\t\t\tif(clickedTagName === 'BUTTON' || framework.hasClass(e.target, 'pswp__single-tap') ) {\n\t\t\t\t\t_dispatchTapEvent(e, releasePoint);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t_equalizePoints(tapReleasePoint, p0);\n\n\t\t\t\ttapTimer = setTimeout(function() {\n\t\t\t\t\t_dispatchTapEvent(e, releasePoint);\n\t\t\t\t\ttapTimer = null;\n\t\t\t\t}, 300);\n\t\t\t}\n\t\t}\n\t}\n});\n\n/*>>tap*/\n\n/*>>desktop-zoom*/\n/**\n *\n * desktop-zoom.js:\n *\n * - Binds mousewheel event for paning zoomed image.\n * - Manages \"dragging\", \"zoomed-in\", \"zoom-out\" classes.\n *   (which are used for cursors and zoom icon)\n * - Adds toggleDesktopZoom function.\n * \n */\n\nvar _wheelDelta;\n\t\n_registerModule('DesktopZoom', {\n\n\tpublicMethods: {\n\n\t\tinitDesktopZoom: function() {\n\n\t\t\tif(_oldIE) {\n\t\t\t\t// no zoom for old IE (<=8)\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif(_likelyTouchDevice) {\n\t\t\t\t// if detected hardware touch support, we wait until mouse is used,\n\t\t\t\t// and only then apply desktop-zoom features\n\t\t\t\t_listen('mouseUsed', function() {\n\t\t\t\t\tself.setupDesktopZoom();\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tself.setupDesktopZoom(true);\n\t\t\t}\n\n\t\t},\n\n\t\tsetupDesktopZoom: function(onInit) {\n\n\t\t\t_wheelDelta = {};\n\n\t\t\tvar events = 'wheel mousewheel DOMMouseScroll';\n\t\t\t\n\t\t\t_listen('bindEvents', function() {\n\t\t\t\tframework.bind(template, events,  self.handleMouseWheel);\n\t\t\t});\n\n\t\t\t_listen('unbindEvents', function() {\n\t\t\t\tif(_wheelDelta) {\n\t\t\t\t\tframework.unbind(template, events, self.handleMouseWheel);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tself.mouseZoomedIn = false;\n\n\t\t\tvar hasDraggingClass,\n\t\t\t\tupdateZoomable = function() {\n\t\t\t\t\tif(self.mouseZoomedIn) {\n\t\t\t\t\t\tframework.removeClass(template, 'pswp--zoomed-in');\n\t\t\t\t\t\tself.mouseZoomedIn = false;\n\t\t\t\t\t}\n\t\t\t\t\tif(_currZoomLevel < 1) {\n\t\t\t\t\t\tframework.addClass(template, 'pswp--zoom-allowed');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tframework.removeClass(template, 'pswp--zoom-allowed');\n\t\t\t\t\t}\n\t\t\t\t\tremoveDraggingClass();\n\t\t\t\t},\n\t\t\t\tremoveDraggingClass = function() {\n\t\t\t\t\tif(hasDraggingClass) {\n\t\t\t\t\t\tframework.removeClass(template, 'pswp--dragging');\n\t\t\t\t\t\thasDraggingClass = false;\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t_listen('resize' , updateZoomable);\n\t\t\t_listen('afterChange' , updateZoomable);\n\t\t\t_listen('pointerDown', function() {\n\t\t\t\tif(self.mouseZoomedIn) {\n\t\t\t\t\thasDraggingClass = true;\n\t\t\t\t\tframework.addClass(template, 'pswp--dragging');\n\t\t\t\t}\n\t\t\t});\n\t\t\t_listen('pointerUp', removeDraggingClass);\n\n\t\t\tif(!onInit) {\n\t\t\t\tupdateZoomable();\n\t\t\t}\n\t\t\t\n\t\t},\n\n\t\thandleMouseWheel: function(e) {\n\n\t\t\tif(_currZoomLevel <= self.currItem.fitRatio) {\n\t\t\t\tif( _options.modal ) {\n\n\t\t\t\t\tif (!_options.closeOnScroll || _numAnimations || _isDragging) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t} else if(_transformKey && Math.abs(e.deltaY) > 2) {\n\t\t\t\t\t\t// close PhotoSwipe\n\t\t\t\t\t\t// if browser supports transforms & scroll changed enough\n\t\t\t\t\t\t_closedByScroll = true;\n\t\t\t\t\t\tself.close();\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\t// allow just one event to fire\n\t\t\te.stopPropagation();\n\n\t\t\t// https://developer.mozilla.org/en-US/docs/Web/Events/wheel\n\t\t\t_wheelDelta.x = 0;\n\n\t\t\tif('deltaX' in e) {\n\t\t\t\tif(e.deltaMode === 1 /* DOM_DELTA_LINE */) {\n\t\t\t\t\t// 18 - average line height\n\t\t\t\t\t_wheelDelta.x = e.deltaX * 18;\n\t\t\t\t\t_wheelDelta.y = e.deltaY * 18;\n\t\t\t\t} else {\n\t\t\t\t\t_wheelDelta.x = e.deltaX;\n\t\t\t\t\t_wheelDelta.y = e.deltaY;\n\t\t\t\t}\n\t\t\t} else if('wheelDelta' in e) {\n\t\t\t\tif(e.wheelDeltaX) {\n\t\t\t\t\t_wheelDelta.x = -0.16 * e.wheelDeltaX;\n\t\t\t\t}\n\t\t\t\tif(e.wheelDeltaY) {\n\t\t\t\t\t_wheelDelta.y = -0.16 * e.wheelDeltaY;\n\t\t\t\t} else {\n\t\t\t\t\t_wheelDelta.y = -0.16 * e.wheelDelta;\n\t\t\t\t}\n\t\t\t} else if('detail' in e) {\n\t\t\t\t_wheelDelta.y = e.detail;\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t_calculatePanBounds(_currZoomLevel, true);\n\n\t\t\tvar newPanX = _panOffset.x - _wheelDelta.x,\n\t\t\t\tnewPanY = _panOffset.y - _wheelDelta.y;\n\n\t\t\t// only prevent scrolling in nonmodal mode when not at edges\n\t\t\tif (_options.modal ||\n\t\t\t\t(\n\t\t\t\tnewPanX <= _currPanBounds.min.x && newPanX >= _currPanBounds.max.x &&\n\t\t\t\tnewPanY <= _currPanBounds.min.y && newPanY >= _currPanBounds.max.y\n\t\t\t\t) ) {\n\t\t\t\te.preventDefault();\n\t\t\t}\n\n\t\t\t// TODO: use rAF instead of mousewheel?\n\t\t\tself.panTo(newPanX, newPanY);\n\t\t},\n\n\t\ttoggleDesktopZoom: function(centerPoint) {\n\t\t\tcenterPoint = centerPoint || {x:_viewportSize.x/2 + _offset.x, y:_viewportSize.y/2 + _offset.y };\n\n\t\t\tvar doubleTapZoomLevel = _options.getDoubleTapZoom(true, self.currItem);\n\t\t\tvar zoomOut = _currZoomLevel === doubleTapZoomLevel;\n\t\t\t\n\t\t\tself.mouseZoomedIn = !zoomOut;\n\n\t\t\tself.zoomTo(zoomOut ? self.currItem.initialZoomLevel : doubleTapZoomLevel, centerPoint, 333);\n\t\t\tframework[ (!zoomOut ? 'add' : 'remove') + 'Class'](template, 'pswp--zoomed-in');\n\t\t}\n\n\t}\n});\n\n\n/*>>desktop-zoom*/\n\n/*>>history*/\n/**\n *\n * history.js:\n *\n * - Back button to close gallery.\n * \n * - Unique URL for each slide: example.com/&pid=1&gid=3\n *   (where PID is picture index, and GID and gallery index)\n *   \n * - Switch URL when slides change.\n * \n */\n\n\nvar _historyDefaultOptions = {\n\thistory: true,\n\tgalleryUID: 1\n};\n\nvar _historyUpdateTimeout,\n\t_hashChangeTimeout,\n\t_hashAnimCheckTimeout,\n\t_hashChangedByScript,\n\t_hashChangedByHistory,\n\t_hashReseted,\n\t_initialHash,\n\t_historyChanged,\n\t_closedFromURL,\n\t_urlChangedOnce,\n\t_windowLoc,\n\n\t_supportsPushState,\n\n\t_getHash = function() {\n\t\treturn _windowLoc.hash.substring(1);\n\t},\n\t_cleanHistoryTimeouts = function() {\n\n\t\tif(_historyUpdateTimeout) {\n\t\t\tclearTimeout(_historyUpdateTimeout);\n\t\t}\n\n\t\tif(_hashAnimCheckTimeout) {\n\t\t\tclearTimeout(_hashAnimCheckTimeout);\n\t\t}\n\t},\n\n\t// pid - Picture index\n\t// gid - Gallery index\n\t_parseItemIndexFromURL = function() {\n\t\tvar hash = _getHash(),\n\t\t\tparams = {};\n\n\t\tif(hash.length < 5) { // pid=1\n\t\t\treturn params;\n\t\t}\n\n\t\tvar i, vars = hash.split('&');\n\t\tfor (i = 0; i < vars.length; i++) {\n\t\t\tif(!vars[i]) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tvar pair = vars[i].split('=');\t\n\t\t\tif(pair.length < 2) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tparams[pair[0]] = pair[1];\n\t\t}\n\t\tif(_options.galleryPIDs) {\n\t\t\t// detect custom pid in hash and search for it among the items collection\n\t\t\tvar searchfor = params.pid;\n\t\t\tparams.pid = 0; // if custom pid cannot be found, fallback to the first item\n\t\t\tfor(i = 0; i < _items.length; i++) {\n\t\t\t\tif(_items[i].pid === searchfor) {\n\t\t\t\t\tparams.pid = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tparams.pid = parseInt(params.pid,10)-1;\n\t\t}\n\t\tif( params.pid < 0 ) {\n\t\t\tparams.pid = 0;\n\t\t}\n\t\treturn params;\n\t},\n\t_updateHash = function() {\n\n\t\tif(_hashAnimCheckTimeout) {\n\t\t\tclearTimeout(_hashAnimCheckTimeout);\n\t\t}\n\n\n\t\tif(_numAnimations || _isDragging) {\n\t\t\t// changing browser URL forces layout/paint in some browsers, which causes noticable lag during animation\n\t\t\t// that's why we update hash only when no animations running\n\t\t\t_hashAnimCheckTimeout = setTimeout(_updateHash, 500);\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tif(_hashChangedByScript) {\n\t\t\tclearTimeout(_hashChangeTimeout);\n\t\t} else {\n\t\t\t_hashChangedByScript = true;\n\t\t}\n\n\n\t\tvar pid = (_currentItemIndex + 1);\n\t\tvar item = _getItemAt( _currentItemIndex );\n\t\tif(item.hasOwnProperty('pid')) {\n\t\t\t// carry forward any custom pid assigned to the item\n\t\t\tpid = item.pid;\n\t\t}\n\t\tvar newHash = _initialHash + '&'  +  'gid=' + _options.galleryUID + '&' + 'pid=' + pid;\n\n\t\tif(!_historyChanged) {\n\t\t\tif(_windowLoc.hash.indexOf(newHash) === -1) {\n\t\t\t\t_urlChangedOnce = true;\n\t\t\t}\n\t\t\t// first time - add new hisory record, then just replace\n\t\t}\n\n\t\tvar newURL = _windowLoc.href.split('#')[0] + '#' +  newHash;\n\n\t\tif( _supportsPushState ) {\n\n\t\t\tif('#' + newHash !== window.location.hash) {\n\t\t\t\thistory[_historyChanged ? 'replaceState' : 'pushState']('', document.title, newURL);\n\t\t\t}\n\n\t\t} else {\n\t\t\tif(_historyChanged) {\n\t\t\t\t_windowLoc.replace( newURL );\n\t\t\t} else {\n\t\t\t\t_windowLoc.hash = newHash;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\n\n\t\t_historyChanged = true;\n\t\t_hashChangeTimeout = setTimeout(function() {\n\t\t\t_hashChangedByScript = false;\n\t\t}, 60);\n\t};\n\n\n\n\t\n\n_registerModule('History', {\n\n\t\n\n\tpublicMethods: {\n\t\tinitHistory: function() {\n\n\t\t\tframework.extend(_options, _historyDefaultOptions, true);\n\n\t\t\tif( !_options.history ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\n\t\t\t_windowLoc = window.location;\n\t\t\t_urlChangedOnce = false;\n\t\t\t_closedFromURL = false;\n\t\t\t_historyChanged = false;\n\t\t\t_initialHash = _getHash();\n\t\t\t_supportsPushState = ('pushState' in history);\n\n\n\t\t\tif(_initialHash.indexOf('gid=') > -1) {\n\t\t\t\t_initialHash = _initialHash.split('&gid=')[0];\n\t\t\t\t_initialHash = _initialHash.split('?gid=')[0];\n\t\t\t}\n\t\t\t\n\n\t\t\t_listen('afterChange', self.updateURL);\n\t\t\t_listen('unbindEvents', function() {\n\t\t\t\tframework.unbind(window, 'hashchange', self.onHashChange);\n\t\t\t});\n\n\n\t\t\tvar returnToOriginal = function() {\n\t\t\t\t_hashReseted = true;\n\t\t\t\tif(!_closedFromURL) {\n\n\t\t\t\t\tif(_urlChangedOnce) {\n\t\t\t\t\t\thistory.back();\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif(_initialHash) {\n\t\t\t\t\t\t\t_windowLoc.hash = _initialHash;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (_supportsPushState) {\n\n\t\t\t\t\t\t\t\t// remove hash from url without refreshing it or scrolling to top\n\t\t\t\t\t\t\t\thistory.pushState('', document.title,  _windowLoc.pathname + _windowLoc.search );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t_windowLoc.hash = '';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}\n\n\t\t\t\t_cleanHistoryTimeouts();\n\t\t\t};\n\n\n\t\t\t_listen('unbindEvents', function() {\n\t\t\t\tif(_closedByScroll) {\n\t\t\t\t\t// if PhotoSwipe is closed by scroll, we go \"back\" before the closing animation starts\n\t\t\t\t\t// this is done to keep the scroll position\n\t\t\t\t\treturnToOriginal();\n\t\t\t\t}\n\t\t\t});\n\t\t\t_listen('destroy', function() {\n\t\t\t\tif(!_hashReseted) {\n\t\t\t\t\treturnToOriginal();\n\t\t\t\t}\n\t\t\t});\n\t\t\t_listen('firstUpdate', function() {\n\t\t\t\t_currentItemIndex = _parseItemIndexFromURL().pid;\n\t\t\t});\n\n\t\t\t\n\n\t\t\t\n\t\t\tvar index = _initialHash.indexOf('pid=');\n\t\t\tif(index > -1) {\n\t\t\t\t_initialHash = _initialHash.substring(0, index);\n\t\t\t\tif(_initialHash.slice(-1) === '&') {\n\t\t\t\t\t_initialHash = _initialHash.slice(0, -1);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\n\t\t\tsetTimeout(function() {\n\t\t\t\tif(_isOpen) { // hasn't destroyed yet\n\t\t\t\t\tframework.bind(window, 'hashchange', self.onHashChange);\n\t\t\t\t}\n\t\t\t}, 40);\n\t\t\t\n\t\t},\n\t\tonHashChange: function() {\n\n\t\t\tif(_getHash() === _initialHash) {\n\n\t\t\t\t_closedFromURL = true;\n\t\t\t\tself.close();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(!_hashChangedByScript) {\n\n\t\t\t\t_hashChangedByHistory = true;\n\t\t\t\tself.goTo( _parseItemIndexFromURL().pid );\n\t\t\t\t_hashChangedByHistory = false;\n\t\t\t}\n\t\t\t\n\t\t},\n\t\tupdateURL: function() {\n\n\t\t\t// Delay the update of URL, to avoid lag during transition, \n\t\t\t// and to not to trigger actions like \"refresh page sound\" or \"blinking favicon\" to often\n\t\t\t\n\t\t\t_cleanHistoryTimeouts();\n\t\t\t\n\n\t\t\tif(_hashChangedByHistory) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif(!_historyChanged) {\n\t\t\t\t_updateHash(); // first time\n\t\t\t} else {\n\t\t\t\t_historyUpdateTimeout = setTimeout(_updateHash, 800);\n\t\t\t}\n\t\t}\n\t\n\t}\n});\n\n\n/*>>history*/\n\tframework.extend(self, publicMethods); };\n\treturn PhotoSwipe;\n});","import PhotoSwipe from \"photoswipe\";\nimport PhotoSwipeUI from \"photoswipe/dist/photoswipe-ui-default\";\n\nconst grooming_items = [\n  {\n    src:\n      \"https://res.cloudinary.com/petzmania/image/upload/c_fill,h_756,w_756/v1577903995/grooming/grooming1.jpg\",\n    w: 756,\n    h: 756\n  },\n  {\n    src:\n      \"https://res.cloudinary.com/petzmania/image/upload/c_fill,h_534,w_534/v1577903999/grooming/groomin2.jpg\",\n    w: 534,\n    h: 534\n  },\n  {\n    src:\n      \"https://res.cloudinary.com/petzmania/image/upload/c_fill,h_480,w_480/v1577904002/grooming/grooming3.jpg\",\n    w: 480,\n    h: 480\n  },\n  {\n    src:\n      \"https://res.cloudinary.com/petzmania/image/upload/c_fill,h_720,w_720/v1577904006/grooming/grooming4.jpg\",\n    w: 720,\n    h: 720\n  },\n  {\n    src:\n      \"https://res.cloudinary.com/petzmania/image/upload/c_fill,h_720,w_720/v1577904009/grooming/grooming5.jpg\",\n    w: 720,\n    h: 720\n  },\n  {\n    src:\n      \"https://res.cloudinary.com/petzmania/image/upload/c_fill,h_533,w_533/v1577904014/grooming/grooming6.jpg\",\n    w: 533,\n    h: 533\n  },\n  {\n    src:\n      \"https://res.cloudinary.com/petzmania/image/upload/c_fill,h_720,w_720/v1577904018/grooming/grooming7.jpg\",\n    w: 720,\n    h: 720\n  },\n  {\n    src:\n      \"https://res.cloudinary.com/petzmania/image/upload/c_fill,h_450,w_450/v1577904021/grooming/grooming8.jpg\",\n    w: 450,\n    h: 450\n  }\n];\n/**\n *\n * @param {\"grooming\"} gallery Gallery Type\n * @param {string} selector DOM name\n */\nexport default function GalleryController(gallery, selector) {\n  const pictures = document.querySelector(selector);\n  let items;\n  if (gallery === \"grooming\") {\n    items = grooming_items;\n  }\n  for (let i = 0; i < items.length; i++) {\n    const div = document.createElement(\"a\");\n    div.href = \"#\";\n    div.onclick = e => {\n      e.preventDefault();\n      photoswipe(items, i);\n    };\n    const image = document.createElement(\"img\");\n    image.src = items[i].src;\n    image.className = \"img-fluid\";\n    div.className = \"col-md-3 col-6\";\n    div.append(image);\n    pictures.append(div);\n  }\n}\n/**\n *\n * @param {PhotoSwipe.Item[]} items\n * @param {number} index\n */\nexport function photoswipe(items, index) {\n  const dom = document.querySelector(\".pswp\");\n  if (dom) {\n    const gallery = new PhotoSwipe(dom, PhotoSwipeUI, items, {\n      index,\n      fullscreenEl: true\n    });\n    gallery.init();\n  }\n}\n","import cameraView from '../view/cameraView';\n\nexport const createUrl = (channel) => {\n  const url = `wss://stream.petzmania.net:90${channel < 10 ? '0' : '' }${channel}`;\n  return url;\n}\n\nexport const changeStream = () => {\n  cameraView.changeStream();\n}","export const scrollSlider = () => {\n  const options = {\n    root: null,\n    rootMargin: '-50% 0px',\n    threshold: [0.0 ,1.0],\n  };\n  let percent = 0;  \n  const logic = (entries, observer) => {\n    entries.forEach(entry => {\n        let el = entry.target;\n        console.log(entry);\n        if(entry.isIntersecting === true) {\n          document.body.addEventListener('wheel', (e) => {\n            if(percent === 0) {\n              if(e.deltaY > 0) {\n                e.preventDefault();\n                percent++;\n                el.style.transfrom = `translateX(-${percent}%)`;\n              } else {\n                e.preventDefault();\n                return;\n              }\n            } else if(percent === 75) {\n              observer.disconnect();\n              return;\n            } else {\n              e.preventDefault();\n              e.deltaY > 0 ? percent++ : percent--;\n              el.style.transform = `translateX(-${percent}%)`;\n            }\n          });\n          let starty = 0;\n          let previousDist = 0;\n          let dist = 0;\n          document.body.addEventListener('touchstart' , (e) => {\n            const touch = e.changedTouches[0];\n            starty = parseInt(touch.clientY);\n          }, {\n            passive: false\n          });\n          document.body.addEventListener('touchmove', (e) => {\n            const touch = e.changedTouches[0];\n            dist = parseInt(touch.clientY) - starty;\n            let move = (dist - previousDist) * 0.01;\n            if(percent === 0) {\n              if(dist < 0) {\n                e.preventDefault();\n                percent++;\n                el.style.transform = `translateX(-${percent}%)`;\n                \n              } else {\n                e.preventDefault();\n                return;\n              }\n            } else if(percent === 75) {\n              observer.disconnect();\n            } else {\n              e.preventDefault();\n              move < 0 ? percent++ : percent--;\n              el.style.transform = `translateX(-${percent}%)`;\n              \n            }\n            previousDist = dist;\n          }, {\n            passive: false,\n          });\n          window.location.hash = 'feature';\n        }\n      }\n    );\n  }\n  return new IntersectionObserver(logic, options);\n}","export const copyInputBox = (e) => {\n  const inputGroup = e.target.closest('.input-group');\n  const inputBox = inputGroup.querySelector('input[type=\"text\"]');\n  inputBox.select();\n  document.execCommand('copy');\n  return inputBox.value;\n}","import * as navView from '../view/navView';\n\nexport default (e) => {\n  // CLose the old UI\n  navView.close();\n  // Open New UI\n  navView.open(e);\n}","export const DOMstrings = {\n  navDropdown: document.querySelectorAll('.nav__dropdown'),\n  navList: document.querySelectorAll('.nav__list'),\n  showcaseList: document.querySelector('.showcase-list'),\n  UUIDCopyBtn: document.querySelector('#UUIDCopyBtn'),\n  noStream: document.querySelector('#no_stream'),\n  streamContainer: document.querySelector('#stream__container'),\n  changeStreamBtn: document.querySelectorAll('.stream__btn'),\n  streamCanvas: document.querySelector('#stream__canvas'),\n}","import { DOMstrings } from '../view/base';\n\nexport default {\n  changeStream: (channel) => {\n    const noStream = document.querySelector('#no_stream');\n    if(noStream) {\n      DOMstrings.streamContainer.removeChild(noStream);\n    }\n    const canvas = document.querySelector('#stream__canvas');\n    if(canvas) {\n      canvas.parentElement.removeChild(canvas);\n    }\n    const canvasHTML = \n    `<div id=\"stream__box\">\n      <canvas id=\"stream__canvas\"></canvas>\n      <img src=\"https://res.cloudinary.com/petzmania/image/upload/v1552796920/PetzManiaLogo.png\" alt=\"Logo\" id=\"stream__logo\">\n    </div>`;\n    document.querySelector('#stream__container').insertAdjacentHTML('afterbegin', canvasHTML);\n  }\n}","import {DOMstrings} from './base';\n\n\nexport const open = (e) => {\n  const target = e.target.dataset['toggle'];\n  Array.from(DOMstrings.navList).forEach(cur => {\n    if(cur.id === target) {\n      cur.style.display = 'block';\n    }\n  });\n}\n\nexport const close = () => {\n  Array.from(DOMstrings.navList).forEach(cur => cur.style.display = 'none');\n}\n","var map = {\n\t\"./career.pug\": \"./src/common/view/career.pug\",\n\t\"./dog-boarding.pug\": \"./src/common/view/dog-boarding.pug\",\n\t\"./dog-daycare.pug\": \"./src/common/view/dog-daycare.pug\",\n\t\"./dog-grooming.pug\": \"./src/common/view/dog-grooming.pug\",\n\t\"./dog-training.pug\": \"./src/common/view/dog-training.pug\",\n\t\"./dog-wash.pug\": \"./src/common/view/dog-wash.pug\",\n\t\"./emails/new-account.pug\": \"./src/common/view/emails/new-account.pug\",\n\t\"./emails/to-company.pug\": \"./src/common/view/emails/to-company.pug\",\n\t\"./http-error.pug\": \"./src/common/view/http-error.pug\",\n\t\"./index.pug\": \"./src/common/view/index.pug\",\n\t\"./job-success.pug\": \"./src/common/view/job-success.pug\",\n\t\"./job.pug\": \"./src/common/view/job.pug\",\n\t\"./other.pug\": \"./src/common/view/other.pug\",\n\t\"./policies.pug\": \"./src/common/view/policies.pug\",\n\t\"./price.pug\": \"./src/common/view/price.pug\",\n\t\"./sign-up-success.pug\": \"./src/common/view/sign-up-success.pug\",\n\t\"./sign-up.pug\": \"./src/common/view/sign-up.pug\",\n\t\"./support.pug\": \"./src/common/view/support.pug\",\n\t\"./templates/alert.pug\": \"./src/common/view/templates/alert.pug\",\n\t\"./templates/basic-requirements.pug\": \"./src/common/view/templates/basic-requirements.pug\",\n\t\"./templates/boarding-hours.pug\": \"./src/common/view/templates/boarding-hours.pug\",\n\t\"./templates/contact-us.pug\": \"./src/common/view/templates/contact-us.pug\",\n\t\"./templates/features.pug\": \"./src/common/view/templates/features.pug\",\n\t\"./templates/footer.pug\": \"./src/common/view/templates/footer.pug\",\n\t\"./templates/gallery.pug\": \"./src/common/view/templates/gallery.pug\",\n\t\"./templates/get-started.pug\": \"./src/common/view/templates/get-started.pug\",\n\t\"./templates/header.pug\": \"./src/common/view/templates/header.pug\",\n\t\"./templates/holidays.pug\": \"./src/common/view/templates/holidays.pug\",\n\t\"./templates/hours-of-operation.pug\": \"./src/common/view/templates/hours-of-operation.pug\",\n\t\"./templates/nav.pug\": \"./src/common/view/templates/nav.pug\",\n\t\"./templates/price-nav.pug\": \"./src/common/view/templates/price-nav.pug\",\n\t\"./templates/price-table.pug\": \"./src/common/view/templates/price-table.pug\",\n\t\"./templates/review.pug\": \"./src/common/view/templates/review.pug\",\n\t\"./templates/sign-up-module.pug\": \"./src/common/view/templates/sign-up-module.pug\",\n\t\"./tour.pug\": \"./src/common/view/tour.pug\",\n\t\"./verify.pug\": \"./src/common/view/verify.pug\",\n\t\"./webcam-login.pug\": \"./src/common/view/webcam-login.pug\",\n\t\"./webcam.pug\": \"./src/common/view/webcam.pug\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"./src/common/view sync recursive \\\\.pug$\";","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript)\n\t\tscriptUrl = document.currentScript.src\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) scriptUrl = scripts[scripts.length - 1].src\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl + \"../\";","import \"../scss/main.scss\";\n\nconst pug = require.context(\"../../common/view\", true, /\\.pug$/)\npug.keys().forEach(pug)\n\nimport { DOMstrings } from \"./view/base\";\nimport navController from \"./controller/navController\";\nimport * as carouselController from \"./controller/carouselController\";\nimport * as copyController from \"./controller/copyController\";\nimport * as cameraController from \"./controller/cameraController\";\nimport * as JSMpeg from \"@lixuc/jsmpeg\";\nimport GalleryController from \"./controller/GalleryController\";\n\nlet state = {};\n\n(function() {\n  $('[data-toggle=\"tooltip\"]').tooltip();\n  $(\"#date\").prepend(`${new Date().getFullYear()}`);\n})();\n\nwindow.onload = function() {\n  GalleryController(\"grooming\", \"#gallery__grooming\");\n};\n\nif (DOMstrings.showcaseList) {\n  let observer = carouselController.scrollSlider();\n  observer.observe(DOMstrings.showcaseList);\n}\n\nif (DOMstrings.navDropdown) {\n  Array.from(DOMstrings.navDropdown).forEach(cur =>\n    cur.addEventListener(\"click\", e => {\n      e.preventDefault();\n      navController(e);\n    })\n  );\n}\nif (DOMstrings.UUIDCopyBtn) {\n  DOMstrings.UUIDCopyBtn.addEventListener(\"click\", e => {\n    e.preventDefault();\n    copyController.copyInputBox(e);\n    alert(\"The IP Address has been copied!\");\n  });\n}\n\nif (DOMstrings.changeStreamBtn) {\n  Array.from(DOMstrings.changeStreamBtn).forEach(cur =>\n    cur.addEventListener(\"click\", e => {\n      const channel = e.target.children[0].dataset.channel;\n      const url = cameraController.createUrl(channel);\n      cameraController.changeStream();\n      const newCanvas = document.querySelector(\"#stream__canvas\");\n      state.player = null;\n      state.player = new JSMpeg.Player(url, { canvas: newCanvas });\n    })\n  );\n}\n"],"sourceRoot":""}